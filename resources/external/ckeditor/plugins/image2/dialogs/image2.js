/*
 Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("image2",function(g){function z(){var a=this.getValue().match(A);(a=!(!a||0===parseInt(a[1],10)))||alert(c["invalid"+CKEDITOR.tools.capitalize(this.id)]);return a}function J(){function a(a,c){f.push(b.once(a,function(a){for(var b;b=f.pop();)b.removeListener();c(a)}))}var b=m.createElement("img"),f=[];return function(f,c,d){a("load",function(){var a=B(b);c.call(d,b,a.width,a.height)});a("error",function(){c(null)});a("abort",function(){c(null)});b.setAttribute("src",(q.baseHref||
"")+f+"?"+Math.random().toString(16).substring(2))}}function C(){if(d){var a=this.getValue();if(a&&(a.match(A)||r(!1),"0"!==a)){var b="width"==this.id,f=n||t,c=p||u,a=b?Math.round(a/f*c):Math.round(a/c*f);isNaN(a)||(b?h:k).setValue(a)}}}function r(a){if(e){if("boolean"==typeof a){if(v)return;d=a}else a=k.getValue(),v=!0,(d=!d)&&a&&(a*=p/n,isNaN(a)||h.setValue(Math.round(a)));e[d?"removeClass":"addClass"]("cke_btn_unlocked");e.setAttribute("aria-checked",d);CKEDITOR.env.hc&&e.getChild(0).setHtml(d?
CKEDITOR.env.ie?"■":"▣":CKEDITOR.env.ie?"□":"▢")}}var A=/(^\s*(\d+)(px)?\s*$)|^$/i,D=CKEDITOR.tools.getNextId(),E=CKEDITOR.tools.getNextId(),b=g.lang.image2,c=g.lang.common,K=(new CKEDITOR.template('\x3cdiv\x3e\x3ca href\x3d"javascript:void(0)" tabindex\x3d"-1" title\x3d"'+b.lockRatio+'" class\x3d"cke_btn_locked" id\x3d"{lockButtonId}" role\x3d"checkbox"\x3e\x3cspan class\x3d"cke_icon"\x3e\x3c/span\x3e\x3cspan class\x3d"cke_label"\x3e'+b.lockRatio+'\x3c/span\x3e\x3c/a\x3e\x3ca href\x3d"javascript:void(0)" tabindex\x3d"-1" title\x3d"'+
b.resetSize+'" class\x3d"cke_btn_reset" id\x3d"{resetButtonId}" role\x3d"button"\x3e\x3cspan class\x3d"cke_label"\x3e'+b.resetSize+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e")).output({lockButtonId:D,resetButtonId:E}),q=g.config,w=g.widgets.registered.image.features,B=CKEDITOR.plugins.image2.getNatural,m,F,G,n,p,t,u,H,d,v,e,l,k,h,x,y=!(!q.filebrowserImageBrowseUrl&&!q.filebrowserBrowseUrl),I=[{id:"src",type:"text",label:c.url,setup:function(a){this.setValue(a.data.src);if(a=this.getInputElement().$)a.readOnly=
!0},commit:function(a){a.setData("src",this.getValue())},validate:CKEDITOR.dialog.validate.notEmpty(b.urlMissing)}];y&&I.push({type:"button",id:"browse",style:"display:inline-block;margin-top:14px;",align:"center",label:g.lang.common.browseServer,hidden:!0,filebrowser:"info:src"});return{title:b.title,minWidth:250,minHeight:100,onLoad:function(){m=this._.element.getDocument();J()},onShow:function(){F=this.widget;G=F.parts.image;H=v=d=!1;x=B(G);t=n=x.width;u=p=x.height},contents:[{id:"info",label:b.infoTab,
elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["100%"],children:I}]},{id:"alt",type:"text",label:b.alt,setup:function(a){this.setValue(a.data.alt)},commit:function(a){a.setData("alt",this.getValue())}},{type:"hbox",widths:["25%","25%","50%"],requiredContent:w.dimension.requiredContent,children:[{type:"text",width:"45px",id:"width",label:c.width,validate:z,onKeyUp:C,onLoad:function(){k=this},setup:function(a){this.setValue(a.data.width)},commit:function(a){a.setData("width",this.getValue())}},
{type:"text",id:"height",width:"45px",label:c.height,validate:z,onKeyUp:C,onLoad:function(){h=this},setup:function(a){this.setValue(a.data.height)},commit:function(a){a.setData("height",this.getValue())}},{id:"lock",type:"html",style:"margin-top:18px;width:40px;height:20px;",onLoad:function(){function a(a){a.on("mouseover",function(){this.addClass("cke_btn_over")},a);a.on("mouseout",function(){this.removeClass("cke_btn_over")},a)}var b=this.getDialog();e=m.getById(D);l=m.getById(E);e&&(b.addFocusable(e,
4+y),e.on("click",function(a){r();a.data&&a.data.preventDefault()},this.getDialog()),a(e));l&&(b.addFocusable(l,5+y),l.on("click",function(a){H?(k.setValue(t),h.setValue(u)):(k.setValue(n),h.setValue(p));a.data&&a.data.preventDefault()},this),a(l))},setup:function(a){r(a.data.lock)},commit:function(a){a.setData("lock",d)},html:K}]},{type:"hbox",id:"alignment",requiredContent:w.align.requiredContent,children:[{id:"align",type:"radio",items:[[c.alignNone,"none"],[c.alignLeft,"left"],[c.alignCenter,
"center"],[c.alignRight,"right"]],label:c.align,setup:function(a){this.setValue(a.data.align)},commit:function(a){a.setData("align",this.getValue())}}]},{id:"hasCaption",type:"checkbox",label:b.captioned,requiredContent:w.caption.requiredContent,setup:function(a){this.setValue(a.data.hasCaption)},commit:function(a){a.setData("hasCaption",this.getValue())}}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:b.uploadTab,elements:[{type:"file",id:"upload",label:b.btnUpload,style:"height:40px"},
{type:"fileButton",id:"uploadButton",filebrowser:"info:src",label:b.btnUpload,"for":["Upload","upload"]}]}]}});