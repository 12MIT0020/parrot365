!function(){"use strict";angular.module("wpoffice",["ngAnimate","ui.router","toastr","officeuifabric.core","officeuifabric.components","ui.tree","cgNotify","ui.bootstrap","ngSanitize","ngFileSaver","witty.fileViewer","witty.witViewer","ngCordova","ngNotify","froala"])}(),function(){"use strict";angular.module("wpoffice").directive("starRating",["$rootScope","appData",function(e,t){return{restrict:"E",templateUrl:"app/views/wit-card/directives/star-rating.html",link:function(e,n,o){e.rating=t.wit.ratingAggregation||0,e.$on("setStarRating",function(n,o){e.rating=o,t.wit.ratingAggregation=e.rating}),e.updatePreviousRating=function(){e.rating=t.wit.ratingAggregation||0}}}}])}(),function(){"use strict";function e(e,t,n,o){function i(){var o=e.searchOptions;if(e.userWorkspaces=t.getUserWorkspace(),e.selectedFolders=[],e.selectedTags=[],e.witTypes=[n.WIT,n.DOC,n.COMBO],e.selectedFields=[],o.searchFields&&o.searchFields.length)for(var i,a=0;a<e.searchFields.length;a++)i=e.searchFields[a],o.searchFields.indexOf(i.prop)>=0&&e.selectedFields.push(i);(o.dateBegin||o.dateEnd)&&(e.showTime=2,o.dateBegin&&(e.dateBegin=new Date(o.dateBegin)),o.dateEnd&&(e.dateEnd=new Date(o.dateEnd)))}e.internalControl=e.control||{},e.searchOptions=e.internalControl.searchCriteria,e.searchFields=[{name:"Wit Title",prop:"Title"},{name:"Wit Content",prop:"Content"},{name:"Notes",prop:"Notes"},{name:"File Name",prop:"FileName"},{name:"Tag Name",prop:"TagName"},{name:"Folder Name",prop:"FolderName"},{name:"Document Content",prop:"DocumentContent"},{name:"File Extension",prop:"FileExtension"}],e.timeFields=[{name:"Anytime",prop:!1},{name:"Custom Time",prop:!0}],e.selectedFields=[],e.selectedWorkspaces=[],e.dateBegin=null,e.dateEnd=null,e.date=new Date,e.onFolderSelection=function(t){for(var n=t.$modelValue,o=!1,i=0;i<e.selectedFolders.length;i++)if(e.selectedFolders[i].id===n.id){o=!0;break}o||e.selectedFolders.push(n)},e.removeFolder=function(t){e.selectedFolders.splice(t,1)},e.onTagSelection=function(t){var n=t.$modelValue;if("TAG_GROUP"!==n.tagType){for(var o=!1,i=0;i<e.selectedTags.length;i++)if(e.selectedTags[i].id===n.id){o=!0;break}o||e.selectedTags.push(n)}},e.removeTag=function(t){e.selectedTags.splice(t,1)},e.selectWorkspace=function(t){for(var n=!1,o=0;o<e.selectedWorkspaces.length;o++)if(e.selectedWorkspaces[o].id===t.id){n=!0;break}n||e.selectedWorkspaces.push(t),e.workspaceSelected=""},e.removeWorkspace=function(t){e.selectedWorkspaces.splice(t,1)},e.selectWitType=function(t){e.searchOptions.witType.indexOf(t)==-1?e.searchOptions.witType.push(t):e.searchOptions.witType.splice(e.searchOptions.witType.indexOf(t),1),e.witType=""},e.removeWitType=function(t){e.searchOptions.witType.splice(t,1)},e.selectField=function(t){for(var n=!1,o=0;o<e.selectedFields.length;o++)if(e.selectedFields[o].prop===t.prop){n=!0;break}n||e.selectedFields.push(t),e.witTypeSelected=""},e.selectedDate=function(t){e.isCustomeDate=t.prop,e.selectedCustomDate=""},e.removeField=function(t){e.selectedFields.splice(t,1)},e.updateSearch=function(){var t=e.searchOptions,n=t.folderIds?t.folderIds:t.filterByFolderId;n.length=0,e.selectedFolders.length>0&&e.selectedFolders.forEach(function(e){n.push(e.id)});var o=t.tagIds?t.tagIds:t.filterByTagId;o.length=0,e.selectedTags.length>0&&e.selectedTags.forEach(function(e){o.push(e.id)}),t.searchFields.length=0,e.selectedFields.length>0&&e.selectedFields.forEach(function(e){t.searchFields.push(e.prop)}),t.workspaceIds.length=0,e.selectedWorkspaces.length>0&&e.selectedWorkspaces.forEach(function(e){t.workspaceIds.push(e.id)});var i=new Date(e.startDate),a=new Date(e.endDate);t.dateBegin=e.startDate&&e.isCustomeDate?i.toISOString():null,t.dateEnd=e.endDate&&e.isCustomeDate?a.toISOString():null,e.internalControl.afterSearchUpdate&&e.internalControl.afterSearchUpdate()},e.hoverIn=function(){event.stopPropagation()},e.internalControl.updateSearch&&(e.internalControl.updateSearch=e.updateSearch),i()}e.$inject=["$scope","userDataFactory","WIT_TYPE","appData"],angular.module("wpoffice").directive("searchCriteria",function(){return{scope:{control:"="},controller:e,restrict:"E",templateUrl:function(e,t){return Boolean(t.updateCriteria)===!0,"app/tabs/components/search-criteria/search.html"},replace:!0}})}(),function(){"use strict";function e(e,t,n,o,i,a,r){function l(){e.ckPopUp=o,e.newVariable={name:"",defaultValue:""},e.showDialogNow=!0;var t=i.getAcronyms(),n=[];t&&t.length>0&&angular.forEach(t,function(e){e.name&&n.push(e)}),e.variableList=n}function s(e){var t=!1,n=/<(.|\n)*?>/g;return n.test(e)&&(t=!0),t}e.close=function(){t.close()},e.createNewVariable=function(){e.newVariable.name?s(e.newVariable.name)||s(e.newVariable.defaultValue)?r.set("HTML tags are not allowed in variable name/value","error"):(i.addAcronym(e.newVariable),e.ckPopUp.createAcro(e.newVariable),e.close()):r.set("Please enter variable name","error")},e.editAcro=function(t,n){e.currentAcroEdit=t,e.editAcroObj=n},e.saveEditedAcro=function(t,n){n.name?s(n.name)||s(n.defaultValue)||(e.variableList[t].name=n.name,e.variableList[t].defaultValue=n.defaultValue,i.updateAcronym(e.variableList[t],n),e.currentAcroEdit=null,e.editAcroObj=null):r.set("Please enter variable name","error")},l()}e.$inject=["$scope","$uibModalInstance","$uibModal","ckPopUp","editorUtil","notify","ngNotify"],angular.module("wpoffice").controller("CkeditorPopupController",e)}(),function(){"use strict";angular.module("wpoffice").service("folderViewService",["apiService",function(e){this.getAllWorkspace=function(){var t="/workspaces/listAll";return e.getList(t,"")},this.getFoldersOfWorksapce=function(t,n){n=n||0;var o="/folders/workspaceId/"+t+"/level/"+n;return e.getList(o,"")},this.getFolderChildren=function(t,n){n=n||1;var o="",i="/folders/"+t+"/hierarchy/level/"+n;return e.getList(i,o)},this.getWitsOfFolder=function(t,n){n=n||{};var o="/wits/folder/"+t+"/children",i={sort:n.sort?n.sort:"modifiedDate",asc:"desc"!==n.asc};return e.getList(o,i)},this.createFolder=function(t){var n="/folders";return e.callPost(n,t)},this.renameFolder=function(t){var n="/folders";return e.callPut(n,t)},this.deleteFolder=function(t){var n="/folders";return e.callDelete(n,t)},this.getFolderInfo=function(t){return e.getList("/folders/properties/"+t)}}])}(),function(){"use strict";angular.module("wpoffice").service("sharepoint365Service",["apiService",function(e){var t="/sharepoint365";this.getFirstLevelContent=function(){return e.getList(t+"/contents?folderId=0")},this.getFolderContent=function(n){var o={folderId:n};return e.getList(t+"/contents",o)},this.getSubfolders=function(n){var o={folderId:n};return e.getList(t+"/subfolders",o)},this.getDocuments=function(n){var o={folderId:n};return e.getList(t+"/documents",o)},this.uploadFile=function(n){var o;return o=n.id?n.id:n.tpid,e.callPost(t+"/"+o).then(function(e){return e.file=n,e},function(e){return e.file=n,e})},this.getAuthUrl=function(e){return"api/wittyparrot/api"+t+"/oauth/authorize/"+e},this.authCallback=function(n){return e.getList(t+"/oauth/oauth2callback",n)},this.bulkImport=function(n,o,i){var a={parentFolderId:n,fileIds:o,folderIds:i};return e.callPost(t+"/import",a)},this.logout=function(){return e.callPost(t+"/logout")}}])}(),function(){"use strict";angular.module("wpoffice").service("boxService",["apiService",function(e){var t="/box";this.getFirstLevelContent=function(){return e.getList(t+"/contents?folderId=0")},this.getFolderContent=function(n){var o={folderId:n};return e.getList(t+"/contents",o)},this.getSubfolders=function(n){var o={folderId:n};return e.getList(t+"/subfolders",o)},this.getDocuments=function(n){var o={folderId:n};return e.getList(t+"/documents",o)},this.uploadFile=function(n){var o;return o=n.id?n.id:n.tpid,e.callPost(t+"/"+o).then(function(e){return e.file=n,e},function(e){return e.file=n,e})},this.bulkImport=function(n,o,i){var a={parentFolderId:n,fileIds:o,folderIds:i};return e.callPost(t+"/import",a)},this.getAuthUrl=function(e){return"api/wittyparrot/api"+t+"/oauth/oauth2callback?user-id="+e},this.authCallback=function(n){return e.getList(t+"/oauth/oauth2callback",n)},this.logout=function(){return e.callPost(t+"/logout")}}])}(),function(){"use strict";angular.module("wpoffice").factory("roleManager",["userDataFactory",function(e){function t(){return Object.keys(n).length||(n=e.getAssociativeListOfUserRolePermission()),n}var n={},o={};return o.hasAccessOf=function(e){for(var n=!1,o=e.split("-"),i=o.length,a=0;a<i&&!(n=!(!n&&!t()[o[a]]));a++);return n},o}])}(),function(){"use strict";angular.module("wpoffice").factory("packageManager",["userDataFactory",function(e){function t(){return Object.keys(n).length||(n=e.getAssociativeListOfFeatures()),n}var n={},o={};return o.hasAccessOf=function(e){for(var n=!1,o=e.split("-"),i=o.length,a=0;a<i&&!(n=!(!n&&!t()[o[a]]));a++);return n},o}])}(),function(){"use strict";angular.module("wpoffice").factory("appPermissionFactory",["packageManager","accessControlManager","roleManager","PERMISSION_TYPE","appPermissionConfig",function(e,t,n,o,i){var a={DUMMY_ACTION:{feature:null,permission:null,acl:null},LEFTNAV_HOME:{feature:"COLLECTIONS",permission:null,acl:null},LEFTNAV_DASHBOARD:{feature:"ANALYTICS",permission:null,acl:null},LEFTNAV_WORKFLOW:{feature:"WORKFLOWS",permission:"MANAGE_WORKFLOWS",acl:null},LEFTNAV_CONTACTS:{feature:"CONTACTS",permission:null,acl:null},LEFTNAV_CAMPAIGN:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},LEFTNAV_WITLINK:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},LEFTNAV_HOTLINK:{feature:"PUBLIC_HOTLINKS-PRIVATE_HOTLINKS",permission:null,acl:null},LEFTNAV_CAMPAIGN_ACCOUNTS:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},LEFTNAV_CAMPAIGN_TASK:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},ENTERPRISE_EMAIL_ANALYTICS:{feature:null,permission:"VIEW_ENTERPRISE_ANALYTICS",acl:null},LEFTNAV_ADMIN:{feature:null,permission:"MANAGE_ENTERPRISE_PROFILE-MANAGE_USERS-MANAGE_ROLES-MANAGE_USERS_GROUPS-MANAGE_ROLLUP_GROUPS-MANAGE_WORKSPACES-MANAGE_ENTERPRISE_INTEGRATIONS-MANAGE_ENTERPRISE_COLLECTION-MANAGE_WHITELABELLING-MANAGE_ENTERPRISE_CAMPAIGN_PARAMETERS-MANAGE_WORKFLOW_TEMPLATES-MANAGE_DECISION_FIELDS",acl:null},LEFTNAV_TIMELINES:{feature:"TIMELINE",permission:null,acl:null},LEFTNAV_VARIABLES:{feature:"GLOBAL_VARIABLES",permission:"MANAGE_GLOBAL_VARIABLES",acl:null},LEFTNAV_MICROSITES:{feature:"PUBLIC_MICROSITES",permission:"MANAGE_MICROSITES",acl:null},LEFTNAV_DISCOVER_WITS:{feature:"DISCOVER_WITS_FROM_DOCS-DISCOVER_WITS_FROM_PPT-DISCOVER_WITS_FROM_PDF",permission:null,acl:null},LEFTNAV_WORKFLOW_TEMPLATE:{feature:null,permission:null,acl:null},LEFTNAV_DECISION_FIELD:{feature:null,permission:null,acl:null},LEFTNAV_WORKFLOW_DASHBOARD:{feature:"WORKFLOWS",permission:"REVIEW_ENTERPRISE_WORKFLOW",acl:null},DISCOVER_WITS_FROM_DOCS:{feature:"DISCOVER_WITS_FROM_DOCS",permission:null,acl:null},DISCOVER_WITS_FROM_PPT:{feature:"DISCOVER_WITS_FROM_PPT",permission:null,acl:null},DISCOVER_WITS_FROM_PDF:{feature:"DISCOVER_WITS_FROM_PDF",permission:null,acl:null},AUTO_SEARCH:{feature:null,permission:null,acl:null},TOPNAV_QUICK_COLLECTIONS:{feature:"COLLECTIONS",permission:null,acl:null},TOPNAV_QUICK_FOLDERS:{feature:null,permission:null,acl:null},TOPNAV_QUICK_TAG:{feature:"TAGS_AND_TAG_GROUPS",permission:null,acl:null},TOPNAV_QUICK_SEARCH:{feature:null,permission:null,acl:null},TOPNAV_QUICK_TRASH:{feature:null,permission:null,acl:null},TOPNAV_SHARE:{feature:"CONTENT_SHARING",permission:null,acl:null},TOPNAV_TAG:{feature:"TAGS_AND_TAG_GROUPS",permission:null,acl:null},TOPNAV_CREATE_COMBOWIT:{feature:"COMBO_WITS",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},TOPNAV_ADD_ATTACHMENTS:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},TOPNAV_LABEL:{feature:"LABELS",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},TOPNAV_ADD_NOTES:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},TOPNAV_DELETE:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},TOPNAV_CREATE_MICROSITE:{feature:"PUBLIC_MICROSITES",permission:"MANAGE_MICROSITES",acl:null},TOPNAV_CREATE_COLLECTION:{feature:"COLLECTIONS",permission:null,acl:null},TOPNAV_EXPORT:{feature:"EXPORT_AS_PDF",permission:null,acl:null},TOPNAV_PRINT:{feature:null,permission:null,acl:null},NOTIFICATION_NAV_JOBS:{feature:null,permission:null,acl:null},NOTIFICATION_NAV_EMAIL:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},NOTIFICATION_NAV_ANNOUNCE:{feature:null,permission:null,acl:null},NOTIFICATION_NAV_ALERT:{feature:null,permission:null,acl:null},RIGHTNAV_PROFILE:{feature:null,permission:null,acl:null},RIGHTNAV_SETTINGS:{feature:null,permission:null,acl:null},RIGHTNAV_LOGOUT:{feature:null,permission:null,acl:null},WIT_CARD_EDIT:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_CARD_COPY:{feature:null,permission:null,acl:null},WIT_CARD_CUT:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_CARD_SHARE:{feature:"CONTENT_SHARING",permission:null,acl:"OWNER_OR_CFS"},WIT_CARD_WORKFLOW:{feature:"WORKFLOWS",permission:"MANAGE_WORKFLOWS",acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_CARD_FIND_DUPLICATES:{feature:"IDENTIFY_DUPLICATE_CONTENT",permission:null,acl:null},WIT_CARD_AUTO_TAG:{feature:"AUTO_TAGGING",permission:"AUTO_TAGGING",acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_CARD_LABEL:{feature:"LABELS",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_CARD_DELETE:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_CARD_EMAIL:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},WIT_CARD_SOCIAL_MEDIA:{feature:"SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},WIT_CARD_PREVIEW:{feature:null,permission:null,acl:null},WIT_CARD_WITLINK:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:"CFS"},HOME_FAB_NEW_WIT:{feature:"WITS",permission:null,acl:null},HOME_FAB_DOC_WIT:{feature:"DOCS",permission:null,acl:null},HOME_FAB_COMBO_WIT:{feature:"COMBO_WITS",permission:null,acl:null},HOME_FAB_DISCOVER_WIT:{feature:"DISCOVER_WITS_FROM_DOCS-DISCOVER_WITS_FROM_PPT-DISCOVER_WITS_FROM_PDF",permission:null,acl:null},HOME_FAB_HOTLINKS:{feature:"PUBLIC_HOTLINKS-PRIVATE_HOTLINKS",permission:null,acl:null},HOME_FAB_EMAIL:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},HOME_FAB_SOCIAL_MEDIA:{feature:"SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},HOME_FAB_BROADCAST:{feature:"MESSAGE_BROADCAST",permission:null,acl:null},FOLDER_RC_RENAME:{feature:null,permission:null,acl:"EDIT_WIT_AND_EDIT_WIT_FOLDER"},FOLDER_RC_FOLDER:{feature:null,permission:null,acl:"EDIT_WIT_AND_EDIT_WIT_FOLDER"},FOLDER_RC_ORDER:{feature:null,permission:null,acl:"OWNER"},WIT_RC_WIT_ORDER:{feature:"WITS",permission:null,acl:"OWNER"},FOLDER_RC_COLLECTION:{feature:"COLLECTIONS",permission:null,acl:null},FOLDER_RC_DELETE:{feature:null,permission:null,acl:"EDIT_WIT_AND_EDIT_WIT_FOLDER"},FOLDER_RC_WIT:{feature:"WITS",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},FOLDER_RC_DOC_WIT:{feature:"DOCS",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},FOLDER_RC_CUT:{feature:null,permission:null,acl:"EDIT_WIT_AND_EDIT_WIT_FOLDER"},FOLDER_RC_COPY:{feature:null,permission:null,acl:null},FOLDER_RC_PASTE:{feature:"WITS-DOCS-COMBO_WITS",permission:null,acl:"FOLDER_PASTE"},FOLDER_RC_SHARE:{feature:"CONTENT_SHARING",permission:null,acl:"OWNER_OR_CFS"},FOLDER_RC_REFRESH:{feature:null,permission:null,acl:null},FOLDER_RC_AUTO_TAG:{feature:"AUTO_TAGGING",permission:"AUTO_TAGGING",acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},FOLDER_RC_PROP:{feature:null,permission:null,acl:null},FOLDER_RC_FIND_DUPLICATE:{feature:"IDENTIFY_DUPLICATE_CONTENT",permission:null,acl:null},TAG_RC_ADD_TAG_GROUP:{feature:"TAGS_AND_TAG_GROUPS",permission:"MANAGE_ENTERPRISE_TAGS",acl:null},CATEGORY_REFRESH:{feature:null,permission:null,acl:null},TAG_RC_RENAME:{feature:"TAGS_AND_TAG_GROUPS",permission:"MANAGE_ENTERPRISE_TAGS",acl:null},TAG_RC_ADD_TAG:{feature:"TAGS_AND_TAG_GROUPS",permission:"MANAGE_ENTERPRISE_TAGS",acl:null},TAG_RC_CREATE_COLLECTION:{feature:"COLLECTIONS",permission:null,acl:null},TAG_RC_DELETE:{feature:"TAGS_AND_TAG_GROUPS",permission:"MANAGE_ENTERPRISE_TAGS",acl:null},TAG_REFRESH:{feature:null,permission:null,acl:null},COLLECTION_RC_EDIT:{feature:null,permission:null,acl:null},COLLECTION_RC_DISABLE:{feature:null,permission:"MANAGE_ENTERPRISE_COLLECTION",acl:null},COLLECTION_RC_DELETE:{feature:null,permission:null,acl:null},WIT_PREVIEW_EMAIL:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},WIT_PREVIEW_SOCIAL:{feature:"SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},WIT_PREVIEW_EDIT:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_PREVIEW_SHARE:{feature:"CONTENT_SHARING",permission:null,acl:"OWNER_OR_CFS"},WIT_PREVIEW_DOWNLOAD:{feature:"EXPORT_AS_PDF",permission:null,acl:null},WIT_PREVIEW_COPY:{feature:null,permission:null,acl:null},WIT_PREVIEW_EXPORT:{feature:"EXPORT_AS_PDF",permission:null,acl:null},WIT_PREVIEW_LOCK:{feature:"LOCKED_WITS",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},CREATE_WIT_VERSION:{feature:"CONTENT_VERSIONING",permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_PREVIEW_SAVE_AS:{feature:"WITS-DOCS-COMBO_WITS",permission:null,acl:null},WIT_PREVIEW_ADD_COMMENT:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER_OR_COMMENT"},WIT_HEADER_SAVE:{feature:"WITS-DOCS-COMBO_WITS",permission:null,acl:null},WIT_HEADER_PREVIEW:{feature:null,permission:null,acl:null},WIT_HEADER_SAVE_AS:{feature:null,permission:null,acl:null},WIT_HEADER_SET_EXPIRY:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER"},WIT_ADD_COMMENT:{feature:null,permission:null,acl:"EDIT_WIT_OR_EDIT_WIT_FOLDER_OR_COMMENT"},WIT_ADD_UPDATE_NOTES:{feature:null,permission:null,acl:"EDIT_WIT"},WIT_ADD_UPDATE_TAGS:{feature:"TAGS_AND_TAG_GROUPS",permission:null,acl:"EDIT_WIT"},WIT_VERSION_DISPLAY:{feature:"CONTENT_VERSIONING",permission:null,acl:"EDIT_WIT"},WIT_VERSION_OPEN:{feature:null,permission:null,acl:"EDIT_WIT"},FILE_UPLOAD_BOX:{feature:"BOX_INTEGRATION",permission:null,acl:null},FILE_UPLOAD_SHAREPOINT:{feature:"SHAREPOINT_365_INTEGRATION",permission:null,acl:null},CAMPAIGN_ACCOUNT_ADD:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_ACCOUNT_REQUEST:{feature:"CAMPAIGN_ACCOUNT_DELEGATION",permission:null,acl:null},CAMPAIGN_ACCOUNT_DELETE:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_ACCOUNT_EDIT:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_ACCOUNT_DELEGATE:{feature:"CAMPAIGN_ACCOUNT_DELEGATION",permission:null,acl:null},CAMPAIGN_ACCOUNT_DELETE_DELEGATE:{feature:"CAMPAIGN_ACCOUNT_DELEGATION",permission:null,acl:null},CAMPAIGN_ACCOUNT_EDIT_DELEGATE:{feature:"CAMPAIGN_ACCOUNT_DELEGATION",permission:null,acl:null},CAMPAIGN_ACCOUNT_SOCIAL:{feature:"SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_ACCOUNT_EMAIL:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_TASK_DELETE:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_TASK_EDIT:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},CAMPAIGN_TASK_APPROVE:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},ACCESS_ADMIN_ACCOUNT:{feature:null,permission:"MANAGE_ENTERPRISE_PROFILE",acl:null},ACCESS_ADMIN_USERS:{feature:null,permission:"MANAGE_USERS-MANAGE_USERS_GROUPS",acl:null},ACCESS_ADMIN_ROLES:{feature:null,permission:"MANAGE_ROLES",acl:null},ACCESS_ADMIN_SHARED_GROUPS:{feature:null,permission:"MANAGE_USERS_GROUPS",acl:null},ACCESS_ADMIN_ROLLUP_GROUPS:{feature:null,permission:"MANAGE_ROLLUP_GROUPS",acl:null},ACCESS_ADMIN_WORKSPACE:{feature:null,permission:"MANAGE_WORKSPACES",acl:null},ACCESS_ADMIN_INTEGRATION:{feature:null,permission:"MANAGE_ENTERPRISE_INTEGRATIONS",acl:null},ACCESS_ADMIN_COLLECTIONS:{feature:"COLLECTIONS",permission:"MANAGE_ENTERPRISE_COLLECTION",acl:null},ACCESS_ADMIN_WHITELABEL:{feature:"WHITELABELLING",permission:"MANAGE_WHITELABELLING",acl:null},ACCESS_ADMIN_CAMPAIGN:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS-SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:"MANAGE_ENTERPRISE_CAMPAIGN_PARAMETERS",acl:null},ACCESS_ADMIN_WORKFLOW_TEMPLATES:{feature:"WORKFLOW_TEMPLATES",permission:"MANAGE_WORKFLOW_TEMPLATES",acl:null},ACCESS_ADMIN_DECISION_FIELDS:{feature:"WORKFLOWS",permission:"MANAGE_DECISION_FIELDS",acl:null},MANAGE_CONTACT_GROUPS:{feature:null,permission:"MANAGE_CONTACT_GROUPS",acl:null},MANAGE_ENTERPRISE_COLLECTION:{feature:null,permission:"MANAGE_ENTERPRISE_COLLECTION",acl:null},MANAGE_ENTERPRISE_PROFILE:{feature:null,permission:"MANAGE_ENTERPRISE_PROFILE",acl:null},MANAGE_ENTERPRISE_TAGS:{feature:null,permission:"MANAGE_ENTERPRISE_TAGS",acl:null},MANAGE_MICROSITES:{feature:null,permission:"MANAGE_MICROSITES",acl:null},MANAGE_ROLES:{feature:null,permission:"MANAGE_ROLES",acl:null},MANAGE_ROLLUP_GROUPS:{feature:null,permission:"MANAGE_ROLLUP_GROUPS",acl:null},MANAGE_USERS:{feature:null,permission:"MANAGE_USERS",acl:null},MANAGE_WORKSPACES:{feature:null,permission:"MANAGE_WORKSPACES",acl:null},MANAGE_USERS_GROUPS:{feature:null,permission:"MANAGE_USERS_GROUPS",acl:null},MANAGE_WORKFLOWS:{feature:null,permission:"MANAGE_WORKFLOWS",acl:null},MANAGE_PUBLIC_HOTLINKS:{feature:null,permission:"MANAGE_PUBLIC_HOTLINKS",acl:null},USER_GROUPS:{feature:"USER_GROUPS",permission:null,acl:null},SHARE_GROUP_ACCESS:{feature:"USER_GROUPS",permission:null,acl:null},BROADCAST_GROUP_ACCESS:{feature:"USER_GROUPS",permission:null,acl:null},TAB_REFRESH:{feature:null,permission:null,acl:null},ENTERPRISE_ANALYTICS:{feature:"ANALYTICS",permission:"VIEW_ENTERPRISE_ANALYTICS",acl:null},OFFICE_ONLINE_VIEWER:{feature:"OFFICE_ONLINE_VIEWER",permission:null,acl:null},OFFICE_ONLINE_EDITOR:{feature:"OFFICE_ONLINE_EDITOR",permission:null,acl:null},ROLLUP_GROUP_CREATE:{feature:null,permission:null,acl:null},ROLLUP_GROUP_UPDATE:{feature:null,permission:null,acl:null},ROLLUP_GROUP_REMOVE:{feature:null,permission:null,acl:null},DOCUSIGN:{feature:"DOCUSIGN",permission:null,acl:null},CREATE_PAGE_GROUP:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},SET_MICROSITE_PERMISSION:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},UPDATE_MICROSITE:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},DELETE_MICROSITE:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},RENAME_PAGE_GROUP:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},DELETE_PAGE_GROUP:{feature:"PUBLIC_WITLINKS-PROTECTED_WITLINKS",permission:"MANAGE_WIT_LINKS",acl:null},WHITELABEL_ACCESS:{feature:"WHITELABEL_PARTIAL-WHITELABEL_COMPLETE",permission:null,acl:null},WIT_STATUS_ENABLED:{feature:"CRM_PACKAGED_VIEW",permission:null,acl:null},DIMENSIONS:{feature:"DIMENSIONS",permission:null,acl:null},EVENT_WORKFLOW:{feature:"DRIP_CAMPAIGN",permission:null,acl:null},PARROT_SINGLE_LEVEL_FOLDERS:{feature:"SINGLE_LEVEL_FOLDERS",permission:null,acl:null},PARROT_EMAIL:{feature:"EMAIL_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},PARROT_SOCIAL:{feature:"SOCIAL_MEDIA_CAMPAIGN_AND_ANALYTICS",permission:null,acl:null},PARROT_PUBLIC_WITLINKS:{feature:"PUBLIC_WITLINKS",permission:null,acl:null},PARROT_TEXT_WITS:{feature:"CONTENT_WITS",permission:null,acl:null},PARROT_LABELS:{feature:"LABELS",permission:null,acl:null},PARROT_EMAIL_TO_WIT:{feature:"EMAIL_TO_WIT",permission:null,acl:null},PARROT_WEB_CLIPPING:{feature:"WEB_CLIPPING",permission:null,acl:null},PARROT_CHROME_PLUGIN:{feature:"CHROME_PLUGIN",permission:null,acl:null},PARROT_BASIC_ANALYTICS:{feature:"BASIC_ANALYTICS",permission:null,acl:null},PARROT_MULTIPLE_LEVEL_FOLDERS:{feature:"MULTIPLE_LEVEL_FOLDERS",permission:null,acl:null},PARROT_FOLDER_SHARING_READ_ONLY:{feature:"FOLDER_SHARING_READ_ONLY",permission:null,acl:null},PARROT_COLLECTIONS:{feature:"COLLECTIONS",permission:null,acl:null},PARROT_DOC_WITS:{feature:"DOC_WITS",permission:null,acl:null},PARROT_BOX:{feature:"BOX_INTEGRATION",permission:null,acl:null},PARROT_SHAREPOINT_2010:{feature:"SHAREPOINT_2010_INTEGRATION",permission:null,acl:null},PARROT_SHAREPOINT_365:{feature:"SHAREPOINT_365_INTEGRATION",permission:null,acl:null},PARROT_OFFICE_ONLINE_EDITOR:{feature:"OFFICE_ONLINE_EDITOR",permission:null,acl:null},PARROT_WIT_NOTES:{feature:"WIT_NOTES",permission:null,acl:null},PARROT_WIT_HISTORY:{feature:"WIT_HISTORY",permission:null,acl:null},PARROT_WIT_FILTERS_ADVANCED:{feature:"WIT_FILTERS_ADVANCED",permission:null,acl:null},PARROT_ANALYTICS:{feature:"WIT_HISTORY",permission:null,acl:null},PARROT_USER_ADMIN:{feature:"USER_ADMIN",permission:null,acl:null},PARROT_EMAIL_TRACKING:{feature:"EMAIL_TRACKING",permission:null,acl:null},PARROT_EMAIL_SCHEDULING:{feature:"EMAIL_SCHEDULING",permission:null,acl:null},PARROT_SOCIAL_MEDIA_SCHEDULING:{feature:"SOCIAL_MEDIA_SCHEDULING",permission:null,acl:null},PARROT_ANNEXURE_WITS:{feature:"ANNEXURE_WITS",permission:null,acl:null},PARROT_PUBLIC_HOTLINKS:{feature:"PUBLIC_HOTLINKS",permission:null,acl:null},PARROT_PRIVATE_HOTLINKS:{feature:"PRIVATE_HOTLINKS",permission:null,acl:null},PARROT_BULK_MAIL:{feature:"BULK_MAIL",permission:null,acl:null},PARROT_CONTENT_AND_DOC_WITS:{feature:"CONTENT_WITS_AND_DOC_WITS",permission:null,acl:null}},r={};return r.hasPermission=function(o,r){var l=!0,s=i.shouldCheckAppPermission();if(s){var c=a[o];c?(c.feature&&(l=e.hasAccessOf(c.feature)),l&&c.permission&&(l=n.hasAccessOf(c.permission)),l&&c.acl&&(l=t.hasAccessOf(c.acl,r))):l=t.hasAccessOf(o,r)}return l},r}])}(),function(){"use strict";angular.module("wpoffice").provider("appPermissionConfig",[function(){var e=!0;this.setShouldCheckAppPermission=function(t){e=t},this.$get=function(){function t(){return e}return{shouldCheckAppPermission:t}}}])}(),function(){"use strict";angular.module("wpoffice").factory("accessControlManager",["TRANSFER_ACTION","reusableDataFactory","$rootScope",function(e,t,n){function o(o,a){var l=i,s=!1;if(a){var c=void 0!==r[o];if(c){l=!0;for(var u=r[o].split("-"),d="",p=!1,f=0;f<u.length;f++)if(d=u[f],d.search("metaData")!==-1){var m=n.$eval(d).metaData;if(m.and)s=!0;else{s=!0;var g=t.hasTransferableItem(m.type);g?(u.splice(1,1),l=l&&g):l=l&&t.hasTransferableItem(e.TYPE.FOLDER)}}else if(p="!"===d[0],p&&(d=d.slice(1).trim()),s){if(l=l&&a[d]!==p,!l)break}else if(l=!1,l=l||a[d]!==p)break}}return l}var i=!1,a={},r={READ_ONLY:"canRead",COMMENT_ONLY:"canComment",EDIT_WIT:"canEditWits-owner",EDIT_WIT_FOLDER:"canEditFolderAndWits",CFS:"canFurtherShare",OWNER:"owner",EDIT_WIT_OR_EDIT_WIT_FOLDER:"canEditWits-canEditFolderAndWits",EDIT_WIT_OR_EDIT_WIT_FOLDER_OR_COMMENT:"canEditWits-canEditFolderAndWits-canComment",OWNER_OR_CFS:"owner-canFurtherShare",EDIT_WIT_AND_EDIT_WIT_FOLDER:"{metaData : {and : true}}-canEditWits-canEditFolderAndWits",EDIT_WIT_AND_EDIT_WIT_FOLDER_AND_COMMENT:"{metaData : {and : true}}-canEditWits-canEditFolderAndWits-canComment",OWNER_AND_CFS:"{metaData : {and : true}}-owner-canFurtherShare",ANY:"owner-canComment-canRead-canEditFolderAndWits-canEditWits",ADD_TAG:"canEditWits-owner",WIT_MOVE:"canEditWits",AUTO_TAG:"owner-canEditFolderAndWits-canEditWits",FOLDER_PASTE:"{metaData : {type : "+e.TYPE.WIT+"}}-canEditFolderAndWits-canEditWits",FOLDER_DELETE:"canEditFolderAndWits",FOLDER_COPY:"canRead",EDIT_FOLDER:"canEditFolderAndWits",READ_FOLDER:"canRead",READ_WIT:"canRead"};return a.hasAccessOf=function(e,t){return o(e,t)},a}])}(),function(){"use strict";angular.module("wpoffice").directive("hasPermission",["appPermissionFactory",function(e){var t={link:function(t,n,o){function i(){return t.$eval(o.permissionAttr)}function a(e){r(e),l(u)}function r(e){e&&(e.shouldElementRemove&&(s.shouldElementRemove=e.shouldElementRemove),e.shouldElementHide&&(s.shouldElementHide=e.shouldElementHide),e.shouldElementDisable&&(s.shouldElementDisable=e.shouldElementDisable),e.themeClassName&&(s.themeClassName=e.themeClassName,s.shouldElementRemove=!1),e.permission&&(s.permission=e.permission))}function l(t){var o=e.hasPermission(t,s.permission),i="",a=!1;s.shouldElementHide?i="hide-element":s.shouldElementDisable?i="disable-element":s.themeClassName?i=s.themeClassName:a=!0,o?a?"":n.removeClass(i):a?n.remove():n.addClass(i)}var s={shouldElementRemove:!0,shouldElementHide:!1,shouldElementDisable:!1,themeClassName:"",permission:null},c=null;if(o.hasPermission){var u=o.hasPermission.trim(),d="!"===u[0];d&&(u=u.slice(1).trim()),c=t.$watch(i,function(e){a(e)},!0),t.$on("$destroy",function(){c?c():""})}}};return t}])}(),function(){"use strict";function e(e,t,n,o){var i=["bold","italic","underline","strikeThrough","subscript","superscript","fontFamily","fontSize","color","emoticons","inlineStyle","align","formatOL","formatUL","outdent","indent","selectAll","insertLink","insertImage","insertVideo","insertTable","undo","redo","html","fullscreen","print","specialCharacters"];"parrot365"===e.config&&i.push("acronym");var a=["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","data-default","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","width","wrap","var","embedid","ng-.*"];e.initialContent=e.content,e.froalaOptions={theme:"gray",toolbarBottom:!1,charCounterCount:!1,toolbarButtons:i,toolbarButtonsMD:i,toolbarButtonsSM:i,toolbarButtonsXS:i,acronyms:!0,enter:$.FroalaEditor.ENTER_BR,htmlAllowedAttrs:a}}function t(t,n,o){var i={restrict:"E",transclude:!0,templateUrl:function(e,t){return"app/views/wit-editor/wit-editor-template.html"},scope:{content:"=",config:"@"},controller:e,link:function(e,t){var o=t.find('[href="https://froala.com/wysiwyg-editor"]');o.remove(),n.scopeInitializer(e),e.showMan=function(){}}};return i}e.$inject=["$scope","witEditorUtil","$sce","witService"],t.$inject=["$parse","witEditorUtil","witService"];var n=angular.module("wpoffice");n.value("froalaConfig",{toolbarInline:!1,htmlUntouched:!1,placeholderText:"Enter Text Here"}),n.controller("FroalaEditorController",e),n.directive("witEditor",t)}(),function(){"use strict";function e(e){function t(e){e=e,h=e.froalaOptions.froalaEditor;var t=document.getElementById("witTitle");t.focus(),t.select()}function n(){var e={};E=[];for(var t=document.getElementsByClassName("var_acronym"),n=0;n<t.length;n++){var o=t[n].getAttribute("var"),i=t[n].getAttribute("data-default");E.push({name:o,defaultValue:i})}return e.acronyms=E,e.length=t.length,e}function o(){return n().acronyms}function i(e){E.length=0,Array.isArray(e)&&(e.sort(function(e,t){return e.sequenceNumber<t.sequenceNumber?-1:1}),e.forEach(function(e){e.defaultValue&&(e.value=e.defaultValue),E.push(e)}))}function a(){return h?h("html.get"):null}function r(e){if(void 0,
h)return h("html.set",e)}function l(e){v=e}function s(){return v}function c(e){for(var t=document.getElementsByClassName("var_acronym"),n=0;n<t.length;n++)if(t[n].getAttribute("var")===e)return t[n].getAttribute("data-default")}function u(e){for(var t=document.getElementsByClassName("var_acronym"),n=0;n<t.length;n++){var o=t[n].getAttribute("var");o===Object.keys(e)[0]&&t[n].setAttribute("data-default",e[o])}}function d(){for(var e=document.getElementsByClassName("var_acronym"),t=0;t<e.length;t++){var n=e[t].getAttribute("var"),o=e[t].getAttribute("data-default");""!==o&&n!==o?(e[t].innerText=o,e[t].style.color="inherit"):(e[t].innerText="["+n+"]",e[t].style.color="rgb(236, 27, 82)")}}function p(){for(var e=document.getElementsByClassName("var_acronym"),t=0;t<e.length;t++){var n=e[t].getAttribute("var");n!=="["+n+"]"&&(e[t].innerText="["+n+"]",e[t].style.color="rgb(236, 27, 82)")}}function f(e){var t=document.createElement("div");t.innerHTML=e;for(var n,o,i=t.querySelectorAll(".var_acronym"),a=0;a<i.length;a++)n=i[a],o=n.getAttribute("var"),n.innerText="["+o+"]",n.style.color="rgb(236, 27, 82)";return t.innerHTML}function m(){var e={};return e.acronyms=E,e.length=E.length,e}function g(){for(var e=[],t=document.getElementsByClassName("embeddedWit"),n=0;n<t.length;n++){var o=t[n].getAttribute("embedid");t[n].innerText="",e.push(o)}return void 0,e}var h=[],E=[],v="";return{scopeInitializer:t,getData:a,setData:r,getAcronyms:o,setAcronyms:i,setSelectedAcronym:l,getSelectedAcronym:s,setSelectedAcronymValue:u,getSelectedAcronymValue:c,updateAcronyms:d,restoreAcronyms:p,restoreToUglyAcronymsForEdit:f,populateAcronymData:m,getEmbedWits:g}}e.$inject=["$sce"];var t=angular.module("wpoffice");t.factory("witEditorUtil",e)}(),function(){$.FroalaEditor.DefineIconTemplate("wittyparrot-custom-font",'<i class="[NAME]"></i>'),$.FroalaEditor.DefineIcon("variable",{NAME:"icon-variable",template:"wittyparrot-custom-font"}),$.FroalaEditor.RegisterCommand("acronym",{title:"Variable",icon:"variable",undo:!0,focus:!0,showOnMobile:!0,refreshAfterCallback:!1,callback:function(){this.acronymPlugin.createAcronyms()},refresh:function(e){}})}(),function(e){e.FroalaEditor.DEFAULTS=e.extend(e.FroalaEditor.DEFAULTS,{acronyms:!1}),e.FroalaEditor.PLUGINS.acronymPlugin=function(e,t){function n(e,t){for(var n=document.getElementsByClassName("var_acronym"),o=0;o<n.length;o++){var i=n[o].getAttribute("var");i===e&&n[o].setAttribute("data-default",t)}}function o(){var t=e.selection.text();if(""===t)return void 0,"Invalid";l[t]="["+t+"]";var n='<span class="var_acronym" style="color:rgb(236, 27, 82);"          data-default="" var="'+t+'" >'+l[t]+"</span>&nbsp;";return e.html.insert(n,!0),"valid"}function i(){return l}function a(e){var t=Object.keys(e)[0];l[t]=e[t],n(t,e[t]),i()}function r(){}var l={};return{_init:r,createAcronyms:o,listAcronym:i,acronymAssign:a}}}(jQuery),function(){"use strict";angular.module("wpoffice").controller("DocEditController",["$scope","$state","$stateParams","witService","appData",function(e,t,n,o,i){function a(e){var t=document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}function r(){n.fileId?(l.fileId=n.fileId,s=n.operation||"Edit"):t.go("main")}var l=this;l.viewerHeight=window.innerHeight-5+"px",l.fileId;var s;l.getWopiUrl=function(){return o.getFileUrlFromWopi(l.fileId,s).then(function(e){return e.faviconUrl&&a(e.faviconUrl),e})["catch"](function(){setTimeout(function(){window.history.back()},400)})},e.$on("destroy",function(){a("favicon.ico")}),r()}])}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c,u,d,p,f,m,g,h,E,v,w,A,I,T,y,C,_,b,S,O,D,N,L,P,W){function R(t){void 0,X.noResultsBanner=!1;var n=[];g.isContentLoaded=!1,v.search(t).then(function(t){t.witResult.forEach(function(e){n.push(e.witId)}),n.length>0?d.listWitByIds(n).then(function(t){e.$broadcast("UPDATE_WIT_LISTING",{witContainer:t}),g.isContentLoaded=!0}):(void 0,X.noResultsBanner=!0,g.isContentLoaded=!0)})}function F(e){var t=P.defer(),n="",o=[];return angular.forEach(e,function(e,t){o.push({witFileAssociationId:e.fileAssociationId,attachmentType:"LIVE"})}),d.getPublicUrls(o).then(function(e){X.publicFileIds=e,angular.forEach(X.publicFileIds,function(e){n+="<p>"+location.protocol+"//"+location.hostname+"/api/wittyparrot/api/public/attachments/"+e.publicAttachmentId+"</p>"}),t.resolve(n)},function(e){t.resolve(),void 0}),t.promise}function k(e){var t=e?e.fileAssociationId:X.wit.attachmentDetails[0].fileAssociationId;return w.downloadAttachment(t)}function x(e){var t=e?e:X.wit.attachmentDetails[0].fileAssociationId;return w.getWopiUrl(t)}function M(e){var t=e?e:X.wit.attachmentDetails[0].fileAssociationId,n=window.location.origin;X.isChromeExtension&&(n="https://"+g.host+".wittyparrot.com");var o=n+"/wittyparrot/api/attachments/previews/"+t,i="bearer "+g.tokenKey.split("bearer")[1],a=n+"/resources/external/pdf-viewer/index.html?file="+o;return a+="&authorization="+i,s.trustAsResourceUrl(a)}function U(e){var t,n,o=[],i="";for(var a in e)t=d.getWit(e[a]).then(function(t){i=i+"<div class='embeddedWit' contenteditable='false' embedid="+e[a]+">"+t.content+"</div><br/>"}),o.push(t);return n=P.all(o).then(function(){return i})}function G(e,t,n){t=t||window;var o,i,a=t.document;t.getSelection&&a.createRange?(n||(void 0,e=e.getElementsByClassName("wit-content-preview")[0]),o=t.getSelection(),i=a.createRange(),i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i)):a.body.createTextRange&&(i=a.body.createTextRange(),i.moveToElementText(e),i.select())}function V(e){e.size>S.MAX_SIZE_IN_BYTE&&(X.removeFile(e),D.set("File is bigger than the 200MB which is maximum file size allowed","error"))}function B(e){var t=X.beforeEditWitObj;void 0,null==t.attachmentDetails&&(t.attachmentDetails=[]);var n={};n.fileId=e.fileId,n.fileName=e.fileName,n.extention="."+O.getFileExtension(e.fileName),n.attachmentType="LOCAL",n.seqNumber=0,t.attachmentDetails.push(n),void 0}function H(e){void 0,X.newWit.attachmentDetails||(X.newWit.attachmentDetails=[]);var t={};t.fileId=e.fileId,t.fileName=e.fileName,t.extention="."+O.getFileExtension(e.fileName),t.attachmentType="LOCAL",t.seqNumber=0,X.newWit.attachmentDetails.push(t),void 0}function j(e,t){var n=X.beforeEditWitObj;void 0,n[e]=t,void 0}function Y(e,t){void 0,X.newWit[e]=t,void 0}function z(e,t){var n;if("addMode"===t)var o=X.newWit.attachmentDetails;else if("editMode"===t)var o=X.beforeEditWitObj.attachmentDetails;angular.forEach(o,function(t,i){n=o.filter(function(t){if(!Array.isArray(e))return t.fileAssociationId?t.fileAssociationId!==e:t.fileId!==e})}),"addMode"===t?X.newWit.attachmentDetails=n:"editMode"===t&&(X.beforeEditWitObj.attachmentDetails=n)}function K(e){".docx"!==e.extention&&".xlsx"!==e.extention&&".pptx"!==e.extention||(X.setActiveState("witlist"),X.refreshContent()),X.docWitProcessed=!1;var t=[];X.fileDetails=null;var n={fileName:e.fileName,extention:O.getFileExtension(e.fileName),attachmentType:"LOCAL",seqNumber:0,fileId:e.fileId};e.witId&&(n.witId=e.witId),X.newWitName=e.fileName.substr(0,e.fileName.lastIndexOf(".")),t.push(n),X.fileDetails=n,X.docWitProcessed=!0}function q(){void 0,X.newWitName="",X.editWitName="",X.fileDetails="",X.docWitProcessed=!1,X.wit={},X.newWit={}}var Z=null;e.witData={id:null,name:"",content:"",attachmentDetails:[],comboWit:null,desc:"",source:"WITTYPARROT",note:"",parentId:null,tagVos:[],expiryDate:"",firstAlert:"",secondAlert:"",locale:"en_US",loggedInUserPermission:{owner:!0}},e.activeTab="collections",e.setActive=function(t){e.activeTab=t},e.appData=g,e.showSettings=!1,e.showAttachmenItms=!1,e.showNotes=!1,e.showComment=!1,e.showShare=!1;var X=this;X.currentLocation="main",X.currentItem=!1,X.winId="",X.wit={},X.newWit={},e.collapsed=!0,g.isContentLoaded=!1,g.isSidenavActive=!1,X.acronymList=[],X.searchEnabled=!1,X.moreFooterOptions=!1,X.activeState="witlist",X.witInsertTooltip="chrome-extension"===g.source?"Drag and Drop Wit Content":"Click to insert the Wit content at cursor position",X.isOutlook="msoffice"!==g.source&&"chrome-extension"!==g.source&&"mobile-app"!==g.source,X.isChromeExtension="chrome-extension"===g.source,X.isMobileApp="mobile-app"===g.source,X.devMode=!!g.devMode,"undefined"!=typeof Word?X.isWord=!0:X.isWord=!1;var Q=new Date,J=Q.getTime();J+=36e6,Q.setTime(J),"true"!=docCookies.getItem("isNormalContent")&&docCookies.setItem("isNormalContent",!1,Q.toUTCString(),"/"),e.searchOptions={searchTerm:"",workspaceIds:[],witType:[],searchFields:[],filterByTagId:[],filterByFolderId:[],dateBegin:null,dateEnd:null},X.sortByName="modifiedDate",X.descending=!1,X.sortBy=[{name:"Created date",type:"createdDate"},{name:"Modified date",type:"modifiedDate"},{name:"Name",type:"name"}],X.witFilter=X.sortBy[1].type,e.$on("RESET_WITS_FILTER",function(e,t){X.witFilter=X.sortBy[1].type}),X.filterFolderWits=function(t){var n;n=X.descending?"desc":"asc",e.$broadcast("FILTER_WITS_OF_FOLDER",{filter:t,sortBy:n})},X.toggleSort=function(){var t;t=X.descending?"asc":"desc",e.$broadcast("FILTER_WITS_OF_FOLDER",{filter:X.witFilter,sortBy:t}),X.descending=!X.descending},X.filterByField=function(e){X.sortByName=e},X.searchWit=function(t){var n=[];g.witSelected=!1,g.isContentLoaded=!1,e.searchOptions.searchTerm=t,v.search(e.searchOptions).then(function(e){e.witResult.forEach(function(e){n.push(e.witId)}),n.length>0&&d.listWitByIds(n).then(function(e){g.witResponseList=e}),g.isSidenavActive=!1,g.isContentLoaded=!0})},X.shouldShowAccountMenu=function(t){t.stopPropagation(),e.visibilityStatus=!e.visibilityStatus};e.labels=[{labelName:"Red",labelIcon:"icon-label-red"},{labelName:"Orange",labelIcon:"icon-label-orange"},{labelName:"Yellow",labelIcon:"icon-label-yellow"},{labelName:"Green",labelIcon:"icon-label-green"},{labelName:"Blue",labelIcon:"icon-label-blue"},{labelName:"Purple",labelIcon:"icon-label-purple"},{labelName:"Pinned",labelIcon:"icon-pin"},{labelName:"Favourite",labelIcon:"icon-favorite"},{labelName:"Bookmark",labelIcon:"icon-bookmark"}],e.searchScopes={Title:"Wit Title",Content:"Wit Content",Notes:"Notes",FileName:"File Name",FolderName:"Folder Name",DocumentContent:"Doc Content",FileExtension:"File Extension",Category:"Category Name",CategoryValue:"Value Name",TagName:"Tag Name",ORDINARY:"Text Wit",DOC_WIT:"Doc Wit",COMBO:"Combo wit"},e.age={created:"Created",modified:"Modified",used:"Used",pastDay:"Past Day",pastWeek:"Past Week",pastMonth:"Past Month",pastYear:"Past Year"},e.status={"8b31440c-b2df-11e6-8ce0-1225d6964b3d":"Init","81544dd8-b2df-11e6-8ce0-1225d6964b3d":"Pending","738b8657-b2df-11e6-8ce0-1225d6964b3d":"Completed"},e.createWitMenu=[{labelName:"Text Wit",labelIcon:"icon-wit"},{labelName:"Doc Wit",labelIcon:"icon-categories"}],e.bulkActionMenu=[{labelName:"Create Collection",labelIcon:"icon-widget"},{labelName:"Create Embed Wit",labelIcon:"icon-embed"},{labelName:"Permission",labelIcon:"icon-shared"},{labelName:"Trash",labelIcon:"icon-delete"}],e.rewar=[{labelName:"Profile",labelIcon:"icon-personal"},{labelName:"Logout",labelIcon:"icon-logout"}],e.moreMenu=[{labelName:"Profile",labelIcon:"icon-personal"},{labelName:"Feedback",labelIcon:"icon-help"},{labelName:"WordVariable",labelIcon:"icon-logout"},{labelName:"Logout",labelIcon:"icon-logout"}],e.grabLabelValue=function(t){e.labelValue=t},X.searchterm="";var ee=[],te=[],ne=[],oe=[],ie=[],ae=function(){ee.length||te.length||ne.length?X.resetSet=!0:X.resetSet=!1};e.grabScopeValue=function(t,n){switch(t){case"ORDINARY":case"DOC_WIT":case"COMBO":if(n)te.push(t);else{var o=te.indexOf(t);te.splice(o,1)}void 0,e.searchOptions.witType=te;break;default:if(n)ee.push(t);else{var i=ee.indexOf(t);ee.splice(i,1)}void 0,e.searchOptions.searchFields=ee}ae(),e.searchOptions.searchTerm=X.searchterm,R(e.searchOptions)},e.listDataValue="",e.grabStatusValue=function(t,n){if(n)ne.push(t);else{var o=ne.indexOf(t);ne.splice(o,1)}void 0,e.searchOptions.witStatus=ne,ae(),e.searchOptions.searchTerm=X.searchterm,R(e.searchOptions)},e.grabAgeValue=function(e,t){switch(e){case"created":case"modified":case"used":oe=[],t?oe.push(e):oe=[],void 0;break;default:ie=[],t?ie.push(e):ie=[],void 0}oe.length>0&&ie.length>0&&void 0},e.grabTimeValue=function(t){e.timeValue=$.trim(t),"Past Day"===e.timeValue&&(void 0,e.searchOptions.dateBegin=moment().subtract(1,"days").toISOString()),"Past Week"===e.timeValue&&(void 0,e.searchOptions.dateBegin=moment().subtract(7,"days").toISOString()),"Past Month"===e.timeValue&&(void 0,e.searchOptions.dateBegin=moment().subtract(1,"months").toISOString()),"Past Year"===e.timeValue&&(void 0,e.searchOptions.dateBegin=moment().subtract(1,"years").toISOString()),R(e.searchOptions)},X.logOut=function(){g.isContentLoaded=!1,t.logout().then(function(e){g.isContentLoaded=!0})},X.getPublicWitlink=function(e){d.getPublicWitlink(e).then(function(e){X.witlinkInfo=e})},X.getComments=function(e){p.getWitComments(e).then(function(e){X.comments=e})},X.globalSearch=function(t,n){13===t.which&&(void 0,e.searchOptions.searchTerm=n,R(e.searchOptions))},X.clearSearch=function(){X.searchterm="",ee=[],te=[],ne=[],oe=[],ie=[],ae(),angular.element(".cdd-checkBox").prop("checked",!1),e.$broadcast("RESET_WIT_LISTING")},X.setActiveState=function(e){X.activeState=e,void 0},X.createWit=function(){void 0;var e={controller:"MainPopupController",templateUrl:"app/components/main-popup/main-popup.html",resolve:{mode:function(){return"witCreator"},callback:function(){return X.witCreationCallback}}};_.open(e)},X.settingsPopUp=function(){var e={controller:"MainPopupController",templateUrl:"app/components/main-popup/main-popup.html",resolve:{mode:function(){return"account"},callback:function(){return X.accountPopUpCallback}}};_.open(e)},X.accountPopUpCallback=function(e){"Profile"===e?X.setActiveState("profile"):"Logout"===e&&X.logOut()},X.witCreationCallback=function(e){e="Text Wit"===e?"ORDINARY":"DOC_WIT",X.setActiveState("witCreation");var t=document.getElementsByClassName("fr-element")[0];if(void 0!==t){t.innerHTML="";var n=document.getElementById("witTitle");void 0,n.focus(),n.select()}q(),g.newWitMode=!0,X.witCreationType=e},X.newOfficeDoc=function(t,n){var o=angular.copy(e.witData),i={attachmentType:"LOCAL",fileName:o.name};switch(n){case"docx":i.extension=".docx",i.fileMimeType="application/msword";break;case"pptx":i.extension=".pptx",i.fileMimeType="application/vnd.ms-powerpoint";break;case"xlsx":i.extension=".xlsx",i.fileMimeType="application/vnd.ms-excel";break;case"pub":i.extension=".pub",i.fileMimeType="application/x-mspublisher"}Z&&(i.fileAssociationId=Z),o.attachmentDetails=[],o.attachmentDetails.push(i),e.witData=o,d.setWitData(e.witData),X.openPopup("createOfficeWit")},X.addDocument=function(e,t){void 0,void 0,void 0},X.saveDocWit=function(){void 0;var e=X.editWitName||X.newWitName;void 0;var t={},n="Successfully created Doc Wit";e?(t.parentId=g.folderId,t.name=e,t.witType="DOC_WIT",X.fileDetails&&(t.attachmentDetails=[X.fileDetails]),X.fileDetails.witId&&(g.currentWitId=X.fileDetails.witId,g.newWitMode=!1),g.newWitMode?void 0:(t.id=g.currentWitId,t.updateNumber=g.updateNumber,void 0,n="Successfully updated Doc Wit"),g.isContentLoaded=!1,d.saveWit(t).then(function(e){g.newWitMode=!1,g.currentWitId=e.id,g.updateNumber=e.updateNumber,g.isContentLoaded=!0,D.set(n)},function(e){g.isContentLoaded=!0,void 0})):D.set("Please enter Doc Wit title","error")},X.saveWit=function(){void 0;var e=X.newWitName||X.editWitName;L.updateAcronyms();var t=L.getData();void 0;var n={},o="Successfully created Wit";e?(n.acronyms=L.getAcronyms(),void 0,n.parentId=g.folderId,n.name=e,n.witType="ORDINARY",n.content=t,angular.equals(X.newWit,{})||(void 0,X.newWit.attachmentDetails&&(n.attachmentDetails=X.newWit.attachmentDetails),X.newWit.note&&(n.note=X.newWit.note)),X.beforeEditWitObj&&X.beforeEditWitObj.attachmentDetails&&(n.attachmentDetails=X.beforeEditWitObj.attachmentDetails),X.beforeEditWitObj&&X.beforeEditWitObj.note&&(void 0,n.note=X.beforeEditWitObj.note),g.newWitMode?void 0:(n.id=g.currentWitId,n.updateNumber=g.updateNumber,void 0,o="Successfully updated Wit"),g.isContentLoaded=!1,d.saveWit(n).then(function(e){g.newWitMode=!1,g.currentWitId=e.id,g.updateNumber=e.updateNumber,g.isContentLoaded=!0,D.set(o)},function(e){g.isContentLoaded=!0,void 0})):D.set("Please enter Wit title","error"),L.restoreAcronyms()},X.editWit=function(e,t){void 0,X.newWitName="",X.editWitName="",X.newWit={},g.currentWitId=e,d.getWit(e).then(function(e){L.setAcronyms(L.getAcronyms(e.content)),e.content=L.restoreToUglyAcronymsForEdit(e.content),X.wit=e,X.editContentLoaded=!0,X.editWitName=e.name,X.beforeEditWitObj=e,X.setActiveState("witUpdation"),X.witUpdationType=t,g.updateNumber=e.updateNumber,"ORDINARY"===t?void 0:"DOC_WIT"===t&&(X.fileDetails=e.attachmentDetails[0],X.editWitName=e.name,X.witCreationType="DOC_WIT",X.docWitProcessed=!0)},function(e){void 0})},X.openSelectedWit=function(t){X.witId=t.id,X.attachmentDetails=[],X.beforeEditWitObj=t,d.getWit(t.id).then(function(n){X.canEditWit=n.loggedInUserPermission.canEditWits,X.canShareWit=n.loggedInUserPermission.canFurtherShare,X.setActiveState("witPreview"),X.wit=n,g.wit=n,e.newWitMode=!1,n.witType===m.COMBO?null!==n.comboWit&&d.getComboWit(n).then(function(e){"null"!==e.content?(X.witContent=s.trustAsHtml(e.content),l.setUserData(t.id,s.trustAsHtml(e.content)),X.getAcronymList(s.trustAsHtml(e.content))):(X.witContent="",l.setUserData(t.id,"")),X.attachmentDetails=e.attachmentDetails}):(X.witContent=s.trustAsHtml(n.content),l.setUserData(t.id,s.trustAsHtml(n.content)),X.getAcronymList(s.trustAsHtml(n.content)),X.attachmentDetails=n.attachmentDetails,X.attachmentDetails&&F(X.attachmentDetails).then(function(e){var t=document.getElementById("witContent"),n=document.createElement("div");n.setAttribute("id","tempAppendedArea"),n.innerHTML=e,t.appendChild(n)}),X.fileController={getWopiUrl:x,generatePdfUrl:M,downloadFile:k,canReadOfficeFile:!0,context:X}),X.getComments(t.id),X.currentItem=!1,l.hasFeatureInPackage("PUBLIC_WIT_LINKS")||l.hasFeatureInPackage("PROTECTED_WIT_LINKS")?(X.showWitlinkFeatures=!0,X.getPublicWitlink(t.id)):X.showWitlinkFeatures=!1,Office.context.mailbox&&Office.context.mailbox.item.displayReplyForm?X.showReplyButtons=!0:X.showReplyButtons=!1},function(e){void 0}),n.logEvent(o.WIT_VIEW).then(function(e){})},X.selectMultipleWits=function(t,n){t.stopPropagation(),n.pin?N.removePinnedWit(n.id):N.pushWit(n),n.pin=!n.pin,N.getPinCount()>1?4===e.bulkActionMenu.length&&e.bulkActionMenu.push({labelName:"Deselect All",labelIcon:"icon-radio"}):e.bulkActionMenu.splice(4,1)},X.toggleWitMultiSelection=function(){e.showMeOnHover=!e.showMeOnHover},X.backToWitList=function(t){t&&e.$broadcast("REFRESH_CONTENT"),X.setActiveState("witlist")},X.getWitContent=function(t){void 0,void 0,e.collapsed||(e.collapsed=!0),X.witId=t.id,X.attachmentDetails=[],d.getWit(t.id).then(function(n){X.wit=n,g.wit=n,n.witType==m.COMBO?null!==n.comboWit?d.getComboWit(n).then(function(n){"null"!==n.content?(X.witContent=s.trustAsHtml(n.content),l.setUserData(t.id,s.trustAsHtml(n.content)),X.getAcronymList(s.trustAsHtml(n.content))):(X.witContent="",l.setUserData(t.id,"")),X.attachmentDetails=n.attachmentDetails,e.collapsed=!1}):e.collapsed=!1:(X.witContent=s.trustAsHtml(n.content),l.setUserData(t.id,s.trustAsHtml(n.content)),X.getAcronymList(s.trustAsHtml(n.content)),X.attachmentDetails=n.attachmentDetails,e.collapsed=!1,X.fileController={getWopiUrl:x,generatePdfUrl:M,downloadFile:k,canReadOfficeFile:!0,context:X}),X.getComments(t.id),X.currentItem=!1,l.hasFeatureInPackage("PUBLIC_WIT_LINKS")||l.hasFeatureInPackage("PROTECTED_WIT_LINKS")?(X.showWitlinkFeatures=!0,X.getPublicWitlink(t.id)):X.showWitlinkFeatures=!1,Office.context.mailbox&&Office.context.mailbox.item.displayReplyForm?X.showReplyButtons=!0:X.showReplyButtons=!1},function(e){void 0}),n.logEvent(o.WIT_VIEW).then(function(e){})},X.getWitlink=function(e){d.getPublicWitlink(e).then(function(e){var t={controller:"WitlinkPopupController",templateUrl:"app/components/witlink-popup/witlink-popup.html",resolve:{witlinkInfo:function(){return e}}};_.open(t)})},X.replaceAcronym=function(e,t){t=null!==t?t:"";var n=document.getElementById("witContent");d.replaceAcronym(e,t,n),l.setUserData(X.witId,s.trustAsHtml(document.getElementById("witContent").innerHTML))},X.getAcronymList=function(e){X.acronymList=d.getAcronymList(e)},e.updateRating=function(t,n){t.stopPropagation(),d.setRating(g.wit.id,n).then(function(t){e.$broadcast("setStarRating",t.ratingAggregate/t.ratingCount)},function(){e.$broadcast("setStarRating",g.wit.ratingAggregation/g.wit.ratingCount)})},X.insertContent=function(){var e=document.getElementById("witContent");if(e.innerHTML.length>0){try{if("chrome-extension"!==g.source)switch(g.source){case"msoffice":if(Office.context.document.setSelectedDataAsync)try{u.setOfficeDocContent(e.innerHTML,"Html").then(function(t){t.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):u.setOfficeDocContent(e.innerText,"Image").then(function(t){t.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):u.setOfficeDocContent(e.innerText,"Text").then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):D.set(e.error.message)})})})}catch(t){$("#notification-message-body").text("Document:"+t.message)}finally{}else D.set("This feature is not supported on this device.","error");break;case"outlook":if(Office.context.mailbox.item.body.setSelectedDataAsync)try{e="true"==docCookies.getItem("isNormalContent")?e.innerText:e.innerHTML,a.setOfficeOutlookContent(e,docCookies.getItem("isNormalContent")).then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):D.set("Failed! Please try again.","error")})}catch(t){$("#notification-message-body").text("Outlook:"+t.message)}finally{}else D.set("This feature is not supported on this device.","error");break;default:if(Office.context.mailbox.item.body.setSelectedDataAsync)try{e="true"==docCookies.getItem("isNormalContent")?e.innerText:e.innerHTML,a.setOfficeOutlookContent(e,docCookies.getItem("isNormalContent")).then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):D.set("Failed! Please try again.","error")})}catch(t){$("#notification-message-body").text(t.message)}finally{}else D.set("This feature is not supported on this device.","error")}else void 0}catch(t){$("#notification-message-body").text(t.message)}finally{}n.logEvent(o.WIT_INSERT,{witId:X.wit.id,target:g.source}).then(function(e){})}else void 0},X.insertAttachments=function(){g.isContentLoaded=!1;for(var e=[],t=0;t<X.publicFileIds.length;t++){var n={};n.type=Office.MailboxEnums.AttachmentType.File,n.name=X.wit.attachmentDetails[t].fileName,n.url=window.location.origin+"/wittyparrot/api/public/attachments/"+X.publicFileIds[t].publicAttachmentId,e.push(n)}u.addMultipleFileAttachments(e).then(function(){g.isContentLoaded=!0})},X.CopyHTMLToClipboard=function(e){G(document.getElementById("witContent"),null,e),document.execCommand("copy")?D.set("Copied wit content to clipboard"):D.set("Press Ctrl/Cmd + C to copy wit content"),n.logEvent(o.WIT_COPPIED,{witId:X.wit.id,target:g.source}).then(function(e){})},X.generatePrivateWitlink=function(){var e={controller:"WitlinkPopupController",templateUrl:"app/components/witlink-popup/witlink-popup.html",resolve:{witId:function(){return X.wit.id}}};X.showWitlnkPopup=!1,_.open(e)},X.insertSelectedContent=function(){if(0===u.getSelectedHtml().length&&0===window.getSelection().toString().length)D.set("Please select some content to insert","error");else if("chrome-extension"!=g.source)switch(g.source){case"outlook":if(Office.context.mailbox.item.body.setSelectedDataAsync)try{var e="<div>"+u.getSelectedHtml()+"</div>";"true"==docCookies.getItem("isNormalContent")&&(e=$(e).text()),a.setOfficeOutlookContent(e,docCookies.getItem("isNormalContent")).then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):D.set("Failed! Please try again.","error")})}catch(t){$("#notification-message-body").text("Outlook:"+t.message)}finally{}else D.set("This feature is not supported on this device.","error");break;case"msoffice":if(Office.context.document.setSelectedDataAsync)try{u.setOfficeDocContent(u.getSelectedHtml(),"Html").then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):u.setOfficeDocContent(window.getSelection().toString(),"Text").then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):D.set("Failed! Please try again.","error")})})}catch(t){$("#notification-message-body").text("Document:"+t.message)}finally{}else D.set("This feature is not supported on this device.","error");break;default:if(Office.context.mailbox.item.body.setSelectedDataAsync)try{var e="<div>"+u.getSelectedHtml()+"</div>";"true"==docCookies.getItem("isNormalContent")&&(e=$(e).text()),a.setOfficeOutlookContent(e,docCookies.getItem("isNormalContent")).then(function(e){e.status===Office.AsyncResultStatus.Succeeded?D.set("Data inserted successfully."):D.set("Failed! Please try again.","error")})}catch(t){$("#notification-message-body").text("Outlook:"+t.message)}finally{}else D.set("This feature is not supported on this device.","error")}},X.forwardMail=function(){docCookies.setItem("isNormalContent",!1,Q.toUTCString(),"/");var e=u.getSelectedHtml();0===e.length&&(e=document.getElementById("witContent").innerHTML),a.forwardForm(e),n.logEvent(o.WIT_FORWARD,{witId:X.wit.id}).then(function(e){})},X.replyMail=function(){docCookies.setItem("isNormalContent",!1,Q.toUTCString(),"/");var e=[];if(null!==X.wit.attachmentDetails)for(var t=0;t<X.wit.attachmentDetails.length;t++){var i={};i.expiryMinutes=10,i.witFileAssociationId=X.wit.attachmentDetails[t].fileAssociationId,e.push(i)}d.getPublicId(e).then(function(e){for(var t=[],i=0;i<e.length;i++){var r={};r.type=Office.MailboxEnums.AttachmentType.File,r.name=X.wit.attachmentDetails[i].fileName,r.url=window.location.origin+"/wittyparrot/api/public/attachments/"+e[i].publicAttachmentId,t.push(r)}var l=u.getSelectedHtml();0===l.length&&(l=document.getElementById("witContent").innerHTML),Office.context.mailbox.item.displayReplyForm?(a.replyForm(l,t),n.logEvent(o.WIT_REPLY,{witId:X.wit.id}).then(function(e){})):D.set("This feature is not supported on this device.","error")})},X.replyAllMail=function(){docCookies.setItem("isNormalContent",!1,Q.toUTCString(),"/");var e=[];if(null!==X.wit.attachmentDetails)for(var t=0;t<X.wit.attachmentDetails.length;t++){var i={};i.expiryMinutes=10,i.witFileAssociationId=X.wit.attachmentDetails[t].fileAssociationId,e.push(i)}d.getPublicId(e).then(function(e){for(var t=[],i=0;i<e.length;i++){var r={};r.type=Office.MailboxEnums.AttachmentType.File,r.name=X.wit.attachmentDetails[i].fileName,r.url=window.location.origin+"/wittyparrot/api/public/attachments/"+e[i].publicAttachmentId,t.push(r)}var l=u.getSelectedHtml();0===l.length&&(l=document.getElementById("witContent").innerHTML),Office.context.mailbox.item.displayReplyForm?(a.replyAllForm(l,t),n.logEvent(o.WIT_REPLY_ALL,{witId:X.wit.id}).then(function(e){})):D.set("This feature is not supported on this device.","error")})},X.newAppointment=function(){docCookies.setItem("isNormalContent",!0,Q.toUTCString(),"/");var e=window.getSelection().toString();0===e.length&&(e=document.getElementById("witContent").innerText),Office.context.mailbox.displayNewAppointmentForm?(a.createAppointment(e,X.wit.name),n.logEvent(o.MEETING_REQUEST,{witId:X.wit.id}).then(function(e){})):D.set("This feature is not supported on this device.","error")},X.newMail=function(){a.composeMail()},X.downloadAttachment=function(e,t){e.stopPropagation(),d.downloadFile(t),n.logEvent(o.DOWNLOAD_ATTACHMENT,{witId:X.wit.id,fileId:t.fileId}).then(function(e){})},X.setLocation=function(e){X.currentLocation=e,h.url("/"+e)},X.isSidenavActive=!1,X.toggleSidenav=function(){g.isSidenavActive=!g.isSidenavActive},X.menuItems=[{text:"Wit Info",callback:X.function1},{text:"Show in WebApp",callback:X.sayHello},{text:"Wit Link",callback:X.function2},{text:"Copy Text",disabled:!0},{text:"Copy Text & File Links",callback:X.function3}],"chrome-extension"==g.source?e.witMenuOptions=[["Copy",function(e,t){window.getSelection().toString().length>0?u.copySelectedArea()&&D.set("Copied successfully."):D.set("Please select some content to copy","error"),n.logEvent(o.PARIAL_COPY,{witId:X.wit.id,target:g.source}).then(function(e){})},"Copy"]]:e.witMenuOptions=[["Copy",function(e,t){window.getSelection().toString().length>0?u.copySelectedArea()&&D.set("Copied successfully."):D.set("Please select some content to copy","error"),n.logEvent(o.PARIAL_COPY,{witId:X.wit.id,target:g.source}).then(function(e){})},"Copy"],["Insert Content",function(e){X.insertSelectedContent(),n.logEvent(o.PARIAL_INSERT,{witId:X.wit.id,target:g.source}).then(function(e){})},"InsertContent"]],X.openEmailPopup=function(){g.isContentLoaded=!1;var e={accountType:1};d.getAccountList(e).then(function(e){if(e.length>0){if(X.attachmentDetails)var t=angular.copy(X.attachmentDetails);else var t=[];var n={controller:"SendEmailPopupController",templateUrl:"app/components/send-email-popup/send-email-popup.html",resolve:{witInfo:function(){return{content:document.getElementById("witContent").innerHTML,acronym:X.acronymList,attachments:t}}}};_.open(n),g.isContentLoaded=!0}else g.isContentLoaded=!0,D.set("You need to have campaign accounts registered for using this feature. Please register a email account by going to campaign account page.","error")})},X.openFeedbackPopup=function(){var e={controller:"FeedbackPopupController",templateUrl:"app/components/feedback-popup/feedback-popup.html",resolve:{}};_.open(e)},X.refreshContent=function(){void 0,A.getUserProfileData().then(function(t){void 0,l.setUserProfileData(t),e.$broadcast("REFRESH_CONTENT")})},X.openSocialMediaPopup=function(){g.isContentLoaded=!1;var e={accountType:0};d.getAccountList(e).then(function(e){if(e.length>0){g.isContentLoaded=!0;var t={controller:"SocialMediaPostPopupController",templateUrl:"app/components/post-social-popup/post-social-popup.html",resolve:{witInfo:function(){return{content:document.getElementById("witContent").innerHTML,acronym:X.acronymList,attachments:X.attachmentDetails}}}};_.open(t)}else g.isContentLoaded=!0,D.set("You need to have campaign accounts registered for using this feature. Please register a social account by going to campaign account page.","error")})},X.showFooterItem=function(e){X.currentItem&&X.currentItem===e?X.currentItem=!1:X.currentItem=e},X.copyPublicWitlink=function(){var e=document.createElement("textarea");e.textContent=X.witlinkInfo.hotLinkUrl;var t=document.getElementsByTagName("body")[0];t.appendChild(e),e.select(),document.execCommand("copy")&&(D.set("Copied public witlink to clipboard."),t.removeChild(e))},X.openPopup=function(e){g.isContentLoaded=!1;var t={controller:"CommonPopupController",templateUrl:"app/components/common-popup/common-popup.html",
resolve:{wit:function(){return X.wit},newWit:function(){return X.newWit},comments:function(){return X.comments},publicWitlink:function(){return X.witlinkInfo},popUpType:function(){return e},callback:function(){return X.commonPopUpCallback},widgetType:function(){var e={isOutlook:X.isOutlook,isChromeExtension:X.isChromeExtension};return e}}};_.open(t)},X.calloutMainObj={publicWitlink:function(){return X.witlinkInfo},witData:function(){return X.wit},localData:function(){return{wit:X.wit}},comments:function(){return X.comments},widgetType:function(){var e={isOutlook:X.isOutlook,isChromeExtension:X.isChromeExtension,showReplyButtons:X.showReplyButtons};return e},publicFileObj:function(){return X.publicFileIds}},e.$on("SYNC_COMMENTS",function(e,t){void 0,void 0,X.comments=t.comments}),X.commonPopUpCallback=function(e,t){"attachUpdate"===e?(void 0,void 0,B(t)):"attachAdd"===e?(void 0,H(t)):"noteUpdate"===e?(void 0,j("note",t)):"noteAdd"===e?Y("note",t):"docWitUpdate"===e?K(t):"removeAttachement"===e?z(t,"editMode"):"removeNewAttachement"===e&&z(t,"addMode")},X.openPermissionsPopup=function(){var e={templateUrl:"app/components/permissions-popup/permissions-popup.html",controller:"PermissionsPopupController",controllerAs:"permCtrl",resolve:{localData:function(){return{wit:X.wit}}}};_.open(e)},X.moreWitActions=function(e){void 0,e=e.trim(),"Feedback"===e?X.openFeedbackPopup():"WordVariable"===e?X.setActiveState("WordVariable"):"Profile"===e?X.setActiveState("profile"):"Logout"===e&&X.logOut()},X.getWordVariableRedirected=function(e){void 0,y.go(e)},X.bulkWitActions=function(t){void 0,t=t.trim();var n=N.getPinnedWitIds();if(n.length>0)if("Permission"===t){var o={templateUrl:"app/components/permissions-popup/permissions-popup.html",controller:"PermissionsPopupController",controllerAs:"permCtrl",resolve:{localData:function(){return{multiWitIds:!0,witIds:N.getPinnedWitIds()}}}};_.open(o)}else"Create Collection"===t?W.showCreateCollectionPopup(N.getPinnedWitIds(),i.WIT):"Trash"===t?(g.isContentLoaded=!1,d.deleteWits(n).then(function(t){void 0,e.$broadcast("REMOVE_WIT_FROM_WITLIST",{witIdsToBeRemoved:n}),N.clearPins(),g.isContentLoaded=!0},function(e){void 0,g.isContentLoaded=!0})):"Deselect All"===t?(N.removeAllPinnedWits(),e.bulkActionMenu.splice(4,1)):"Create Embed Wit"===t&&U(n).then(function(e){X.embed="<div contenteditable='false'>"+e+"</div><br/>";var t="ORDINARY";X.setActiveState("witCreation"),q(),g.newWitMode=!0,X.witCreationType=t,void 0});else D.set("Please select some wits","error")},X.mobileShare=function(){void 0;var e=document.createElement("div");e.innerHTML=X.wit.content;var t=e.textContent||e.innerText||"";void 0;var n=t.replace(/(\r\n|\n|\r)/gm,"");document.addEventListener("deviceready",function(){I.share(n,null,null).then(function(e){void 0,void 0},function(e){void 0,void 0})},!1),window.plugins.socialsharing.share(X.wit.content,X.wit.name)};var re={paramName:"file",maxFilesize:S.MAX_SIZE_IN_MB,filesizeBase:S.FILE_BASE_SIZE,autoProcessQueue:!1,parallelUploads:1,maxFiles:1,uploadMultiple:!1,addedfile:function(t){angular.extend(t,{extension:"FOLDER"===t.type?"folder":fileUtilityService.getFileExtension(t.name)});e.$digest()}};X.dropzone=null,X.dropzoneConfig=re,X.dropzoneEvents={error:V};var le={headers:{Authorization:t.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:S.MAX_SIZE_IN_MB,filesizeBase:S.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,maxFiles:1,uploadMultiple:!1,addedfile:function(t){void 0,void 0,X.dropzone.processQueue(),e.$digest()}};X.witAttachConfig=le,X.witAttachEvents={success:function(t,n){void 0,void 0,B(n),e.$apply()},error:V},X.hellofroala=function(){void 0},e.docWitDz=null;var se={headers:{Authorization:t.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:S.MAX_SIZE_IN_MB,filesizeBase:S.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(t){void 0,e.$apply()},success:function(t,n){void 0,void 0,void 0,g.isContentLoaded=!0,K(n),e.$apply()},processing:function(){void 0,g.isContentLoaded=!1,e.$apply()},complete:function(e){},error:function(e){D.set("Error uploading the document !","error"),g.isContentLoaded=!0},reset:function(){},maxfilesexceeded:function(){}};e.docWitConfiguration=se,e.docWitEvents={error:V},e.$on("openWit",function(e,t){var n=t;X.openSelectedWit(n)}),X.calloutMainObj.newWitdata=function(){return X.newWit},X.toggler=!1,X.acronymEditorToggle=function(){return X.toggler=!X.toggler,X.toggler}}e.$inject=["$scope","authFactory","eventLogger","EVENT_MAP","CONTENT_TYPE","outlookAppService","apiService","userDataFactory","$sce","$filter","officeAppService","witService","commentService","dialogFactory","WIT_TYPE","appData","$location","notify","searchService","viewerService","syncService","$cordovaSocialSharing","$window","$state","$timeout","$uibModal","editorUtil","FILE_TO_BE_ATTACH","fileUtil","ngNotify","selectedWitFactory","witEditorUtil","$q","collectionUtil"],angular.module("wpoffice").controller("MainController",e)}(),function(){"use strict";angular.module("wpoffice").controller("LoginController",["$scope","authFactory","$location","apiService","$timeout","registrationService","$http","ngNotify",function(e,t,n,o,i,a,r,l){i(function(){e.showPage=!0},2e3);var s=this;s.name="login",e.loginCheck=!1,e.currentScreen="login",o.init(),e.login=function(n,o){e.loginCheck=!0;var i={};i.userId=n.toLowerCase(),i.password=o,i.clientId="Parrot365_54c05f633352350ca4da47d02a789aa8",t.login(JSON.stringify(i)).then(function(t){e.isError=!1}).then(null,function(t){e.isError=!0,e.loginCheck=!1,t.errorInfo&&t.errorInfo[0]&&(e.errorMessage=t.errorInfo[0].message)})},e.resetPassword=function(){e.currentScreen="reset"},e.backToLogin=function(){e.currentScreen="login"},e.requestReset=function(t){t?r.post("api/wittyparrot/api/auth/requestresetpassword/"+t+"/PARROT365").then(function(n){e.currentScreen="resetMailSent",e.resetEmailAddress=t,void 0},function(e){void 0}):void 0},e.signUpScreen=function(){e.currentScreen="signup"},e.registerNewUser=function(t){var n={};n.appCode="PARROT365",n.useCase=t.useCase,n.invitationCode=t.inviteCode,n.userVO={firstName:t.fname,lastName:t.lname,email:t.email},t.phoneNumber&&(n.userVO.phoneNumber=t.phoneNumber.replace(/[\s-()]/g,"")),e.showPage=!1,a.signUp(n).then(function(t){e.currentScreen="registeredSuccessfully",e.showPage=!0},function(n){e.showPage=!0,"E01-004"===n.data.errorInfo[0].appErrorCode&&(e["new"]=t,i(function(){angular.element("#userEmail").select()}),l.set(n.data.errorInfo[0].message,"error"))})}}])}(),function(){"use strict";angular.module("wpoffice").factory("authFactory",["$q","$location","apiService","notify","ngNotify","userDataFactory","appData",function(e,t,n,o,i,a,r){var l="/auth/login",s="/php/login.php",c="/auth/logout",u="/php/logout.php",d="/auth/validateauth",p="/php/validateauth.php",f="/auth/user",m="/auth/validateresetpassword",g="/auth/resetpassword",h={};return h.getUserAccessToken=function(){var e=docCookies.getItem("p365WidgetKey")||r.tokenKey,t=r.isMobileDevice?localStorage.getItem("p365WidgetKey"):e;return t?t:""},h.login=function(o){var i,c=e.defer();return i="chrome-extension"===r.source?l:s+"?serviceName="+l,n.login(o,i).then(function(e){"chrome-extension"===r.source?r.tokenKey=docCookies.getItem("p365WidgetKey"):e.accessToken&&e.accessToken.tokenValue&&(r.tokenKey=e.accessToken.tokenType+e.accessToken.tokenValue),t.path("/main"),a.setUserProfileData(e.userProfile),r.isAuthenticated=!0,c.resolve(e)}).then(null,function(e){c.reject(e)}),c.promise},h.logout=function(){var t,o=e.defer();return t="chrome-extension"==r.source?c:u+"?serviceName="+c,n.logout(t).then(function(e){o.resolve()}).then(null,function(e){window.location.reload()}),o.promise},h.isAuthenticated=function(){var t,o=e.defer();return t="chrome-extension"===r.source?d:p+"?serviceName="+d,n.validateAuth(t).then(function(e){"chrome-extension"===r.source?r.tokenKey=docCookies.getItem("p365WidgetKey"):e.tokenVal&&(r.tokenKey=e.tokenVal),o.resolve(e)}).then(null,function(e){o.reject(e),r.isAuthenticated=!1}),o.promise},h.getUserProfile=function(){a.hasUserProfileData()||n.getList(f).then(function(e){a.setUserProfileData(e.userProfile),r.isAuthenticated=!0}).then(null,function(e){r.isAuthenticated=!1})},h.validateReset=function(e,t,o){var i={emailId:e,code:t,appCode:o};return n.callPost(m,i)},h.resetPassword=function(e,t,o,i){var a={emailId:e,code:t,newPassword:o,appCode:i};return n.callPut(g,a)},h}])}(),function(){"use strict";function e(e,t){t(function(){e.showPage=!0},2e3)}e.$inject=["$scope","$timeout"],angular.module("wpoffice").controller("IntroViewController",e)}(),function(){"use strict";function e(e,t,n,o,i,a){function r(e){var t=e.sliceCount,n=0,o=[],i=function(){e.getSliceAsync(n,function(a){"succeeded"==a.status?(o=o.concat(a.value.data),n++,n==t?(e.closeAsync(),l(o)):i()):(e.closeAsync(),app.showNotification(JSON.stringify(a)))})};i()}function l(e){var t=new Uint8Array(e),o=new Blob([t],{type:s.mimeType});"txt"==s.ext&&(o=new Blob(e,{type:s.mimeType})),n.uploadDocAsWit(o,s.fileName).then(function(e){s.witData={};var t={};t.fileId=e.fileId,t.attachmentType="LOCAL",s.witData.name=s.witTitle,s.witData.desc=s.witTitle,s.witData.source="WITTYPARROT",s.witData.parentId=s.folderId,s.witData.witType="DOC_WIT",s.witData.locale="en_US",s.witData.tagVos=[],s.witData.attachmentDetails=[t],n.saveWit(s.witData).then(function(e){s.saveDialog=!1,s.witData={},i.set("Doc wit created successfully.")})})}var s=this;s.witData={},s.startAWorkflow=!1,s.openSaveDialog=function(){s.isWitSaveAs=!1,s.saveType="Wit",s.saveDialog=!0,s.witTitle=t.wit.name},s.openSaveAsDialog=function(){s.isWitSaveAs=!0,s.saveType="As Wit",s.saveDialog=!0,s.witTitle=t.wit.name},s.openSaveDocWitDialog=function(){s.saveType="Doc Wit",s.docWitSave=!0,s.isWitSaveAs=!1,s.saveDialog=!0},s.closeDialog=function(){s.saveDialog=!1},s.closeWorkflowDialog=function(){s.workflowDialog=!1},s.fileType=[{name:"Compressed",mimeType:"application/octet-stream",extension:["docx","xlsx","pptx"]},{name:"Pdf",mimeType:"application/pdf",extension:["pdf"]},{name:"Text",mimeType:"text/plain",extension:["txt"]}],s.tags=[{id:0,name:"Tag 1"},{id:1,name:"Tag 2"},{id:2,name:"Tag 3"}],s.removeTag=function(e){s.tags.splice(e,1)},s.newChip="",s.addChip=function(){var e={};e.id=new Date,e.name=s.newChip,s.tags.push(e),s.newChip=""},s.selectFileType=function(e){switch(e){case"Compressed":s.fileAsyncType=Office.FileType.Compressed;break;case"Pdf":s.fileAsyncType=Office.FileType.Pdf;break;case"Text":s.fileAsyncType=Office.FileType.Text;break;default:s.fileAsyncType=Office.FileType.Compressed}s.ext="docx";for(var t=0;t<s.fileType.length;t++)s.fileType[t].name==e&&(s.mimeType=s.fileType[t].mimeType,s.ext=s.fileType[t].extension[0]);s.fileName=s.witTitle+"."+s.ext},s.saveWit=function(){t.wit?_document.getSelectedDataAsync(Office.CoercionType.Html,function(e){if(e.status===Office.AsyncResultStatus.Succeeded){if(""==e.value)return void i.set("No content selected.","error");t.wit.content=e.value,n.saveWit(t.wit).then(function(e){i.set("Wit Saved Successfully.")})}else i.set("Error:",e.error.message)}):i.set("No Wit Selected.","error")},s.saveAsWit=function(){if(t.wit){if(""==s.witTitle||null==s.witTitle||void 0==s.witTitle)return void i.set("Please enter wit title.","error");_document.getSelectedDataAsync(Office.CoercionType.Html,function(e){if(e.status===Office.AsyncResultStatus.Succeeded){if(""==e.value)return void i.set("No content selected.","error");s.witData.attachmentDetails=t.wit.attachmentDetails,s.witData.comboWit=t.wit.comboWit,s.witData.content=e.value,s.witData.desc=t.wit.desc,s.witData.expiryDate=t.wit.expiryDate,s.witData.firstAlert=t.wit.firstAlert,s.witData.locale=t.wit.locale,s.witData.name=s.witTitle,s.witData.note=t.wit.note,s.witData.parentId=t.wit.parentId=s.folderId?s.folderId:t.wit.parentId,s.witData.secondAlert=t.wit.secondAlert,s.witData.source=t.wit.source,s.witData.tagVos=t.wit.tagVos,s.witData.witType=t.wit.witType,s.witData.readOnlyWorkflow=t.wit.readOnlyWorkflow,s.witData.reuseWorkflow=t.wit.reuseWorkflow,n.saveAsWit(s.witData).then(function(e){s.witData={},i.set("Wit As Saved Successfully.")})}else i.set("Error:"+e.error.message,"error")})}else i.set("No Wit Selected.","error")},s.saveAsDocWit=function(){switch(s.startAWorkflow&&(s.workflowDialog=!0),s.saveType){case"Wit":s.saveWit();break;case"As Wit":s.saveAsWit();break;case"Doc Wit":if(""==s.witTitle||null==s.witTitle||void 0==s.witTitle)return void i.set("Please enter wit title.","error");_document.getFileAsync(s.fileAsyncType,function(e){e.status==Office.AsyncResultStatus.Succeeded?r(e.value):app.showNotification("Error:"+e.status)})}},s.saveAsmenuItems=[{text:"Save",disabled:!1,callback:s.openSaveDialog},{text:"Save As Wit",disabled:!1,callback:s.openSaveAsDialog},{text:"Save As Doc Wit",disabled:!1,callback:s.openSaveDocWitDialog}],s.createAcronym=function(){_document.getSelectedDataAsync(Office.CoercionType.Text,function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var t='<span data-id="var_acronym" style="color:rgb( 236 , 27 , 82 )" var="'+e.value+'">['+e.value+"]</span>";_document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Html},function(e){e.status===Office.AsyncResultStatus.Succeeded?app.showNotification("Acronym created successfully"):app.showNotification("Error:")})}else app.showNotification("Error:",e.error.message)})},s.getComments=function(){t.wit&&a.getWitComments(t.wit.id).then(function(e){s.witComment="",s.comments=e})},s.addComment=function(e){return e?(s.witComment?s.witComment.comment=e:s.witComment={witId:t.wit.id,comment:e},void a.saveWitComments(s.witComment).then(function(e){s.getComments(),s.newComment=""})):void i.set("please write some comment.","error")},s.updateComment=function(e){s.witComment=e,s.newComment=e.comment},s.removeComment=function(e){a.deleteComment([e]).then(function(e){s.getComments(),i.set("Comment deleted successfully.")})},e.onFolderSelection=function(e){var t=e.$modelValue;s.folderId=t.id,s.selectedFolderName=t.name},e.onTagSelection=function(e){var t=e.$modelValue;"TAG_GROUP"===t.tagType&&(s.tagGroupId=t.id)},s.getWitTags=function(){s.tagList=t.wit.tagVos},s.addTag=function(){s.addTagsDialog=!1}}e.$inject=["$scope","appData","witService","notify","ngNotify","commentService"],angular.module("wpoffice").controller("EditViewController",e)}(),function(){"use strict";function e(){var e=this;e.name="alerts"}angular.module("wpoffice").controller("AlertsViewController",e)}();var docCookies={getItem:function(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(e,t,n,o,i,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var r="";if(n)switch(n.constructor){case Number:r=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:r="; expires="+n;break;case Date:r="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+r+(i?"; domain="+i:"")+(o?"; path="+o:"")+(a?"; secure":""),!0},removeItem:function(e,t,n){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,n=0;n<t;n++)e[n]=decodeURIComponent(e[n]);return e}};!function(){"use strict";angular.module("wpoffice").controller("TagViewController",["$scope","$rootScope","$location","tagService","appData",function(e,t,n,o,i){function a(e){i.witSelected=!1,o.listWitFromTag(e,"").then(function(e){i.witResponseList=e,i.isSidenavActive=!1},function(){})}e.loadTagWits=function(e){var t=e.$modelValue.id;a(t)}}])}(),function(){"use strict";angular.module("wpoffice").service("searchService",["apiService",function(e){var t="/search";this.search=function(n){return n.max=n.max?n.max:20,e.callPost(t,n)}}])}(),function(){"use strict";angular.module("wpoffice").controller("AdvancedSearchController",["$scope","$stateParams","searchService","witService","WIT_TYPE","CONTENT_TYPE","$rootScope","appData","EVENT_MAP","eventLogger",function(e,t,n,o,i,a,r,l,s,c){function u(){var t=[];l.isContentLoaded=!1,n.search(e.searchOptions).then(function(e){e.witResult.forEach(function(e){t.push(e.witId)}),t.length>0?(l.witSelected=!1,o.listWitByIds(t).then(function(e){l.witResponseList=e,l.isSidenavActive=!1,l.isContentLoaded=!0})):l.isContentLoaded=!0}),c.logEvent(s.WIT_SEARCH,{term:e.searchOptions.searchTerm}).then(function(e){})}function d(){t.query&&(e.searchOptions.searchTerm='"'+t.query+'"',u()),e.$parent.selectedTab=3}e.searchOptions={searchTerm:"",workspaceIds:[],witType:[],searchFields:[],filterByTagId:[],filterByFolderId:[],dateBegin:null,dateEnd:null},e.searchControl={searchCriteria:e.searchOptions,afterSearchUpdate:u},e.witTypes=i,d()}])}(),function(){"use strict";angular.module("wpoffice").controller("FolderViewController",["$scope","folderViewService","$rootScope","$uibModal","appData","EVENT_MAP","eventLogger",function(e,t,n,o,i,a,r){function l(n,o){i.witSelected=!1,t.getWitsOfFolder(n).then(function(t){i.witResponseList=t,o?(e.$emit("GET_CHILD_WITS",t),i.isSidenavActive=!0):i.isSidenavActive=!1},function(e){void 0}),r.logEvent(a.FOLDER_SELECTION,{folderId:n}).then(function(e){})}function s(n,o,l){i.witSelected=!1;var s={};o?s.sort=o:s.sort="modifiedDate",l&&"desc"===l&&(s.asc="desc"),t.getWitsOfFolder(n,s).then(function(t){i.witResponseList=t,i.isSidenavActive=!1,e.$emit("GET_CHILD_WITS",t)},function(e){void 0}),r.logEvent(a.FOLDER_SELECTION,{folderId:n}).then(function(e){})}e.toggle=function(e){e.toggle()},e.collapseAll=function(){e.$broadcast("angular-ui-tree:collapse-all")},e.expandAll=function(){e.$broadcast("angular-ui-tree:expand-all")},e.loadFolderWits=function(e,t){var n=e.$modelValue.id;i.folderId=n,i.workspaceId=e.$modelValue.workspaceId,l(n)},e.$on("FILTER_WITS_OF_FOLDER",function(e,t){s(i.folderId,t.filter,t.sortBy)}),e.loadFolderWitsFilter=function(t,n){var o=t.$modelValue.id;i.folderId=o,i.workspaceId=t.$modelValue.workspaceId,e.$emit("RESET_WITS_FILTER"),s(o)},e.$on("REFRESH_CONTENT",function(t,n){void 0,e.$emit("RESET_WITS_FILTER"),i.folderId&&s(i.folderId)}),e.$on("GET_UNCATEGORISED_WITS",function(e,t,n){l(t,n)})}])}(),function(){"use strict";function e(e,t,n,o,i,a){e.close=function(){t.close()},e.collection={name:"",description:"",widgetType:"PARROT365",ownerType:"USER",params:{witIds:null,folderIds:null,tagIds:null,workspaceIds:null,labelIds:null,witTypes:null,searchTerm:null,sortParam:null,searchFields:null,dateBegin:null,dateEnd:null,searchType:null}},e.saveCollection=function(){var t=e.collection;switch(i.popupData.type){case a.WIT:t.params.witIds=i.popupData.ids;break;case a.FOLDER:t.params.folderIds=i.popupData.ids;break;case a.TAG:t.params.tagIds=i.popupData.ids;break;case a.SEARCH:t.params=i.popupData.ids;break;case a.CATEGORY:t.params.categoryIds=i.popupData.ids}n.saveUserCollection(e.collection).then(function(){o.set("Collection created successfully."),e.$broadcast("DESELECT_PINNED_WITS")}),e.close()},e.cancelCollection=function(){e.close()}}e.$inject=["$scope","$uibModalInstance","collectionService","ngNotify","locals","CONTENT_TYPE"],angular.module("wpoffice").controller("CollectionController",e)}(),function(){"use strict";function e(e,t){var n="/user/widgets";this.getUsersWidget=function(){return e.getList(n)},this.getWitsOfWidget=function(e,t,n){var o={id:e};t&&(o.searchTerm=t.searchTerm?t.searchTerm:null,o.witType=t.witType?t.witType:null,o.sort=t.sort?t.sort:null,o.asc=!!t.asc&&t.asc)},this.getWitsOfWidgetFromAnalytics=function(e){({entId:t.getUserEnterpriseId(),userId:t.getUserId(),flag:e})},this.saveUserCollection=function(t){t.params.searchTerm&&(t.params.widgetSearchTerms=[t.params.searchTerm],t.params.searchTerm="");var o={id:t.id,name:t.name,description:t.description,params:t.params,ownerType:t.ownerType};return t.id?e.callPut(n,o):e.callPost(n,o)},this.deleteUserCollection=function(t){return delete t.sequence,delete t.isDisplayable,e.callDelete(n,t)},this.reorderCollection=function(t){return e.callPut(n+"/reorder",t)}}e.$inject=["apiService","userDataFactory"],angular.module("wpoffice").service("collectionService",e)}(),function(){"use strict";angular.module("wpoffice").factory("collectionUtil",["CONTENT_TYPE","$uibModal","ngNotify",function(e,t,n){var o={};return o.showCreateCollectionPopup=function(o,i){var a=!Array.isArray(o)||o&&o.length>0,r={popupData:{ids:o,type:i}},l="";switch(i){case e.WIT:l="No pinned wit found.";break;case e.FOLDER:l="Please select folder to create a widget";break;case e.TAG:l="Please select tags to create a widget";break;case e.SEARCH:l="You have not searched anything to save";break;case e.CATEGORY:l="Please select category to create widget"}if(a){var s={controller:"CollectionController",templateUrl:"app/tabs/collection-view/collection-popup.html",resolve:{locals:function(){return r}}};t.open(s)}else n.set(l,"error")},o}])}(),function(){"use strict";angular.module("wpoffice").controller("CollectionViewController",["$scope","$location","witService","appData","notify","ngNotify","EVENT_MAP","eventLogger",function(e,t,n,o,i,a,r,l){function s(t){for(var n=-1,o=0;o<e.collectionList.length;o++)if(e.collectionList[o].id===t){n=o;break}return n}function c(t){e.selectedWidgetID=t}function u(t){return s(t)!=-1?e.collectionList[s(t)]:null}function d(t,i){var s=null,c={witType:e.selectedWitType?e.selectedWitType.type:null,sort:e.selectedSortBy?e.selectedSortBy.type:null},d=t.source&&t.widgetType;t=d?t:u(t.id),t&&(s="SYSTEM"===t.ownerType&&"WP_ANALYTICS"===t.source?n.getWitsOfWidgetFromAnalytics(t.widgetType):n.getWitsOfWidget(t.id,c),s.then(function(i){i&&i.length>0?(o.isContentLoaded=!1,o.witSelected=!1,n.listWitByIds(i).then(function(t){e.$emit("GET_CHILD_WITS",t),o.isSidenavActive=!1,o.isContentLoaded=!0})):(a.set("This collection is empty","error"),e.$parent.shouldShowWelcomeScreen=!0),l.logEvent(r.COLLECTION_SELECTION,{collectionId:t.id,CollectionName:t.name}).then(function(e){})}))}function p(){var i=t.search();e.$parent.selectedTab=0,o.isContentLoaded=!1,e.collectionList.length||n.getUsersWidget().then(function(t){t.length&&(t.forEach(function(t){e.collectionList.push(t)}),i.collectionId&&(c(i.collectionId),d({id:i.collectionId}))),o.isContentLoaded=!0})}e.selectedWidgetID="",e.collectionList=[],e.selectWidgetNode=function(e){c(e.id),d(e,e)},p(),e.$on("REFRESH_CONTENT",function(t,o){n.getUsersWidget().then(function(t){e.collectionList=t})})}])}(),function(){"use strict";angular.module("wpoffice").controller("CategoryViewController",["$scope","$rootScope","$location","tagService","appData",function(e,t,n,o,i){function a(e){i.witSelected=!1,o.listWitFromTag(e,"").then(function(e){i.witResponseList=e,i.isSidenavActive=!1},function(){})}e.loadTagWits=function(e){var t=e.$modelValue.id;a(t)}}])}(),function(){"use strict";function e(e){function t(t,n,o){void 0,void 0,void 0,void 0;var i={controller:"CkeditorPopupController",templateUrl:"app/directives/ckeditor-deps/ckeditor-popup/ckeditor-popup.html",resolve:{ckPopUp:{type:"acronym",icon:"icon-variable",name:"Add/Update Variable",varIndex:t,acronym:n,createAcro:o}}};e.open(i)}return{showAcronymDialog:t}}e.$inject=["$uibModal"],angular.module("wpoffice").factory("dialogFactory",e)}(),function(){"use strict";function e(){var e={};return e}angular.module("wpoffice").factory("appPopupFactory",e)}();var count=0;!function(){"use strict";void 0,angular.module("wpoffice").component("wordVariableComponent",{templateUrl:"app/components/witty-word-variable/witty-word-variable-template.html",controller:"WordVariableController"}).controller("WordVariableController",["$q",function(e){function t(){void 0,c.inputBoxObjects=[],c.varValues=[],c.onloadVariablesFound=[],n()}function n(){void 0,void 0,Word.run(["context",function(e){void 0;var t=e.document;return e.load(t,"contentControls/id, contentControls/text, contentControls/tag"),e.sync().then(function(){if(void 0,0!==t.contentControls.items.length){void 0;for(var e=0;e<t.contentControls.items.length;e++){var n=t.contentControls.items[e].text,a=t.contentControls.items[e].tag;a&&o(n,a).then(function(e){i(e)})}}else void 0})}]).then(function(){void 0})["catch"](function(e){void 0,e instanceof OfficeExtension.Error&&(void 0,void 0)})}function o(t,n){var o,i,a=e.defer(),r=[];if(n&&n.lastIndexOf("__")!=-1){o=n.substr(0,n.lastIndexOf("__"));var l=n.indexOf("_");l&&(i=n.substr(0,l))}var s={id:n,variableLabel:i,tagPrefix:o,value:t},c=_.findIndex(r,{variableLabel:i,tagPrefix:o});return c===-1&&r.push(s),a.resolve(r),a.promise}function i(e){angular.forEach(e,function(e){void 0;var t=e.value?e.value:"Enter Text";void 0,l(e.variableLabel,e.tagPrefix,t,e.id)})}function a(){void 0,Word.run(["context",function(e){void 0;var t=e.document.getSelection(),n=t.insertContentControl();return n.load("text"),e.sync().then(function(){var e=n.text,t="_tag",o=e+t;n.tag=o+"__"+count;var a=n.tag;void 0,r(a,e,o).then(function(e){void 0,i(e)})})}])["catch"](function(e){void 0,e instanceof OfficeExtension.Error&&void 0})}function r(t,n,o){var i=e.defer(),a=[],r={id:t,variableLabel:n,tagPrefix:o},l=_.findIndex(a,{variableLabel:n,tagPrefix:o});return l===-1&&a.push(r),i.resolve(a),i.promise}function l(e,t,n,o){void 0;var i={id:o,label:e,tag:t,value:n};if(c.inputBoxObjects.length>0){var a=_.findIndex(c.inputBoxObjects,{label:e});a===-1?c.inputBoxObjects.push(i):void 0}else c.inputBoxObjects.push(i)}function s(e,t,n){void 0;var o=""===t.target.value?e.label:t.target.value;void 0,Word.run(["context",function(t){var n=t.document.contentControls.getByTag(e.id);return t.load(n,"text"),t.sync().then(function(){if(0===n.items.length)void 0;else{void 0;for(var e=0;e<n.items.length;e++)n.items[e].insertHtml(o,"Replace")}})}])["catch"](function(e){void 0,e instanceof OfficeExtension.Error&&void 0})}void 0;var c=this;c.init=t,c.getSelectedWordFromDocument=a,c.populateWordVar=s}])}(),function(){"use strict";function e(){var e={restrict:"E",template:"<div ng-transclude></div>",controller:t,transclude:!0,replace:!0,scope:{oneAtATime:"@"}};return e}function t(e){var t=[];this.openItem=function(n){e.oneAtATime&&angular.forEach(t,function(e){e.isOpen=!1}),n.isOpen=!0},this.addItem=function(e){t.push(e)};var n=function(){angular.forEach(t,function(e){e.isOpen=!1})};e.$on("CLOSE_ALL_ACCORDIONS",function(e,t){n()})}angular.module("wpoffice").directive("wittyAccordion",e),t.$inject=["$scope"]}(),function(){"use strict";angular.module("wpoffice").directive("accordionItem",function(){return{scope:{itemTitle:"@",initiallyOpen:"=",onSelect:"&"},require:"^wittyAccordion",restrict:"EA",templateUrl:"app/components/witty-accordion/accordion-item_template.html",replace:!0,transclude:!0,controller:["$scope",function(e){e.isOpen=!1}],link:function(e,t,n,o){e.isOpen=!!e.initiallyOpen,o.addItem(e),e.toggleItem=function(){e.isOpen?e.isOpen=!1:(e.onSelect(),o.openItem(this)),e.$broadcast("ACCORDION_OPEN",e.isOpen)}}}})}(),function(){"use strict";function e(e,t,n,o,i,a,r,l){function s(){e.witlink={},e.witlink.commentsTo="WIT_LINK",e.customInfo={status:!1},e.searchObj={},e.searchObj.witId=i,a.getWitlinksOfWit(e.searchObj).then(function(t){t.records.length>1?(e.arrOfProtectedWitlinks=t.records,e.protectedLinks=!0):e.protectedLinks=!1,e.showDialogNow=!0})["catch"](function(){}),e.witlink.message=c()}function c(){var e=l.getUserFirstName()+" "+l.getUserLastName();return"<p>Hi,</p><p>"+e+" has shared a Witlink, <b>"+r+'</b> with you.</p><p class="custom-message-placeholder"><b>Username & password will be added here.</b></p><div>Best Regards,</div><div>'+e+"</div>"}function u(e){var t=document.createElement("div");if(t.innerHTML=e,null!==t.querySelector(".custom-message-placeholder")){var n=t.querySelector(".custom-message-placeholder");n.innerHTML="",n.innerText="${externalShareableInfo}"}return t.innerHTML}e.shareThisWitlink=function(t){e.showSharingForm=!0,e.witlinkId=t.id,e.witlink.title=t.name,e.witlink.commentsTo=t.commentBehaviour,e.selectedWitlink=e.radioWitlink=t.hotLinkUrl},e.shareProtectedWlinks=function(){var t={externalShareableEntityId:e.witlinkId,emailIds:e.witlink.receivers.replace(/ /g,"").split(","),canEdit:!!e.witlink.witLinkEditPermission};e.customInfo.status&&(t.message=u(e.witlink.message),t.subject=e.witlink.subject,t.from=e.witlink.fromName),e.witlinkProgress=!0,a.shareWitlink(t).then(function(t){o.set("Protected witlink has been shared successfully"),e.close(),e.witlinkProgress=!1})["catch"](function(){e.witlinkProgress=!1})},e.createANewWlinks=function(t){t?(e.backupDate=angular.copy(e.witlink),e.protectedLinks=!1):(e.protectedLinks=!0,e.witlink=angular.copy(e.backupDate))},e.close=function(){t.close()},e.submit=function(){void 0,e.witlinkProgress=!0;var t={name:e.witlink.title,witLinkType:"LIVE_LINK",canEdit:!!e.witlink.witLinkEditPermission,witId:i,visibility:"PROTECTED",commentBehaviour:e.witlink.commentsTo,emailIds:e.witlink.receivers.replace(/ /g,"").split(",")};if(e.witlink.notes&&(t.note=e.witlink.notes),e.witlink.expiryDate){var n=new Date(e.witlink.expiryDate);t.expiryDate=n.toISOString()}e.customInfo.status&&(t.message=u(e.witlink.message),t.subject=e.witlink.subject,t.from=e.witlink.fromName),void 0,a.sharePrivateWitlink(t).then(function(t){o.set("Protected witlink has been shared successfully"),e.close(),e.witlinkProgress=!1})["catch"](function(){e.witlinkProgress=!1})},s()}e.$inject=["$scope","$uibModalInstance","$uibModal","ngNotify","witId","witService","witTitle","userDataFactory"],angular.module("wpoffice").controller("WitlinkPopupController",e)}(),function(){"use strict";function e(e,t,n,o,i){function a(a){function r(){var n=t.getUserProfileData().defaultWorkspaceId;o.getFoldersOfWorksapce(n,0).then(function(t){"UNCATEGORISED"===t[0].folderType?(a.$broadcast("GET_UNCATEGORISED_WITS",t[0].id,"INIT"),e.folderId=t[0].id):(void 0,void 0)},function(e){void 0})}function l(e,t,n){
angular.forEach(t,function(t,o){angular.forEach(e,function(o,i){t===o.id&&("removeWits"===n?e.splice(i,1):"letRemainPinned"===n&&(e[i].pin=!0))})})}function s(e,t,n){t=t||{},o.getWitsOfFolder(e,t).then(function(e){c.witResponseList=e,c.witResponseListBackUp=e,l(c.witResponseList,i.getPinnedWitIds(),"letRemainPinned")},function(e){void 0})}var c=this;t.hasUserProfileData()?r():n.getUserProfileData().then(function(e){t.setUserProfileData(e),r()}),a.$on("GET_CHILD_WITS",function(e,t){c.witResponseList=t,a.accessCtrl.activeState="witlist"}),a.$on("FILTER_WITS_OF_FOLDER",function(t,n){var o={sort:n.filter?n.filter:"modifiedDate",asc:n.sortBy};s(e.folderId,o)}),a.$on("REFRESH_CONTENT",function(t,n){void 0,void 0,a.$emit("RESET_WITS_FILTER"),e.folderId&&s(e.folderId)}),a.$on("UPDATE_WIT_LISTING",function(e,t){void 0,c.witResponseList=t.witContainer,void 0}),a.$on("RESET_WIT_LISTING",function(){void 0,c.witResponseList=c.witResponseListBackUp}),a.$on("REMOVE_WIT_FROM_WITLIST",function(e,t){l(c.witResponseList,t.witIdsToBeRemoved,"removeWits")})}a.$inject=["$scope"];var r={templateUrl:"app/components/wit-listing/templates/default-wit-view_template.html",restrict:"E",controller:a,controllerAs:"wlCtrl",bindToController:!0};return r}e.$inject=["appData","userDataFactory","syncService","folderViewService","selectedWitFactory"],angular.module("wpoffice").directive("witListing",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/tree-component/tree_template.html",scope:{creationDate:"=",treeList:"=",nodeSelectionCallback:"=",treeRightClickOptions:"=",selectedId:"=",uniqueIdPropName:"@",updateNodeName:"=",onDropCallback:"="}};return e}angular.module("wpoffice").directive("treeStructure",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/tree-component/category-tree_template.html",scope:{creationDate:"=",treeList:"=",nodeSelectionCallback:"=",treeRightClickOptions:"=",selectedId:"=",uniqueIdPropName:"@",updateNodeName:"=",onDropCallback:"="}};return e}angular.module("wpoffice").directive("categoryTreeStructure",e)}(),function(){"use strict";angular.module("wpoffice").factory("tagTreeCache",function(){var e={};return e.treeData={internal:{isOpen:!0,children:[]}},e})}(),function(){"use strict";angular.module("wpoffice").directive("tagTree",["tagService","$location","appData",function(e,t,n){var o={restrict:"E",replace:!0,templateUrl:"app/components/tag-tree/tag-tree_template.html",scope:{callbackAfterTagSelection:"=",preSelectedId:"=",source:"@"},controller:["$scope","$rootScope","tagTreeCache","$element",function(t,n,o,i){function a(){l(),s()}function r(e){if("tags"===t.$parent.activeTab){if(t.processing)return;var n=e.currentTarget,o=n.scrollTop;n.clientHeight,n.children[0].clientHeight;o>n.scrollHeight/2&&l()}}function l(){var n={startIndex:m,pageSize:f};t.processing=!0,e.loadTagsOnDemand(n).then(function(e){t.processing=!1,d(t.tagList.internal,e.records),e.startIndex+e.pageSize>=e.totalRecordCount?c():m+=f})["catch"](function(){t.processing=!1})}function s(){i.parent().parent().parent().bind("scroll",r)}function c(){i.parent().parent().parent().unbind("scroll",r)}function u(){t.tagList.internal.children=[],e.searchTags().then(function(e){d(t.tagList.internal,e.records)})}function d(e,t){for(var n,o=[],i=0;i<t.length;i++)n=t[i],n.editable=!1,n.hasOwnProperty("hasChildren")?(n.tagType="TAG_GROUP",n.children=[]):n.tagType="TAG",o.push(n);e.children=e.children.concat(o)}function p(t){var n=t.$modelValue,o=e.getTagGroupChildren(n.id,!0).then(function(e){n.children=[],e.subGroups&&d(n,e.subGroups),e.tags&&d(n,e.tags),t.toggle(t)});return o}if(t.processing=!1,t.selectedTagID="",t.selectedTag=null,t.tagList=o.treeData,!t.source){var f=20,m=f;t.$on("REFRESH_CONTENT",function(e,t){u()}),a()}t.initialiseTagView=function(){0!==t.tagList.internal.children.length||t.source||(t.loadingTags=!0,e.searchTags().then(function(e){d(t.tagList.internal,e.records),t.loadingTags=!1,t.preSelectedId&&t.callbackAfterActive&&(t.selectedWidgetId=t.preSelectedId,t.callbackAfterActive(t.selectedWidgetId))},function(){t.loadingTags=!1}))},t.selectTagNode=function(e,n,o){t.selectedTagID=e.id,t.selectedTag=e;var i=e.children&&e.children.length;"TAG_GROUP"===e.tagType?o&&!i?p(n):n.toggle(n):"TAG"===e.tagType&&t.callbackAfterTagSelection&&t.callbackAfterTagSelection(n)},t.toggle=function(e){var n=t.tagList;1===e&&(n.internal.isOpen=!n.internal.isOpen)}}]};return o}])}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c,u,d,p,f,m){function g(e){e.size>p.MAX_SIZE_IN_BYTE&&l.set("File is bigger than the 200MB which is maximum file size allowed","error")}var h={accountType:1};e.title="Send Email",e.selectedWitContent="true",e.selectedWitAttachmentType="true",e.witAcronymList=o.acronym,e.fromUserName="",e.emailAttachmentList=o.attachments,e.sendEmailParam={type:h.accountType,track:!1,scheduled:!1,originSource:i.source,recipients:{to:"",cc:"",bcc:"",replyTo:"",csvUpload:!1},message:{subject:i.wit.name,witId:i.wit.id,acronymMap:[]},schedule:{type:"NONE",startDate:"",endDate:"",timeZone:"",timeZoneName:"",schedules:[],weekdays:[],dateFormat:"MM/dd/yyyy",repeat:1}},a.getAccountList(h).then(function(t){e.accountList=t}),e.toggleAttachementPanel=function(t){void 0,"true"===t?e.showAttachmentContent=!0:e.showAttachmentContent=!1,void 0},e.setEntity=function(){e.account&&(e.selectedAccount=JSON.parse(e.account),e.sendEmailParam.recipients.accountIds=[e.selectedAccount.id],e.sendEmailParam.recipients.from=e.selectedAccount.userName);var t=tinymce.activeEditor.getContent(),n=[];if(t=t.replace("<head>",'<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />'),null!==o.attachments)for(var i=0;i<o.attachments.length;i++)n.push(o.attachments[i].fileAssociationId);var a="true"!=e.selectedWitAttachmentType,r="true"==e.selectedWitContent?"FIXED":"DYNAMIC";e.sendEmailParam.message.contentType=r,e.sendEmailParam.message.bodyText=t,e.sendEmailParam.message.witAttachments=n,e.sendEmailParam.urlAsAttachment=a},e.sendEmail=function(){return void 0===e.account?void l.set("Please select from account.","error"):""===e.sendEmailParam.recipients.to||void 0===e.sendEmailParam.recipients.to?void l.set("Please provide recipient.","error"):(e.setEntity(),void a.createJob(e.sendEmailParam).then(function(e){l.set("Email successfully sent."),t.close()}))},e.removeMailAttachement=function(t){void 0;var n,o=e.emailAttachmentList;angular.forEach(o,function(i,a){n=o.filter(function(e){if(!Array.isArray(t))return e.fileAssociationId?e.fileAssociationId!==t:e.fileId!==t}),e.emailAttachmentList=n}),void 0},e.init=function(){tinymce.EditorManager.editors=[],tinymce.init({selector:"#witEditor",height:200,menubar:!1,extended_valid_elements:"span[id|style|class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name|var|acronym]",plugins:["charactercount","image media codesample imagetools advlist autolink autosave link image lists charmap print preview hr anchor pagebreak spellchecker","searchreplace visualblocks visualchars code fullscreen insertdatetime media nonbreaking","table contextmenu directionality emoticons template textcolor paste fullpage textcolor colorpicker textpattern"],image_caption:!0,media_live_embeds:!0,fontsize_formats:"8pt 9pt 10pt 11pt 12pt 26pt 36pt 72pt",theme:"modern",toolbar:"fontsizeselect | styleselect | bold italic | alignleft aligncenter alignright alignjustify | table image preview forecolor",imagetools_cors_hosts:["tinymce.com","codepen.io"],init_instance_callback:function(){tinyMCE.activeEditor.setContent(o.content)},setup:function(e){e.on("change",function(e){var t=this.plugins.charactercount.getCount();$("#mceu_49").html("Characters: "+t)})}})},e.replaceAcronym=function(e,t){t=null!==t?t:"";for(var n,o=$("#witContent").find("span[var='"+e+'\'][id="var_acronym"]'),i=0;i<o.length;i++)n=o[i],n.getAttribute("var")===e&&(t.length>0?(n.style.color="inherit",n.innerHTML=t):(n.style.color="rgb(236, 27, 82)",n.innerHTML="["+e+"]"));tinyMCE.activeEditor.setContent($("#witContent").html())},e.maximizeEmailWindow=function(){void 0,void 0;var e={appData:i,witInfo:o,latestContent:tinyMCE.activeEditor.getContent()};t.close(),c.externalEmailWindow?c.externalEmailWindow.closed?(i.isContentLoaded=!1,a.getAccountList(h).then(function(t){e.accountList=t,u.openEmailWindow(e),i.isContentLoaded=!0})):c.externalEmailWindow.focus():(i.isContentLoaded=!1,a.getAccountList(h).then(function(t){e.accountList=t,u.openEmailWindow(e),i.isContentLoaded=!0}))},e.maximizeEmailPopup=function(){},e.dropzone=null;var E={headers:{Authorization:f.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:p.MAX_SIZE_IN_MB,filesizeBase:p.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(e){void 0},success:function(t,n){void 0;var o={};o.fileId=n.fileId,o.fileName=n.fileName,o.extention="."+m.getFileExtension(n.fileName),o.attachmentType="LOCAL",o.seqNumber=0,e.emailAttachmentList.push(o),void 0,e.showAttachmentContent=!0},processing:function(){void 0,i.isContentLoaded=!1,e.$apply()},complete:function(t){void 0,i.isContentLoaded=!0,e.$apply()},error:function(e){},reset:function(){},maxfilesexceeded:function(){}};e.commonDropzoneConfig=E,e.commondropzoneEvents={error:g},e.close=function(){t.close()},e.openSchedule=function(){e.setEntity();var t={controller:"SchedulePopupController",templateUrl:"app/components/schedule-popup/schedule-popup.html",resolve:{scheduleParam:function(){return angular.copy(e.sendEmailParam)}}};n.open(t)},d(function(){e.init()})}e.$inject=["$scope","$uibModalInstance","$uibModal","witInfo","appData","witService","notify","ngNotify","$state","$window","popUpService","$timeout","FILE_TO_BE_ATTACH","authFactory","fileUtil"],angular.module("wpoffice").controller("SendEmailPopupController",e)}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s){e.scheduleParam=a,e.scheduleParam.scheduled=!0,e.startDate=new Date,e.endtDate=null,e.repeatCount=1,e.scheduleParam.schedule.weekdays.length=0;var c="Please select from account.",u="Please provide recipient.",d="Email successfully scheduled.";e.scheduleHeader="Schedule Email",0==e.scheduleParam.type&&(c="Please add post account.",u="Please add post account.",d="Post successfully scheduled.",e.scheduleHeader="Schedule Post"),e.init=function(){o.getTimeZone().then(function(t){e.timeZonelist=t})},e.close=function(){t.close()},e.times=["10:50 AM","03:50 PM"],e.increaseCount=function(){e.repeatCount+=1,e.scheduleParam.schedule.repeat=e.repeatCount},e.decreaseCount=function(){e.repeatCount-=1,e.scheduleParam.schedule.repeat=e.repeatCount},e.addWeekDays=function(t,n){angular.element(n.target).hasClass("selected-btn")?(e.scheduleParam.schedule.weekdays.splice(e.scheduleParam.schedule.weekdays.indexOf(t),1),angular.element(n.target).removeClass("selected-btn")):(angular.element(n.target).addClass("selected-btn"),e.scheduleParam.schedule.weekdays.push(t))},e.scheduleTask=function(){return e.scheduleParam.recipients.accountIds?""==e.scheduleParam.recipients.to||void 0==a.recipients.to?void l.set(u):e.scheduleParam.taskTitle?e.timeZone?(e.selectedTimeZone=JSON.parse(e.timeZone),e.scheduleParam.schedule.timeZone=e.selectedTimeZone.canonicalId,e.scheduleParam.schedule.timeZoneName=e.selectedTimeZone.name,e.scheduleParam.schedule.schedules=e.times,e.scheduleParam.schedule.startDate=s("date")(e.startDate,e.scheduleParam.schedule.dateFormat),e.scheduleParam.schedule.endDate=s("date")(e.endDate,e.scheduleParam.schedule.dateFormat),void o.createJob(e.scheduleParam).then(function(e){l.set(d),t.close()})):void l.set("Please select time zone.","error"):void l.set("Please provide task name.","error"):void l.set(c)},e.removeChip=function(t){e.times.splice(t,1)},e.openPostTime=function(){var t={controller:"PostTimePopupController",templateUrl:"app/components/post-time-popup/post-time-popup.html",size:"sm",resolve:{addTime:function(){return function(t){e.times.push(t)}}}};n.open(t)}}e.$inject=["$scope","$uibModalInstance","$uibModal","witService","appData","scheduleParam","notify","ngNotify","$filter"],angular.module("wpoffice").controller("SchedulePopupController",e)}(),function(){"use strict";angular.module("wpoffice").directive("customContextMenu",["$compile",function(e){var t={restrict:"A",replace:!0,link:function(t,n,o){function i(e){var n={xAxis:e.pageX+"px",yAxis:e.pageY+"px"},o=document.getElementsByTagName("body")[0].clientHeight,i=t.customMenuList.length*a,l=e.pageY+i;if(l>o){var s=l-o;s+=r}var c=e.pageY,u=i,d=document.getElementsByTagName("body")[0].clientHeight;if(c>u&&d-c<u)u+=r,n.yAxis=e.pageY-u+"px";else{var p=e.pageY-u/2-20;p<0&&(p=0),n.yAxis=p+"px"}return n}var a=30,r=40;t.customMenuList=[],t.loggedInUserPermission={},t.customMenuStyleObject={},n.on("contextmenu",function(a){t.folderName=n[0].innerText.trim();var r=t.$eval(o.custommenuCallbackBeforeRender);r&&r(t),t.customMenuList=t.$eval(o.customContextMenu),t.loggedInUserPermission=t.$eval(o.customContextPermission);var l=t.$eval(o.highlightClassName);if(l=l?"":o.highlightClassName,a.preventDefault(),t.customMenuList.length){t.targetElementStyleData={};var s=s?s:angular.element,c=s(document).find("body"),u=i(a);l&&(n.addClass(l),t.targetElementStyleData.targetElem=n,t.targetElementStyleData.highlightedClassName=l),t.customMenuStyleObject={left:u.xAxis,top:u.yAxis};var d='<custom-context-menu-list option-list="customMenuList" source-permission="loggedInUserPermission"popup-menu-style="customMenuStyleObject"target-element-style-data="targetElementStyleData" folder-name="folderName"></custom-context-menu-list>',p=e(d)(t);c.append(p),t.$digest()}})}};return t}]).directive("customContextMenuList",["$window",function(e){var t={restrict:"E",templateUrl:"app/components/right-click/custom-context-menu_template.html",scope:{optionList:"=",popupMenuStyle:"=",sourcePermission:"=",targetElementStyleData:"=",folderName:"="},replace:!0,link:function(t,n,o){function i(){t.$destroy(),n.remove(),_.isEmpty(t.targetElementStyleData)||t.targetElementStyleData.targetElem&&t.targetElementStyleData.highlightedClassName&&t.targetElementStyleData.targetElem.removeClass(t.targetElementStyleData.highlightedClassName)}var a=a?a:angular.element;t.customListContainerStyle={height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)+"px"},t.doCustomAction=function(e,n,o){e(t.$parent,n,o),i()},n.on("mousedown",function(e){a(e.target).hasClass("dropdown")&&i()}).on("contextmenu",function(e){e.preventDefault(),i()}),a(e).bind("resize",function(){i()}),t.$on("$destroy",function(){n.off("mousedown"),n.off("contextmenu"),a(e).unbind()})}};return t}])}(),function(){"use strict";function e(e,t,n,o,i,a){function r(){void 0,e.validRequest=!1,e.requestAgain=!1,e.initiatedResetRequest=!1,e.resetSuccess=!1,e.appCode="PARROT365",t.emailId&&t.code?o.validateReset(t.emailId,t.code,t.appCode).then(function(){e.validRequest=!0},function(){e.validRequest=!1,e.requestAgain=!0,e.currentScreen="resetRequestAgain",i.set("Link Expired","error"),e.email=t.emailId}):n.path("/login")}e.user={},e.currentScreen="ResetPasswordForm",e.requestReset=function(t){t?a.post("api/wittyparrot/api/auth/requestresetpassword/"+t+"/PARROT365").then(function(n){e.currentScreen="resetMailSent",e.resetEmailAddress=t,void 0},function(e){void 0}):void 0},e.resetPasswordSubmit=function(n){o.resetPassword(t.emailId,t.code,n,e.appCode).then(function(t){void 0,e.currentScreen="passwordResetSuccess",i.set("Your Password has been reset successfully.Now you can login to your account","success")},function(e){void 0})},r()}e.$inject=["$scope","$stateParams","$location","authFactory","ngNotify","$http"],angular.module("wpoffice").controller("ResetController",e)}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c){function u(){o.getCampaignAccounts().then(function(e){h.campaignAccounts=e}),o.getProviders().then(function(e){h.emailAccountType=e}),h.user=r.getUserProfileData(),h.email=r.getUserEmail(),h.fullName=r.getUserFullName(),h.preferences={fontSize:h.user.fontSize,fontFamily:h.user.fontFamily},s.getEnterpriseData(r.getUserEnterpriseId()).then(function(e){h.analyticsData=e})}function d(){return"Default"===h.emailProvider.name?void o.addDefault(h.user.email).then(function(){a.set("User added successfully."),u()}):("Other"!==h.emailProvider.name&&(h.newAccount.hostName=h.emailProvider.host,h.newAccount.portNo=h.emailProvider.port),h.newAccount.accountType=1,h.newAccount.ssl=h.emailProvider.ssl,c.isContentLoaded=!1,void o.addCampaignEmail(h.newAccount).then(function(){a.set("Account added successfully"),u()},function(e){e.data.errorInfo[0]&&a.set(e.data.errorInfo[0].message,"error")})["finally"](function(){c.isContentLoaded=!0}))}function p(e){c.isContentLoaded=!1,o.deleteCampaignAccount(e.id).then(function(){a.set("Account deleted successfully"),h.campaignAccounts.forEach(function(t,n){if(t.id===e.id)return void h.campaignAccounts.splice(n,1)})})["finally"](function(){c.isContentLoaded=!0})}function f(t){var n="",o="https://qawittyapi.wittyparrot.com/campaign/api/",i=e.getUserAccessToken();switch(i=i.split("bearer")[1],t){case 1:n=o+"gmail/oauth2callback?access_token="+i+"&cache="+(new Date).getTime();break;case 3:n=o+"facebook/oauth2callback?access_token="+i+"&cache="+(new Date).getTime();break;case 4:n=o+"twitter/oauth1callback?access_token="+i+"&cache="+(new Date).getTime();break;case 5:n=o+"linkedin/oauth2callback?access_token="+i+"&cache="+(new Date).getTime();break;case 8:n=o+"weibo/oauth2callback?access_token="+i+"&cache="+(new Date).getTime()}if(n)try{E=window.open(n,"social media login","location=yes,status=yes,scrollbars=yes,resizable=yes,width=650,height=450,left=50"),E.focus(),v=window.setInterval(m,500)}catch(r){a.set("Please enable popup in your browser setting","failure")}}function m(){E&&E.closed&&(window.clearInterval(v),u())}function g(){var e={fontSize:h.preferences.fontSize,fontFamily:h.preferences.fontFamily};c.isContentLoaded=!1,n.updatePreferences(e).then(function(e){a.set("Preferences saved!"),r.setUserProfileData(e)})["finally"](function(){c.isContentLoaded=!0})}var h=this;h.campaignAccounts=[],h.addSocialMediaAccount=f,h.setNewPassword=function(){if(""!==h.oldPassword&&""!==h.newPassword){if(h.newPassword!==h.newPasswordConfirm)return void a.set("New passwords don't match.","error");c.isContentLoaded=!1,t.changePassword(h.oldPassword,h.newPassword).then(function(){a.set("Password changed successfully.")},function(){a.set("Current password could not be authenticated.","error")})["finally"](function(){c.isContentLoaded=!0})}},h.clearPassword=function(){h.oldPassword="",h.newPassword="",h.newPasswordConfirm=""},h.removeAccount=p,h.addCampaignAccount=d,h.fontFamilyList=l.fontFamilyList,h.fontSizeList=l.fontSizeList,h.updatePreferences=g,h.emailProvider={},h.emailAccountType=[],u();var E,v}e.$inject=["authFactory","PasswordService","AccountService","CampaignService","notify","ngNotify","userDataFactory","editorUtil","AnalyticsService","appData"],angular.module("wpoffice").directive("wittyUserProfile",function(){return{restrict:"E",replace:!0,templateUrl:"app/components/profile/profile.html",scope:{},controller:"ProfileController",controllerAs:"profileCtrl"}}).controller("ProfileController",e)}(),function(){"use strict";function e(e,t,n,o){e.close=function(){t.close()},e.addTime=function(){var t=1==e.hour.toString().length?"0"+e.hour:e.hour,n=1==e.minute.toString().length?"0"+e.minute:e.minute,i=t+":"+n+" "+e.timeFormat;o(i),e.close()},e.timeFormat="AM",e.hour=1,e.minute=0}e.$inject=["$scope","$uibModalInstance","$uibModal","addTime"],angular.module("wpoffice").controller("PostTimePopupController",e)}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c){var u={accountType:0},d=0;t.title="Post",t.selectedWitContent="true",t.selectedWitAttachmentType="true",t.witAcronymList=i.acronym,t.addedAccountList=[],t.accountIds=[],t.accountType=[],t.postParam={type:u.accountType,track:!1,scheduled:!1,originSource:a.source,recipients:{to:"",cc:"",bcc:"",replyTo:"",csvUpload:!1},message:{subject:a.wit.name,witId:a.wit.id,acronymMap:[]},schedule:{type:"NONE",startDate:"",endDate:"",timeZone:"",timeZoneName:"",schedules:[],weekdays:[],dateFormat:"MM/dd/yyyy",repeat:1}},r.getAccountList(u).then(function(e){t.socialMediaAccountList=e}),t.selectMatch=function(e){if(void 0,"object"==typeof e&&t.accountIds.indexOf(e.id)==-1)switch(t.accountIds.push(e.id),t.addedAccountList.push(e),t.accountType.push(e.accountType),t.postSocialAccount="",t.socialMediaAccountList=t.socialMediaAccountList.filter(function(e){return t.addedAccountList.indexOf(e)==-1}),e.accountType){case 4:d>140&&$("#warning-"+e.accountType).css("display","inline-block");break;case 5:d>700&&$("#warning-"+e.accountType).css("display","inline-block");break;case 7:d>2200&&$("#warning-"+e.accountType).css("display","inline-block");break;case 8:d>140&&$("#warning-"+e.accountType).css("display","inline-block");break;case 9:d>160&&$("#warning-"+e.accountType).css("display","inline-block")}},t.removeChip=function(e){t.postSocialAccount="",t.socialMediaAccountList.push(t.addedAccountList[e]),t.accountIds.splice(e,1),t.addedAccountList.splice(e,1),$("#warning-"+t.accountType[e]).hide(),t.accountType.splice(e,1)},t.setEntity=function(){t.postParam.recipients.accountIds=t.accountIds,t.postParam.recipients.from="";for(var e=0;e<t.addedAccountList.length;e++)t.postParam.recipients.to=t.postParam.recipients.to+t.addedAccountList[e].userId+",";t.postParam.recipients.to=t.postParam.recipients.to.substring(0,t.postParam.recipients.to.length-1);var n=tinymce.activeEditor.getContent();n=n.replace("<head>",'<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />');var o="true"==t.selectedWitContent?"FIXED":"DYNAMIC";t.postParam.message.contentType=o,t.postParam.message.bodyText=n,t.postParam.message.witAttachments=[],t.postParam.urlAsAttachment=!1},t.postWIt=function(){return 0===t.accountIds.length?void s.set("Please add post account.","error"):(t.setEntity(),void r.createJob(t.postParam).then(function(e){s.set("Successfully post."),n.close()}))},t.init=function(){tinymce.EditorManager.editors=[],tinymce.init({selector:"#witEditor",height:200,menubar:!1,extended_valid_elements:"span[id|style|class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name|var|acronym]",plugins:["charactercount","image media codesample imagetools advlist autolink autosave link image lists charmap print preview hr anchor pagebreak spellchecker","searchreplace visualblocks visualchars code fullscreen insertdatetime media nonbreaking","table contextmenu directionality emoticons template textcolor paste fullpage textcolor colorpicker textpattern"],image_caption:!0,media_live_embeds:!0,fontsize_formats:"8pt 9pt 10pt 11pt 12pt 26pt 36pt 72pt",theme:"modern",toolbar:"fontsizeselect | styleselect | bold italic | alignleft aligncenter alignright alignjustify | table image preview forecolor",imagetools_cors_hosts:["tinymce.com","codepen.io"],init_instance_callback:function(){tinyMCE.activeEditor.setContent(i.content),d=this.plugins.charactercount.getCount();var e=140-d,n=700-d,o=160-d,a=2200-d,r='<span id="warning-4"><i class="icon-twitter"></i><strong id="twitCount">'+e+'</strong></span><span id="warning-5"><i class="icon-linkedin"></i><strong id="lnikedCount">'+n+'</strong></span><span id="warning-9"><i class="icon-sms"></i><strong id="smsCount">'+o+'</strong></span><span id="warning-7"><i class="icon-instagram"></i><strong id="instaCount">'+a+'</strong></span><span id="warning-8"><i class="icon-sina_weibo"></i><strong id="weiboCount">'+e+'</strong></span><i class="mce-ico mce-i-resize"></i>';$("div.mce-resizehandle").html(r),t.isTinyLoaded=!0},setup:function(e){e.on("keyup",function(e){var n=this.plugins.charactercount.getCount(),o=140-n,i=700-n,a=160-n,r=2200-n;t.accountType.indexOf(4)==-1||n<140?$("#warning-4").hide():$("#warning-4").css("display","inline-block"),t.accountType.indexOf(5)==-1||n<700?$("#warning-5").hide():$("#warning-5").css("display","inline-block"),t.accountType.indexOf(7)==-1||n<2200?$("#warning-7").hide():$("#warning-7").css("display","inline-block"),t.accountType.indexOf(8)==-1||n<140?$("#warning-8").hide():$("#warning-8").css("display","inline-block"),t.accountType.indexOf(9)==-1||n<160?$("#warning-9").hide():$("#warning-9").css("display","inline-block"),$("#twitCount").html(o),$("#lnikedCount").html(i),$("#smsCount").html(a),$("#instaCount").html(r),$("#weiboCount").html(o)})}})},t.replaceAcronym=function(e,t){t=null!==t?t:"";for(var n,o=$("#witContent").find("span[var='"+e+'\'][id="var_acronym"]'),i=0;i<o.length;i++)n=o[i],n.getAttribute("var")===e&&(t.length>0?(n.style.color="inherit",n.innerHTML=t):(n.style.color="rgb(236, 27, 82)",n.innerHTML="["+e+"]"));tinyMCE.activeEditor.setContent(document.getElementById("witContent").innerHTML)},t.close=function(){tinymce.remove("#witEditor"),n.close("tinymce")},t.openSchedule=function(){t.setEntity();var e={controller:"SchedulePopupController",templateUrl:"app/components/schedule-popup/schedule-popup.html",resolve:{scheduleParam:function(){return angular.copy(t.postParam)}}};o.open(e)},c(function(){t.init()})}e.$inject=["$http","$scope","$uibModalInstance","$uibModal","witInfo","appData","witService","notify","ngNotify","$timeout"],angular.module("wpoffice").controller("SocialMediaPostPopupController",e)}(),function(){"use strict";angular.module("wpoffice").factory("selectedWitFactory",function(){function e(e){return e.id&&!n(e.id)&&(c[e.id]=e,u++),u}function t(){return u}function n(e){return!(!e||!c[e])}function o(e){return n(e)?(delete c[e],u--,u):u}function i(){return c={},u=0}function a(){var e=Object.keys(c);return e}function r(e){return!!n(e)&&c[e]}function l(){var e=[];for(var t in c)e.push(c[t]);return e}function s(){return angular.forEach(c,function(e){e.pin=!1}),i()}var c={},u=0;return{pushWit:e,getPinCount:t,isWitPinned:n,removePinnedWit:o,clearPins:i,getPinnedWitIds:a,getWitDetails:r,getAllWits:l,removeAllPinnedWits:s}})}(),function(){"use strict";function e(e,t,n,o,i,a){function r(){u.hasMultiWitIds=o.multiWitIds||null,u.hasMultiWitIds||(n.getAssignedPrincipals(o.wit.id).then(function(e){null===e&&(e=[]),e.forEach(function(e,t){e.parsedPermission=l(e.permission)}),u.assignedPrincipals=e}),n.getInheritedPrincipals(o.wit.id).then(function(e){null===e&&(e=[]),e.forEach(function(e,t){e.parsedPermission=l(e.permission)}),u.inheritedPrincipals=e}))}function l(e){var n=[];return Object.keys(e).forEach(function(t){if("mask"!==t&&"owner"!==t&&"canFurtherShare"!==t&&e[t])switch(t){case"canRead":n.push("<span>Read</span>");break;case"canComment":n.push("<span>Comment</span>");break;case"canEditWits":n.push("<span>Edit</span>");break;case"canEditFolderAndWits":n.push("<span>Edit folder & wits</span>")}}),n=s(n.sort()),n=n.join(""),t.trustAsHtml(n)}function s(e){return e.sort(function(e,t){var n=0;return e.match(/R/)&&(n-=1),t.match(/R/)&&(n+=1),n}),e}function c(){return{canComment:!1,canRead:!1,canEditFolderAndWits:!1,canEditWits:!1}}var u=this;u.close=function(){e.close()},u.shareObject={contentEntityIds:o.multiWitIds?o.witIds:[o.wit.id],userEmailIds:"",groupIds:[],permission:{canComment:!0,canRead:!1,canEditFolderAndWits:!1,canEditWits:!1,canFurtherShare:!1},denied:!1,inherit:!0},u.sendShareRequest=function(){var e=angular.copy(u.shareObject);e.userEmailIds=e.userEmailIds.split(","),n.shareRequest(e).then(function(){a.set("Share request created successfully!"),u.close()})},u.sendUnshareRequest=function(e){var t={sharedGroupIds:[],contentEntityId:o.wit.id,sharedUserIds:[e]};n.unshareRequest(t).then(function(){a.set("Unshare request has been sent!"),u.close()})},u.assignedPrincipals=[],u.inheritedPrincipals=[],u.setPermissionObj=function(e){var t={};switch(e){case"READ":t=c(),t.canRead=!0;break;case"COMMENT":t=c(),t.canComment=!0;break;case"EDIT_WITS":t=c(),t.canEditWits=!0;break;case"DENY":t=null;break;default:t=c()}return t},r()}e.$inject=["$uibModalInstance","$sce","PermissionsService","localData","notify","ngNotify"],angular.module("wpoffice").controller("PermissionsPopupController",e)}(),function(){"use strict";function e(e,t,n,o){function i(){f.getAllNotifications(),d()}function a(){e.getAllNotifications(f.index,f.pageCount).then(function(e){Array.prototype.push.apply(f.messages,e.records),f.processing=!1})}function r(){e.getUnreadNotifications(f.index,f.pageCount).then(function(e){Array.prototype.push.apply(f.messages,e.records),f.processing=!1})}function l(){f.index=0,f.messages=[],"all"===f.notificationType?f.getAllNotifications():f.getUnreadNotifications()}function s(t,n){var o=[];o.push(t.id),e.markRead(o).then(function(){void 0,f.messages[n].isRead=!0})}function c(e){if(!f.processing&&"up"!==f.scrollDirection){var t=e.currentTarget,n=t.scrollTop;t.clientHeight,t.children[0].clientHeight;n>t.scrollHeight/2&&(f.index+=30,"all"===f.notificationType?(f.getAllNotifications(),f.processing=!0):(f.processing=!0,f.getUnreadNotifications()))}}function u(e){f.scrollDirection=e.wheelDelta<0?"down":"up"}function d(){t.children(1).bind("scroll",c),window.addEventListener("mousewheel",u)}function p(e,t){if("WIT_UPDATED"===e.notificationType)var n=e.data.witId;else if("SHARE"===e.notificationType)var n=e.data.contentId;else if("SHARE_ERROR"===e.notificationType)return!1;o.$broadcast("openWit",{id:n}),e.isRead||s(e,t)}var f=this;f.messages=[],f.getAllNotifications=a,f.getUnreadNotifications=r,f.setNotificationType=l,f.markRead=s,f.notificationType="all",f.index=0,f.pageCount=30,f.openWit=p,i()}e.$inject=["notificationService","$element","$scope","$rootScope"],angular.module("wpoffice").directive("wittyNotification",function(){return{restrict:"E",templateUrl:"app/components/notification/notification.html",controller:"NotificationController",controllerAs:"notificationCtrl",bindToController:!0}}).controller("NotificationController",e)}(),function(){"use strict";function e(e,t,n,o,i){function a(){e.popup={},"witCreator"===o?(e.popup.type="Create",e.popup.icon="icon-plus"):"account"===o&&(e.popup.type="Account",e.popup.icon="icon-personal"),e.showDialogNow=!0}e.close=function(){t.close()},e.createWit=function(t){e.close(),i(t)},e.showSettings=function(t){e.close(),i(t)},a()}e.$inject=["$scope","$uibModalInstance","$uibModal","mode","callback"],angular.module("wpoffice").controller("MainPopupController",e)}(),function(){"use strict";angular.module("wpoffice").directive("folderViewDirective",["$state","userDataFactory","$location","$rootScope","folderViewService","$uibModal",function(e,t,n,o,i,a){var r={restrict:"E",replace:!0,templateUrl:"app/components/folder-tree/templates/folder-view_template.html",scope:{callbackAfterFolderSelection:"=",preSelectedId:"="},controller:["$scope","$stateParams",function(e,n){function o(e){setTimeout(function(){var t=angular.element(document.getElementById("Node_"+e)),n=t.length?t.scope():null;if(n){for(n.$modelValue;n.$parentNodeScope;)n=n.$parentNodeScope,n.toggle(n)}},100)}e.selectedFolderID="",e.folderList=[],e.initialiseFolderView=function(){e.folderList.length||(e.folderList=t.getUserWorkspaceWithPermission(),e.preSelectedId&&(e.selectedFolderID=e.preSelectedId,e.callbackAfterActive&&e.callbackAfterActive(e.selectedFolderID),o(e.selectedFolderID)));
},e.$on("REFRESH_CONTENT",function(n,o){e.$broadcast("angular-ui-tree:collapse-all"),e.folderList=t.getUserWorkspaceWithPermission()})}],link:function(e,n,o){function r(t){var n=t.$nodeScope.$modelValue,o=!0;e.selectFolderNode(n,t,!0,o)}function l(t){void 0;var n={controller:"folderActionController",templateUrl:"app/components/folder-tree/templates/folder-create_template.html",resolve:{folderDetails:{folderData:t.$nodeScope.$modelValue,nodeScope:t,parentScope:e}}};a.open(n)}function s(e,t){var n={controller:"folderActionController",templateUrl:"app/components/folder-tree/templates/folder-rename_template.html",resolve:{folderDetails:{folderData:e.$nodeScope.$modelValue}}};a.open(n)}function c(t){var n={controller:"folderActionController",templateUrl:"app/components/folder-tree/templates/folder-delete_template.html",resolve:{folderDetails:{folderData:t.$nodeScope.$modelValue,folderContainer:t.$nodeScope.$parentNodesScope.$modelValue,parentScope:e}}};a.open(n)}function u(e,t){var n=e.$modelValue;i.getFolderInfo(n.id).then(function(t){void 0;var n={controller:"folderActionController",templateUrl:"app/components/folder-tree/templates/folder-info_template.html",resolve:{folderDetails:{folderInfo:t,folderData:e.$nodeScope.$modelValue}}};a.open(n)})}function d(e,t){var n={templateUrl:"app/components/permissions-popup/permissions-popup.html",controller:"PermissionsPopupController",controllerAs:"permCtrl",resolve:{localData:{wit:e.$nodeScope.$modelValue}}};a.open(n)}e.folderRightClickOption={},e.folderRightClickOption.workspace=[{optionName:"Create Folder",callbackFn:l,id:"ANY"},{optionName:"Refresh",callbackFn:r,id:"ANY"}],e.folderRightClickOption.folder=[{optionName:"Folder Info",callbackFn:u,id:"FOLDER_RC_PROP"},{optionName:"Refresh",callbackFn:r,id:"FOLDER_RC_REFRESH"},{optionName:"Rename",callbackFn:s,id:"FOLDER_RC_RENAME"},{optionName:"Move to Trash",callbackFn:c,id:"FOLDER_RC_DELETE"}];var p={optionName:"Create Folder",callbackFn:l,id:"FOLDER_RC_FOLDER"};t.hasFeatureInPackage("MULTIPLE_LEVEL_FOLDERS")?e.folderRightClickOption.folder.splice(3,0,p):void 0;var f={optionName:"Permissions",callbackFn:d,id:"FOLDER_RC_SHARE",feature:"CONTENT_SHARING"};t.hasFeatureInPackage("FOLDER_SHARING_READ_ONLY")?e.folderRightClickOption.folder.splice(4,0,f):void 0,e.selectFolderNode=function(t,n,o,a){var r=!t.folderType&&!t.workspaceId,l=t.children&&t.children.length,s=null;o?(s=r?!o||l&&!a?s:i.getFoldersOfWorksapce(t.id):!o||l&&!a?s:i.getFolderChildren(t.id),s?s.then(function(e){t.children=e.children?e.children:Array.isArray(e)?e:[],a||(t.children.length?n.toggle(n):"")},function(e){}):a||(l?n.toggle(n):"")):(void 0,e.selectedFolderID=t.id,e.callbackAfterFolderSelection&&e.callbackAfterFolderSelection(n,r))},e.setChevronToParentFolder=function(e){if(e){var t=angular.element(document.getElementById("Node_"+e)),n=t.length?t.scope():null;if(n){var o=n.$modelValue;o.hasChildren=!0}}},e.updateParentFolder=function(t){if(t){e.selectedFolderID=t;var n=angular.element(document.getElementById("Node_"+t)),o=n.length?n.scope():null;if(o){var i=o.$modelValue;0===i.children.length?i.hasChildren=!1:i.hasChildren=!0,e.selectFolderNode(i,o,!1,!1,!0)}}else delete e.selectedFolderID}}};return r}])}(),function(){"use strict";function e(e,t,n,o,i,a){void 0,e.actionType={RENAME:1,CREATE:2,DELETE:3},e.newFolderName="",e.folderName="",o.folderInfo&&(e.infoData=o.folderInfo),e.currentFolderName=o.folderData.name,e.close=function(){a.close()},e.setFolderName=function(){e.newFolderName=o.folderData.name},e.handleFolderAction=function(t){var a;switch(t){case e.actionType.RENAME:e.newFolderName===o.folderData.name?i.set("Folder name is already exist.","error"):(a={id:o.folderData.id,name:e.newFolderName,updateNumber:o.folderData.updateNumber},n.renameFolder(a).then(function(t){o.folderData.name=e.newFolderName,o.folderData.updateNumber+=1,i.set("Name updated successfully.","success")}),e.close());break;case e.actionType.CREATE:e.folderName?(a={enterpriseId:o.folderData.enterpriseId,workspaceId:o.folderData.workspaceId?o.folderData.workspaceId:o.folderData.id,name:e.folderName,parentId:o.folderData.workspaceId?o.folderData.id:""},n.createFolder(a).then(function(e){o.folderData.children?(o.folderData.children.push(e),o.nodeScope.collapsed&&o.nodeScope.toggle(o.nodeScope)):(o.folderData.children=[],o.folderData.hasChildren=!0,o.parentScope.selectFolderNode(o.folderData,o.nodeScope,!0)),o.parentScope.setChevronToParentFolder(o.folderData.id),i.set("Folder Created successfully","success")}),e.close()):i.set("Folder name is missing. Please enter a folder name and resubmit","error");break;case e.actionType.DELETE:n.deleteFolder([o.folderData.id]).then(function(e){var t=o.folderContainer.indexOf(o.folderData);o.folderContainer.splice(t,1),o.parentScope.selectedFolderID===o.folderData.id&&(o.parentScope.callbackAfterFolderSelection(),o.parentScope.folderWitRef=[]),o.parentScope.updateParentFolder(o.folderData.parentId),i.set("Folder moved to trash","success")}),e.close()}}}e.$inject=["$scope","$location","folderViewService","folderDetails","ngNotify","$uibModalInstance"],angular.module("wpoffice").controller("folderActionController",e)}(),function(){"use strict";angular.module("wpoffice").directive("fileUpload",function(){function e(e,t,n,o,i,a,r,l,s,c,u,d,p){function f(){e.files.forEach(function(e){"DONE"!==e.uploadMessage&&e.selectedService&&(e.uploadMessage="Uploading....",e.selectedService.uploadFile(e).then(function(e){E(e.file,e.fileId)},function(e){v(e.file)}))})}function m(){T===u?y.sharepoint365=e.contentList:T===l&&(y.box=e.contentList)}function g(){return T===u?y.sharepoint365:T===l?y.box:null}function h(t){var n=angular.extend(t,{extension:"FOLDER"===t.type?"folder":r.getFileExtension(t.name)});return e.uploadOnlyLocal?n.uploadMessage="Ready to import":(e.uploadDisabled=!1,n.uploadMessage="Ready to upload"),e.files.push(n)}function E(n,o){var i=e.files.indexOf(n);n=e.files[i],n.uploadMessage="DONE",n.id=o,i===e.files.length-1&&t.$emit("ENABLE_UPLOAD_DONE",!1)}function v(t){var n=e.files.indexOf(t),o=e.files[n];o&&(o.progress=0,o.uploadMessage="",o.errorMessage=o.errorMessage||"Something went wrong. Please try again.")}function w(){null!==g()?e.contentList=g():T.getFirstLevelContent(!0).then(function(t){e.contentList=I(t)},function(e){if(400===e.status&&("E14-009"===e.data.errorInfo[0].appErrorCode||"E14-013"===e.data.errorInfo[0].appErrorCode||"E14-016"===e.data.errorInfo[0].appErrorCode)){var t=T.getAuthUrl(d.getUserId());if(null===C||C.closed)try{var n="location=yes,status=yes,scrollbars=yes,resizable=yes,width=650,height=450,left=50";C=window.open(t,"login",n),C.focus(),window.onIntegrationSuccess=A}catch(o){s.showSimpleToast("Please enable popup in browser setting.","info")}else C.focus()}})}function A(){C.close(),C=null,w(),s.showSimpleToast("Account added successfully"),delete window.onIntegrationSuccess}function I(e){for(var t,n=[],o=0;o<e.folderCount;o++)t=e.folders[o],t.type="FOLDER",t.children=[],n.push(t);return n=n.concat(e.files)}e.uploadDisabled=!0,e.contentList=[];var T=null,y={sharepoint365:null,box:null};e.dropzone=null,e.dropzoneConfig={headers:{Authorization:a.getUserAccessToken()},paramName:"file",url:"/api/wittyparrot/api/attachments",maxFilesize:p.MAX_SIZE_IN_MB,filesizeBase:p.FILE_BASE_SIZE,autoProcessQueue:!1,uploadMultiple:!1,parallelUploads:1,addedfile:function(t){var n={name:t.name,source:"LOCAL",progress:0};h(n),e.$apply()},uploadprogress:function(t,n,o){var i=_.findIndex(e.files,{name:t.name}),a=e.files[i];n>=90&&(n=90),a.progress=n,a.uploadMessage=r.getFileSize(o)+" of "+r.getFileSize(t.size),e.$apply()}},e.eventHandlers={success:function(t,n){0===this.getUploadingFiles().length&&this.getQueuedFiles().length>0&&this.processQueue();var o=_.findIndex(e.files,{name:t.name}),i=e.files[o];i.progress=100,E(i,n.fileId),e.$apply()},error:function(t){var n=_.findIndex(e.files,{name:t.name}),o=e.files[n];return t.size>p.MAX_SIZE_IN_BYTE?(e.removeFile(o),void s.showSimpleToast("File is bigger than the 200MB which is maximum file size allowed.")):void v(o)},queuecomplete:function(){e.uploadOnlyLocal!==!0&&(f(),e.$apply())}},e.selectTab=function(t){m(),e.contentList=[],"local"!==t?("box"===t?T=l:"sharepoint365"===t&&(T=u),w()):T=null},e.docWitTab=function(e){c.showDocWitSelectionDialog({targetEvent:e,locals:{updateWitAttachments:function(e){t.$emit("DOC_WITS_ATTACHMENT_DATA",{newWitAttachmentData:e})}}})},e.uploadFiles=function(t){t.stopPropagation(),e.uploadDisabled=!0,e.dropzone&&e.dropzone.getQueuedFiles().length?e.dropzone.processQueue():e.uploadOnlyLocal!==!0&&f()},e.removeFile=function(n){var o=e.files.indexOf(n);"LOCAL"===n.source&&(n=e.dropzone.files[o],e.dropzone.removeFile(n)),e.files.splice(o,1),0===e.files.length&&(e.uploadDisabled=!0,t.$emit("ENABLE_UPLOAD_DONE",!0))},e.getFileExtension=function(e){if("string"==typeof e)return r.getFileExtension(e)},e.loadFolderContent=function(e,t){0===e.children.length?T.getFolderContent(e.id,!0).then(function(n){e.children=I(n),t.toggle()}):t.toggle()},e.onFileDrop=function(t){if(_.findIndex(e.files,{tpid:t.id})===-1){var n;T===l?n="BOX":T===u&&(n="SHAREPOINT365");var o={name:t.name,source:n,progress:0,selectedService:T,tpid:t.id};"FOLDER"===t.type&&(o.type="FOLDER"),h(o)}else s.showSimpleToast("This file has been already added.")};var C=null}return e.$inject=["$scope","$rootScope","$mdDialog","$q","$parse","authFactory","fileUtil","boxService","appPopupFactory","dialogFactory","sharepoint365Service","userDataFactory","FILE_TO_BE_ATTACH"],{scope:{files:"=",uploadOnlyLocal:"@",uploadDoneCallback:"=",needDocUpload:"="},restrict:"E",templateUrl:"app/components/common-popup/common-popup.html",replace:!0,controller:e}})}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c){function u(t){t.size>l.MAX_SIZE_IN_BYTE&&(e.removeFile(t),r.set("File is bigger than the 200MB which is maximum file size allowed","error"))}e.title="Send Feedback",e.feedbackType="bug",e.helpModel={topic:e.feedbackType,message:"",file:null};var d={headers:{Authorization:c.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:l.MAX_SIZE_IN_MB,filesizeBase:l.FILE_BASE_SIZE,autoProcessQueue:!1,parallelUploads:1,maxFiles:1,uploadMultiple:!1,addedfile:function(t){var n=angular.extend(t,{extension:"FOLDER"===t.type?"folder":s.getFileExtension(t.name)});e.helpModel.file=n,e.$digest()}};e.dropzone=null,e.dropzoneConfig=d,e.dropzoneEvents={error:u},e.close=function(){t.close()},e.removeUploadedFile=function(){e.helpModel.file=null},e.submit=function(){if(e.textValue){e.helpModel.file&&(e.uploadingNotification=!0);var n=new FormData,a={topic:e.feedbackType,message:e.textValue,appId:o.appId,file:e.helpModel.file,otherInfo:{apiVersion:o.Version}};for(var l in a){var s=a[l];s&&("object"==typeof s&&"file"!==l&&(s=JSON.stringify(s)),n.append(l,s))}i.submitFeedback(n).then(function(n){e.uploadingNotification=!1,r.set("Feedback submitted successfully"),t.close()},function(){e.uploadingNotification=!1})}else r.set("Please add a comment","error")}}e.$inject=["$scope","$uibModalInstance","$uibModal","appData","feedbackService","notify","ngNotify","FILE_TO_BE_ATTACH","fileUtilityService","authFactory"],angular.module("wpoffice").controller("FeedbackPopupController",e)}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c){var u,d=this,p={},f={},m=null;window.top.winInfo?(d.showPopUpWindow=!0,p=window.top.winInfo.appData,f=window.top.winInfo.witInfo,u=window.top.winInfo.appData.tokenKey,m=window.top.winInfo.latestContent,d.accountList=window.top.winInfo.accountList):window.opener.winInfo?(d.showPopUpWindow=!0,p=window.opener.winInfo.appData,f=window.opener.winInfo.witInfo,u=window.opener.winInfo.appData.tokenKey,m=window.opener.winInfo.latestContent,d.accountList=window.opener.winInfo.accountList):window.winInfo?(d.showPopUpWindow=!0,p=window.winInfo.appData,f=window.winInfo.witInfo,u=window.winInfo.appData.tokenKey,m=window.winInfo.latestContent,d.accountList=window.winInfo.accountList):d.showPopUpWindow=!1;var g={accountType:1};d.title="Send Email",d.selectedWitContent="true",d.selectedWitAttachmentType="true",d.witAcronymList=f.acronym,d.fromUserName="",d.emailAttachmentList=f.attachments,d.sendEmailParam={type:g.accountType,track:!1,scheduled:!1,originSource:p.source,recipients:{to:"",cc:"",bcc:"",replyTo:"",csvUpload:!1},message:{subject:p.wit.name,witId:p.wit.id,acronymMap:[]},schedule:{type:"NONE",startDate:"",endDate:"",timeZone:"",timeZoneName:"",schedules:[],weekdays:[],dateFormat:"MM/dd/yyyy",repeat:1}},d.setEntity=function(){d.account&&(void 0,d.selectedAccount=JSON.parse(d.account),void 0,d.sendEmailParam.recipients.accountIds=[d.selectedAccount.id],d.sendEmailParam.recipients.from=d.selectedAccount.userName);var e=tinymce.activeEditor.getContent(),t=[];if(e=e.replace("<head>",'<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />'),null!==f.attachments)for(var n=0;n<f.attachments.length;n++)t.push(f.attachments[n].fileAssociationId);var o="true"!=d.selectedWitAttachmentType,i="true"==d.selectedWitContent?"FIXED":"DYNAMIC";d.sendEmailParam.message.contentType=i,d.sendEmailParam.message.bodyText=e,d.sendEmailParam.message.witAttachments=t,d.sendEmailParam.urlAsAttachment=o},d.sendEmail=function(){return void 0===d.account?void a.set("Please select from account.","error"):""===d.sendEmailParam.recipients.to||void 0===d.sendEmailParam.recipients.to?void a.set("Please provide recipient.","error"):(d.setEntity(),void o.externalCall(d.sendEmailParam,u).then(function(e){a.set("Email successfully sent.")}))},d.init=function(){tinymce.EditorManager.editors=[],tinymce.init({selector:"#witEditorExternal",height:200,menubar:!1,extended_valid_elements:"span[id|style|class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name|var|acronym]",plugins:["charactercount","image media codesample imagetools advlist autolink autosave link image lists charmap print preview hr anchor pagebreak spellchecker","searchreplace visualblocks visualchars code fullscreen insertdatetime media nonbreaking","table contextmenu directionality emoticons template textcolor paste fullpage textcolor colorpicker textpattern"],image_caption:!0,media_live_embeds:!0,fontsize_formats:"8pt 9pt 10pt 11pt 12pt 26pt 36pt 72pt",theme:"modern",toolbar:"fontsizeselect | styleselect | bold italic | alignleft aligncenter alignright alignjustify | table image preview forecolor",imagetools_cors_hosts:["tinymce.com","codepen.io"],init_instance_callback:function(){tinyMCE.activeEditor.setContent(m)},setup:function(e){e.on("change",function(e){var t=this.plugins.charactercount.getCount();$("#mceu_49").html("Characters: "+t)})}})},d.replaceAcronym=function(e,t){t=null!==t?t:"";for(var n,o=$("#witContent").find("span[var='"+e+'\'][id="var_acronym"]'),i=0;i<o.length;i++)n=o[i],n.getAttribute("var")===e&&(t.length>0?(n.style.color="inherit",n.innerHTML=t):(n.style.color="rgb(236, 27, 82)",n.innerHTML="["+e+"]"));tinyMCE.activeEditor.setContent(document.getElementById("witContent").innerHTML)},d.close=function(){$uibModalInstance.close()},d.openSchedule=function(){d.setEntity();var e={controller:"SchedulePopupController",templateUrl:"app/components/schedule-popup/schedule-popup.html",resolve:{scheduleParam:function(){return angular.copy(d.sendEmailParam)}}};t.open(e)},c(function(){d.init()})}e.$inject=["$scope","$uibModal","$stateParams","witService","notify","ngNotify","$window","$state","popUpService","$timeout"],angular.module("wpoffice").controller("ExternalSendEmailPopupController",e)}(),function(){"use strict";function e(e){function t(){return N}function n(e){N=e}function o(){N&&N.resetDirty&&N.resetDirty()}function i(e){var t=e.content?e.content.replace(/<html>|<\/html>|<body>|<\/body>|<head>|<\/head>|<meta>|<\/meta>/gi,""):"";void 0;var n=document.createElement("textarea");n.innerHTML=t,e.content=n.value,N&&N.setData(e.content)}function a(){return N?N.getData():null}function r(){N.focus();var e=N.createRange();if(e){e.moveToPosition(e.root,CKEDITOR.POSITION_BEFORE_END);var t=N.getSelection();t&&t.selectRanges([e])}}function l(){return L}function s(e){L.length=0,Array.isArray(e)&&(e.sort(function(e,t){return e.sequenceNumber<t.sequenceNumber?-1:1}),e.forEach(function(e){e.defaultValue&&(e.value=e.defaultValue),L.push(e)}))}function c(){return P}function u(e){var t=_.findIndex(P,{embeddedWitId:e});return t!==-1&&P[t]}function d(e){e.embeddedWitId||(e.embeddedWitId=e.id);var t=e.embeddedWitId;u(t)||P.push(e)}function p(e){P=e?e:[]}function f(e){var t=_.findIndex(P,{embeddedWitId:e});return t!==-1&&(P.splice(t,1),!0)}function m(e){_.findIndex(L,{name:e.name})===-1&&L.push(e)}function g(e){var t=document.createElement("div"),n=[];t.innerHTML=e;for(var o,i,a=t.querySelectorAll("#var_acronym"),r=[],l=0;l<a.length;l++)o=a[l],i=o.getAttribute("var"),r.indexOf(i)===-1&&n.push({name:i,value:o.getAttribute("data-default"),"default":o.getAttribute("data-default")}),r.push(i);return n}function h(e,t,n){var o,i=n.querySelectorAll("#var_acronym");try{for(var a=0;a<i.length;a++)o=i[a],o.getAttribute("var")===e&&(t.length>0?(o.style.color="inherit",o.innerText=t):(o.style.color="rgb(236, 27, 82)",o.innerText="["+e+"]"))}catch(r){return void void 0}}function E(e,t){for(var n,o=document.getElementById("cke_editable"),i=o.querySelectorAll("#var_acronym"),a=0;a<i.length;a++)n=i[a],n.getAttribute("var")===e.name&&(n.innerHTML="["+t.name+"]",n.setAttribute("var",t.name),n.setAttribute("data-default",t.defaultValue))}function v(e){var t=document.createElement("div");"string"==typeof e&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">")),t.innerHTML=e;for(var n,o,i=[],a=t.querySelectorAll("#var_acronym"),r=[],l=0;l<a.length;l++)n=a[l],o=n.getAttribute("var"),r.indexOf(o)===-1&&i.push({name:o,value:n.innerHTML!=="["+o+"]"?n.innerHTML:null,"default":"["+o+"]"}),r.push(o);return i}function w(e){var t=document.createElement("div");t.innerHTML=e;for(var n=t.querySelectorAll("#var_acronym"),o=0;o<n.length;o++){var i="["+n[o].getAttribute("var")+"]";i!==n[o].innerHTML&&(n[o].removeAttribute("var"),n[o].removeAttribute("id"))}return t.innerHTML}function A(e,t){function n(){return t.filter(function(e){return e.name===l&&s!==e.defaultValue})}var o=document.createElement("div"),i=Array.isArray(t);o.innerHTML=e;var a=o.querySelectorAll("#var_acronym");if(i)for(var r=0;r<a.length;r++){var l=a[r].getAttribute("var"),s=a[r].getAttribute("data-default"),c=n();c&&c.length&&(a[r].setAttribute("data-default",c[0].defaultValue),a[r].setAttribute("style","color : rgb(236, 27, 82);"))}return o.innerHTML}function I(e,t,n){var o=document.createElement("div");o.innerHTML=e;var i="",a=Array.isArray(t);return a&&t.map(function(e){var t=e.value?e.value:e.defaultValue;t&&h(e.name,t,o)}),i=n?o.innerHTML:w(o.innerHTML)}function T(e){var t=e?e:N.getData();return P.length&&(t=C(t)),t=y(t)}function y(e){var t=document.createElement("div");t.innerHTML=e;for(var n,o,i=t.querySelectorAll(".witty-web-view"),a=0;a<i.length;a++)n=i[0],n.innerHTML="",o=n.getAttribute("witty-web-url"),n.innerHTML='<a href="'+o+'">'+o+"</a>";return t.innerHTML}function C(e){var t=document.createElement("div");t.innerHTML=e;for(var n,o=t.querySelectorAll("[embed-wit-id]"),i=o.length-1;i>=0;i--)if(n=o[i],n.style.border&&(n.style.border="0px"),n.innerHTML="","DOC_WIT"===n.getAttribute("wit-type")){var a=n.getAttribute("embed-wit-id"),r=u(a);if(r){var l=r.attachmentDetails?r.attachmentDetails[0]:r.attchmentDetailVO[0],s=r.name?r.name:r.embeddedWitName;n.innerHTML='<a href="'+l.witlinkUrl+'">'+s+"</a>"}}return t.innerHTML}function b(e){var t=angular.copy(e),n=N.editable().getText().replace(/<!--[\s\S]*?-->/g,"").replace(/\u00a0/g," ").replace(/\u0026/g," ");return t.content=T(),t.desc=n.slice(0,250),O(t),S(t),t}function S(e){e.embeddedWit=[];var t=document.createElement("div");t.innerHTML=e.content;var n,o=c();o.forEach(function(o){n=t.querySelectorAll('[embed-wit-id="'+o.embeddedWitId+'"]'),n.length&&e.embeddedWit.push({embeddedWitId:o.embeddedWitId})})}function O(e){e.acronyms=[];for(var t,n,o,i=l(),a=g(e.content),r=0;r<a.length;r++)t=a[r],n=_.findIndex(i,{name:t.name}),n!==-1?(o=i[n],delete o.value):o={name:t.name,defaultValue:t["default"]},e.acronyms.push(o)}function D(e){var t=document.createElement("div");return t.innerHTML=e,L&&L.length&&L.forEach(function(e){h(e.name,"",t)}),t.innerHTML}var N,L=[],P=[],W={Arial:"Arial, Helvetica, sans-serif",Calibri:"Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif","CitrixSans-Regular":"CitrixSans-Regular","CitrixSans-Italic":"CitrixSans-Italic","Comic Sans MS":"Comic Sans MS, cursive","Courier New":"Courier New, Courier, monospace",Georgia:"Georgia, serif","Lucida Sans Unicode":"Lucida Sans Unicode, Lucida Grande, sans-serif",Tahoma:"Tahoma, Geneva, sans-serif","Times New Roman":"Times New Roman, Times, serif","Trebuchet MS":"Trebuchet MS, Helvetica, sans-serif",Verdana:"Verdana, Geneva, sans-serif"},R={8:"8pt",9:"9pt",10:"10pt",11:"11pt",12:"12pt",14:"14pt",16:"16pt",18:"18pt",20:"20pt",22:"22pt",24:"24pt",26:"26pt",28:"28pt",36:"36pt",48:"48pt",72:"72pt"};return{getEditorInstance:t,setEditorInstance:n,setData:i,getData:a,setFocus:r,getAcronyms:l,setAcronyms:s,addAcronym:m,updateAcronym:E,getAcronymList:g,replaceAcronym:h,fontFamilyList:W,fontSizeList:R,getAcronymListWithValue:v,getOriginalContent:w,getFilteredContent:T,getEmbedWits:c,setEmbedWits:p,addEmbedWit:d,embedWitExist:u,removeEmbedWit:f,getSubstitueContent:I,updateDefaultAcronym:A,updateContentBeforeSaving:b,resetEditor:o,getContentWithoutReplacedAcronyms:D}}e.$inject=["$sce"],angular.module("wpoffice").factory("editorUtil",e)}(),function(){"use strict";function e(e,t){var n={restrict:"E",templateUrl:"app/components/editor/editor.html",scope:{content:"=",config:"@"},link:function(e,n){function o(){var o=n[0].clientHeight,a={customConfig:e.config?"./"+e.config:"./wit-config.js",height:"auto",defaultFontStyle:{fontFamily:"Calibri",fontSize:12},on:{instanceReady:function(){if(e.content)this.setData(e.content);else{var t=document.querySelector(".cke_editable");if(t){var n=t.childNodes[0];n.style.fontFamily=this.config.defaultFontStyle.fontFamily,n.style.fontSize=this.config.defaultFontStyle.fontSize+"pt"}}o&&i.ui.space("contents").setStyle("minHeight",o+"px"),i.resetDirty()}}};CKEDITOR.replace(e.instance,a),i=CKEDITOR.instances[e.instance],"editable"===e.instance&&t.setEditorInstance(i),i.on("fileUploadRequest",function(e){var t=e.data.fileLoader.xhr,n=new FormData;n.append("file",e.data.fileLoader.file),t.send(n),e.stop()}),i.on("fileUploadResponse",function(e){e.stop();var t=e.data,n=t.fileLoader.xhr,o=JSON.parse(n.responseText);t.url=o.fileURL;var a=i.createRange();a.moveToElementEditablePosition(i.editable(),!0);var r=i.getSelection();r&&r.selectRanges([a])})}var i;e.instance="editable","readOnly-config.js"===e.config?e.instance="readOnly":"message-config.js"===e.config&&(e.instance="message"),setTimeout(function(){o()},100),e.$on("$destroy",function(){i.destroy(!0)})}};return n}e.$inject=["$parse","editorUtil"],angular.module("wpoffice").directive("wittyEditor",e)}(),function(){"use strict";function e(e,t,n,o,i,a,r,l,s,c,u,d,p,f,m,g,h,E,v,w,A,I,T,y,C,_,b,S,O,D){function N(){E.isContentLoaded=!0,e.popup={},e.witData=a,e.witData=i.getWitData(),e.witData.witType=d.DOC,e.comments=p,e.publicWitlink=f,e.widgetType=h,e.showOutlookFeatures=!!h.isOutlook,e.isMobileDevice=E.isMobileDevice,"A"===s?(e.popup.type="Files",void 0,e.popup.icon="icon-attachment"):"N"===s?(e.popup.type="Notes",e.popup.icon="icon-note"):"editN"===s?(void 0,e.popup.type="Edit Notes",e.popup.icon="icon-note",e.textareaValue=a.note):"addN"===s?(e.popup.type="Add Notes",e.popup.icon="icon-note",e.textareaValue=r.note):"C"===s?(e.popup.type="Comments",e.popup.icon="ms-Icon ms-Icon--chat"):"W"===s?(e.popup.type="Witlinks",e.popup.icon="ms-Icon icon-witlink"):"S"===s?(e.popup.type="Share",e.popup.icon="ms-Icon ms-Icon--share"):"editA"===s?(e.popup.type="Files",e.editAttachments=!0,e.popup.icon="icon-attachment"):"createOfficeWit"===s?(e.popup.type="Create Office Doc Wit",e.createWordDocWit=!0,e.popup.icon="icon-attachment"):"upLocalDoc"===s?(e.popup.type="Upload Local files",e.upLocalDocWit=!0,e.popup.icon="icon-attachment"):"upBoxDoc"===s?(k=A,e.popup.type="Select Box files",e.upBoxDocWit=!0,e.popup.icon="icon-attachment",P(),e.contentList=e.contentList):"upSharepointDoc"===s?(k=I,e.popup.type="Select Sharepoint files",e.upSharepointDocWit=!0,e.popup.icon="icon-attachment"):"setAcronyms"===s?(e.popup.type="Acronym",e.setAcronymValue=!0,e.popup.icon="icon-attachment"):"AcronymsDisplay"===s&&(e.popup.type="Acronyms",e.AcronymDisplay=!0,e.popup.icon="icon-attachment"),e.showDialogNow=!0,e.currentAcronym=O.getSelectedAcronym(),e.acroValue=O.getSelectedAcronymValue(e.currentAcronym),""===e.acroValue&&(e.acroValue=e.currentAcronym)}function L(){return k===I?x.sharepoint365:k===A?x.box:null}function P(){null!==L()?e.contentList=L():k.getFirstLevelContent(!0).then(function(t){e.contentList=R(t)},function(e){if(400===e.status&&("E14-009"===e.data.errorInfo[0].appErrorCode||"E14-013"===e.data.errorInfo[0].appErrorCode||"E14-016"===e.data.errorInfo[0].appErrorCode)){var t=k.getAuthUrl(_.getUserId());if(null===U||U.closed){void 0;try{var n="location=yes,status=yes,scrollbars=yes,resizable=yes,width=650,height=450,left=50";U=window.open(t,"login",n),U.focus(),window.onIntegrationSuccess=W}catch(o){g.set("Please enable Popup")}}else U.focus()}})}function W(){U.close(),U=null,P(),appPopupFactory.showSimpleToast("Account added successfully"),delete window.onIntegrationSuccess}function R(e){for(var t,n=[],o=0;o<e.folderCount;o++)t=e.folders[o],t.type="FOLDER",t.children=[],n.push(t);return n=n.concat(e.files)}function F(e){e.size>b.MAX_SIZE_IN_BYTE&&g.set("File is bigger than the 200MB which is maximum file size allowed","error")}e.close=function(){n.close()},e.toggle=!1,e.uploadDisabled=!0,e.contentList=[],e.level=0;var k=null,x={sharepoint365:null,box:null};e.docWitDz=null;var M={headers:{Authorization:C.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:b.MAX_SIZE_IN_MB,filesizeBase:b.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(t){void 0,e.$apply()},success:function(t,n){void 0,void 0,e.close(),y("docWitUpdate",n),e.$apply()},processing:function(){void 0,E.isContentLoaded=!1,e.$apply()},complete:function(t){void 0,E.isContentLoaded=!0,e.$apply()},error:function(e){g.set("Error uploading the document !","error"),E.isContentLoaded=!0},reset:function(){},maxfilesexceeded:function(){}};e.docWitConfiguration=M,e.docWitEvents={error:F},e.createMSWit=function(){function n(n){e.$parent.forcedRedirect=!0,window.open(t.href("docedit",{fileId:n,operation:"Editnew"}),"_blank")}void 0;var o=e.witData.attachmentDetails[0];if(o.fileName=e.witData.name+o.extension,delete o.extension,o.fileAssociationId){var a=o.fileAssociationId;delete o.fileAssociationId,D.createEmptyFile(o).then(function(t){var o=t.fileId;D.replaceAttachment(o,a).then(function(t){n(a),e.close(),y("docWitUpdate",t.attachmentDetails[0])})})}else i.saveWit(e.witData).then(function(t){var o=t.attachmentDetails[0].fileAssociationId;n(o),e.close(),E.newWitMode=!1,E.currentWitId=t.id,E.updateNumber=t.updateNumber,E.isContentLoaded=!0,y("docWitUpdate",t.attachmentDetails[0])},function(e){void 0})};var U=null;e.loadFolderContent=function(t,n,o){n.toggle=!o,e.display=function(e){if(e.$$childHead)return e.$$childHead.toggle},0===t.children.length&&k.getFolderContent(t.id,!0).then(function(e){t.children=R(e),n.children=t.children})},e.uploadThirdPartyFile=function(e,t){"Box"===t&&i.uploadBoxFile(e.id).then(function(e){void 0,void 0},function(e){void 0})},e.commonCallback=function(e,t){y(e,t)},e.notesSaveToWit=function(t,n){"addNote"===n?(y("noteAdd",t),e.newWit.note=t,void 0,g.set("Notes Added to the Wit")):"editNote"===n&&(y("noteUpdate",t),e.witData.note=t,g.set("Notes Added to the Wit")),e.close()},e.downloadAttachment=function(t,n){t.stopPropagation(),"chrome-extension"===E.source?i.downloadFile(n):i.downloadAttachment(n),c.logEvent(u.DOWNLOAD_ATTACHMENT,{witId:e.witData.id,fileId:n.fileId}).then(function(e){})},e.removeAttachement=function(e){y("removeAttachement",e)},e.removeNewAttachement=function(e){y("removeNewAttachement",e)},e.attachAttachment=function(e,t){var n=t.fileName,o=[],a={};a.expiryMinutes=10,a.witFileAssociationId=t.fileAssociationId,o.push(a),i.getPublicId(o).then(function(e){var t=window.location.origin+"/wittyparrot/api/public/attachments/"+e[0].publicAttachmentId;T.addFileAttachment(t,n)})},e.copyLinkToClipboard=function(){document.getElementById("witlinkContent").select(),document.execCommand("copy")?g.set("Copied public Witlink to clipboard."):g.set("Press Ctrl/Cmd + C to copy public Witlink")},e.generatePrivateWitlink=function(){var t={controller:"WitlinkPopupController",templateUrl:"app/components/witlink-popup/witlink-popup.html",resolve:{witId:function(){return e.witData.id},witTitle:function(){return e.witData.name}}};e.close(),o.open(t)},e.openEmailPopup=function(){var t={controller:"SendEmailPopupController",templateUrl:"app/components/send-email-popup/send-email-popup.html",resolve:{witInfo:function(){return{content:document.getElementById("witContent").innerHTML,acronym:e.witData.acronyms,attachments:e.witData.attachmentDetails}}}};e.close(),o.open(t)},e.downloadAttachment=function(t,n){t.stopPropagation(),"chrome-extension"===E.source?i.downloadFile(n):i.downloadAttachment(n),c.logEvent(u.DOWNLOAD_ATTACHMENT,{witId:e.witData.id,fileId:n.fileId}).then(function(e){})},e.attachAttachment=function(e,t){var n=t.fileName,o=[],a={};a.expiryMinutes=10,a.witFileAssociationId=t.fileAssociationId,o.push(a),i.getPublicId(o)(function(e){var t=window.location.origin+"/wittyparrot/api/public/attachments/"+e[0].publicAttachmentId;T.addFileAttachment(t,n)})},e.copyLinkToClipboard=function(){document.getElementById("witlinkContent").select(),document.execCommand("copy")?g.set("Copied public Witlink to clipboard."):g.set("Press Ctrl/Cmd + C to copy public Witlink")},e.generatePrivateWitlink=function(){void 0;var t={controller:"WitlinkPopupController",templateUrl:"app/components/witlink-popup/witlink-popup.html",resolve:{witId:function(){return e.witData.id},witTitle:function(){return e.witData.name}}};e.close(),o.open(t)},e.openSocialMediaPopup=function(){var t={controller:"SocialMediaPostPopupController",templateUrl:"app/components/post-social-popup/post-social-popup.html",resolve:{witInfo:function(){return{content:document.getElementById("witContent").innerHTML,acronym:e.witData.acronymList,attachments:e.witData.attachmentDetails}}}};e.close(),o.open(t)},e.dropzone=null;var $={headers:{Authorization:C.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:b.MAX_SIZE_IN_MB,filesizeBase:b.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(e){void 0},success:function(t,n){e.commonCallback("attachUpdate",n),e.$apply()},processing:function(){E.isContentLoaded=!1,e.$apply()},complete:function(t){E.isContentLoaded=!0,e.$apply()},error:function(e){},reset:function(){},maxfilesexceeded:function(){}};e.commonDropzoneConfig=$,e.commondropzoneEvents={error:F},e.newDropzone=null;var G={headers:{Authorization:C.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",
paramName:"file",maxFilesize:b.MAX_SIZE_IN_MB,filesizeBase:b.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(e){void 0},success:function(t,n){e.commonCallback("attachAdd",n),e.$apply()},processing:function(){E.isContentLoaded=!1,e.$apply()},complete:function(t){E.isContentLoaded=!0,e.$apply()},error:function(e){},reset:function(){},maxfilesexceeded:function(){}};e.newDropzoneConfig=G,e.newDropzoneEvents={error:F},e.addComment=function(t,n,o){if(t&&t.comment&&e.witData.id){if(t.witId||(t.witId=e.witData.id),n&&(t.id=n,e.comments[o].comment===t.comment))return;E.isContentLoaded=!1,S.saveWitComments(t).then(function(n){t.id?(void 0,t.comment=n.comment,e.comments.splice(o,1,n),g.set("Comment Updated")):(e.comments.unshift(n),g.set("Comment Added")),t.comment="",E.isContentLoaded=!0,e.newCommentThread=!e.newCommentThread})}},e.addReply=function(t,n){t&&t.comment&&e.witData.id&&(t.witId||(t.witId=e.witData.id),n&&(t.parentId=n),S.saveWitComments(t).then(function(n){e.showReplyBox=!1,e.showReplies=!0,void 0,t.comment=""}))},e.deleteComment=function(t,n){var o=[t];E.isContentLoaded=!1,S.deleteComment(o).then(function(t){e.comments.splice(n,1),E.isContentLoaded=!0,g.set("Comment Deleted")}).error(function(){E.isContentLoaded=!0,g.set("Something went wrong")})},e.syncComments=function(){E.isContentLoaded=!1,S.getWitComments(e.witData.id).then(function(t){E.isContentLoaded=!0,e.comments=t})},e.setAcroValue=function(t){var n=e.currentAcronym,o=t,i={};i[n]=o,O.setSelectedAcronymValue(i),e.close()},e.acronymData=O.populateAcronymData(),N()}e.$inject=["$scope","$state","$uibModalInstance","$uibModal","witService","wit","newWit","$window","popUpType","eventLogger","EVENT_MAP","WIT_TYPE","comments","publicWitlink","notify","ngNotify","widgetType","appData","fileUtil","dialogFactory","boxService","sharepoint365Service","officeAppService","callback","authFactory","userDataFactory","FILE_TO_BE_ATTACH","commentService","witEditorUtil","attachmentService"],angular.module("wpoffice").controller("CommonPopupController",e)}(),function(){"use strict";angular.module("wpoffice").directive("commonDropdown",["$document","appData","userDataFactory",function(e,t,n){function o(o,i,a){o.fullName=n.getUserFullName(),o.btnTextVal=a.initvalue,o.toggleFunction=function(e,t){e.stopPropagation(),angular.element("#"+t).hasClass("show")||(angular.element(".dropdown-content").removeClass("show"),angular.element(".dropbtn").removeClass("active-mode")),angular.element("#"+t).toggleClass("show"),angular.element("#"+t).prev(".dropbtn").toggleClass("active-mode")},o.closeList=function(e,n){t.isSidenavActive=!1,e.stopPropagation(),e.preventDefault(),angular.element(".dropdown-content").removeClass("show"),angular.element(".dropbtn").removeClass("active-mode"),o.btnTextVal=n},o.preventToClose=function(e,n){e.stopPropagation(e),t.isSidenavActive=!1},o.feelRadio=function(e){t.isSidenavActive=!1;var n=e.target.className;n.indexOf("radio-check1")!==-1&&(void 0,e.target.checked&&(angular.element(".radio-check1").prop("checked",!1),e.target.checked=!0)),n.indexOf("radio-check2")!==-1&&(void 0,e.target.checked&&(angular.element(".radio-check2").prop("checked",!1),e.target.checked=!0))},e.bind("click",function(){angular.element(".dropdown-content").removeClass("show"),angular.element(".dropbtn").removeClass("active-mode")})}return{restrict:"EA",transclude:!0,scope:{hasIcon:"=",optionGroup:"=",datalist:"=",initValue:"=",toggleId:"@",listAlignment:"@",cddClickEvent:"&",clickElement:"@",iconClass:"@",menuTitle:"@",functionalField:"@"},templateUrl:"app/components/common-dropdown/common-dropdown-template.html",link:o}}])}(),function(){"use strict";angular.module("wpoffice").directive("commonCallout",["$compile","$timeout","appData","$document","ngNotify","eventLogger","FILE_TO_BE_ATTACH","EVENT_MAP","$uibModal","PermissionsService","$sce","authFactory","witService","commentService","userDataFactory","officeAppService",function(e,t,n,o,i,a,r,l,s,c,u,d,p,f,m,g){return{restrict:"CA",scope:{calloutPosition:"=",calloutArrow:"=",calloutFor:"@",calloutCallbackObj:"=",calloutDynamicPosition:"=",calloutCallbackMethod:"&"},transclude:!0,templateUrl:"app/components/common-callout/common-callout-template.html",link:function(e,t,o){function h(t){switch(t){case 0:e.calloutPosition.left=0,e.calloutArrow.left=16;break;case 1:e.calloutPosition.left=-44,e.calloutArrow.left=60}}function E(){e.hasMultiWitIds=e.calloutCallbackObj.localData().multiWitIds||null,e.hasMultiWitIds||(c.getAssignedPrincipals(e.calloutCallbackObj.localData().wit.id).then(function(t){null===t&&(t=[]),t.forEach(function(e,t){e.parsedPermission=v(e.permission)}),e.assignedPrincipals=t}),c.getInheritedPrincipals(e.calloutCallbackObj.localData().wit.id).then(function(t){null===t&&(t=[]),t.forEach(function(e,t){e.parsedPermission=v(e.permission)}),e.inheritedPrincipals=t}))}function v(e){var t=[];return Object.keys(e).forEach(function(n){if("mask"!==n&&"owner"!==n&&"canFurtherShare"!==n&&e[n])switch(n){case"canRead":t.push("<span>Read</span>");break;case"canComment":t.push("<span>Comment</span>");break;case"canEditWits":t.push("<span>Edit</span>");break;case"canEditFolderAndWits":t.push("<span>Edit folder & wits</span>")}}),t=w(t.sort()),t=t.join(""),u.trustAsHtml(t)}function w(e){return e.sort(function(e,t){var n=0;return e.match(/R/)&&(n-=1),t.match(/R/)&&(n+=1),n}),e}function A(){return{canComment:!1,canRead:!1,canEditFolderAndWits:!1,canEditWits:!1}}function I(e){e.size>r.MAX_SIZE_IN_BYTE&&i.set("File is bigger than the 200MB which is maximum file size allowed","error")}switch(e.userPermissions=e.calloutCallbackObj.witData().loggedInUserPermission,e.loggedInUserEmail=m.getUserEmail(),t.on("click",function(o){void 0,t.parent().hasClass("panel-actions")?(e.showarrow=!1,t.css("position","static")):(t.css("position","relative"),e.showarrow=!0),e.calloutDynamicPosition&&h(t.parent().index()),o.stopPropagation(),t.find(".callout-container").css(e.calloutPosition),e.calloutArrow&&t.find(".callout-container .callout-arrow").css(e.calloutArrow),t.find(".callout-container").hasClass("active-transform")||(angular.element(".common-callout .callout-container").removeClass("active-transform"),n.commonCalloutActive=!1,t.removeClass("callout-index"),e.$apply()),t.find(".callout-container").toggleClass("active-transform"),n.commonCalloutActive=!n.commonCalloutActive,t.toggleClass("callout-index"),e.$apply()}),angular.element(".callout-container").on("click",function(e){e.stopPropagation()}),angular.element(".callout-close").on("click",function(){e.closeCallout("needApply")}),e.closeCallout=function(t){angular.element(".common-callout .callout-container").removeClass("active-transform"),angular.element(".common-callout").removeClass("callout-index"),n.commonCalloutActive=!1,t&&e.$apply()},e.headerTitleObj={},e.calloutFor){case"COMMENTSp":e.headerTitleObj={title:"Comments",titleIcon:"icon-comments"};break;case"NOTESp":e.headerTitleObj={title:"Note",titleIcon:"icon-note"};break;case"SHARE":e.headerTitleObj={title:"Share",titleIcon:"icon-shared"};break;case"WITLINKS":e.headerTitleObj={title:"Witlinks",titleIcon:"icon-witlink"};break;case"attachPreview":e.headerTitleObj={title:"Attachments",titleIcon:"icon-attachment"};break;case"addA":e.headerTitleObj={title:"Add Attachment",titleIcon:"icon-attachment"};break;case"addNOTE":e.headerTitleObj={title:"Add Note",titleIcon:"icon-note"};break;case"editA":e.headerTitleObj={title:"Edit Attachment",titleIcon:"icon-attachment"};break;case"NOTESu":e.headerTitleObj={title:"Edit Note",titleIcon:"icon-note"};break;default:e.headerTitleObj={title:"",titleIcon:""}}e.copyLinkToClipboard=function(){document.getElementById("witlinkContent").select(),document.execCommand("copy")?i.set("Copied public Witlink to clipboard."):i.set("Press Ctrl/Cmd + C to copy public Witlink")},e.generatePrivateWitlink=function(){var t={controller:"WitlinkPopupController",templateUrl:"app/components/witlink-popup/witlink-popup.html",resolve:{witId:function(){return e.calloutCallbackObj.witData().id},witTitle:function(){return e.calloutCallbackObj.witData().name}}};e.closeCallout(),s.open(t)},e.shareObject={contentEntityIds:e.calloutCallbackObj.localData().multiWitIds?e.calloutCallbackObj.localData().witIds:[e.calloutCallbackObj.localData().wit.id],userEmailIds:"",groupIds:[],permission:{canComment:!0,canRead:!1,canEditFolderAndWits:!1,canEditWits:!1,canFurtherShare:!1},denied:!1,inherit:!0},e.sendShareRequest=function(){var t=angular.copy(e.shareObject);t.userEmailIds=t.userEmailIds.split(","),c.shareRequest(t).then(function(){i.set("Share request created successfully!"),e.closeCallout()})},e.sendUnshareRequest=function(t){var n={sharedGroupIds:[],contentEntityId:e.calloutCallbackObj.localData().wit.id,sharedUserIds:[t]};c.unshareRequest(n).then(function(){i.set("Unshare request has been sent!"),e.closeCallout()})},e.assignedPrincipals=[],e.inheritedPrincipals=[],e.setPermissionObj=function(e){var t={};switch(e){case"READ":t=A(),t.canRead=!0;break;case"COMMENT":t=A(),t.canComment=!0;break;case"EDIT_WITS":t=A(),t.canEditWits=!0;break;case"DENY":t=null;break;default:t=A()}return t},E(),e.textareaValue=e.calloutCallbackObj.witData().note,e.notesSaveToWit=function(t,n){"addNote"===n?(e.calloutCallbackMethod({mode:"noteAdd",value:t}),i.set("Notes Added to the Wit")):"editNote"===n&&(e.calloutCallbackMethod({mode:"noteUpdate",value:t}),e.calloutCallbackObj.witData().note=t,i.set("Notes Updated to the Wit")),e.closeCallout()},e.dropzone=null;var T={headers:{Authorization:d.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:r.MAX_SIZE_IN_MB,filesizeBase:r.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(e){void 0,void 0},success:function(t,n){e.calloutCallbackMethod({mode:"attachUpdate",value:n}),e.$apply()},processing:function(){n.isContentLoaded=!1,e.$apply()},complete:function(t){n.isContentLoaded=!0,e.$apply()},error:function(e){},reset:function(){},maxfilesexceeded:function(){}};e.commonDropzoneConfig=T,e.commondropzoneEvents={error:I},e.newDropzone=null;var y={headers:{Authorization:d.getUserAccessToken()},url:"/api/wittyparrot/api/attachments",paramName:"file",maxFilesize:r.MAX_SIZE_IN_MB,filesizeBase:r.FILE_BASE_SIZE,autoProcessQueue:!0,parallelUploads:1,uploadMultiple:!1,addedfile:function(e){void 0},success:function(t,n){e.calloutCallbackMethod({mode:"attachAdd",value:n}),void 0,e.$apply()},processing:function(){n.isContentLoaded=!1,e.$apply()},complete:function(t){n.isContentLoaded=!0,e.$apply()},error:function(e){},reset:function(){},maxfilesexceeded:function(){}};e.newDropzoneConfig=y,e.newDropzoneEvents={error:I},e.downloadAttachment=function(t,o){t.stopPropagation(),"chrome-extension"===n.source?p.downloadFile(o):p.downloadAttachment(o),a.logEvent(l.DOWNLOAD_ATTACHMENT,{witId:e.calloutCallbackObj.witData().id,fileId:o.fileId}).then(function(e){})},e.attachAttachment=function(e,t){void 0;var n=t.fileName,o=[],i={};i.attachmentType="LIVE",i.witFileAssociationId=t.fileAssociationId,o.push(i),p.getPublicId(o).then(function(e){var t=window.location.origin+"/wittyparrot/api/public/attachments/"+e[0].publicAttachmentId;g.addFileAttachment(t,n)})},e.removeAttachement=function(t,n){e.calloutCallbackMethod({mode:n,value:t})},e.checkCommentPermission=function(t){var n=t.createdBy.email;return!(e.loggedInUserEmail!==n||!e.userPermissions.owner)||e.loggedInUserEmail===n},e.addComment=function(t,o,a){if(t&&t.comment&&e.calloutCallbackObj.witData().id){if(t.witId||(t.witId=e.calloutCallbackObj.witData().id),o&&(t.id=o,e.calloutCallbackObj.comments()[a].comment===t.comment))return;n.isContentLoaded=!1,f.saveWitComments(t).then(function(o){t.id?(void 0,t.comment=o.comment,e.calloutCallbackObj.comments().splice(a,1,o),i.set("Comment Updated")):(e.calloutCallbackObj.comments().unshift(o),i.set("Comment Added")),t.comment="",n.isContentLoaded=!0,e.newCommentThread=!e.newCommentThread})}},e.addReply=function(t,n){t&&t.comment&&e.calloutCallbackObj.witData().id&&(t.witId||(t.witId=e.calloutCallbackObj.witData().id),n&&(t.parentId=n),f.saveWitComments(t).then(function(n){e.showReplyBox=!1,e.showReplies=!0,void 0,t.comment=""}))},e.deleteComment=function(t,o){var a=[t];n.isContentLoaded=!1,f.deleteComment(a).then(function(t){e.calloutCallbackObj.comments().splice(o,1),n.isContentLoaded=!0,i.set("Comment Deleted")}).error(function(){n.isContentLoaded=!0,i.set("Something went wrong")})},e.syncComments=function(){f.getWitComments(e.calloutCallbackObj.witData().id).then(function(t){void 0,e.$emit("SYNC_COMMENTS",{comments:t})})}}}}])}(),function(){"use strict";angular.module("wpoffice").directive("calloutContent",["$document",function(e){function t(t,n,o){t.btnTextVal=o.initvalue,t.toggleFunction=function(e,t){e.stopPropagation(),angular.element("#"+t).hasClass("show")||(angular.element(".dropdown-content").removeClass("show"),angular.element(".dropbtn").removeClass("active-mode")),angular.element("#"+t).toggleClass("show"),angular.element("#"+t).prev(".dropbtn").toggleClass("active-mode")},t.closeList=function(e,n){e.stopPropagation(),e.preventDefault(),angular.element(".dropdown-content").removeClass("show"),angular.element(".dropbtn").removeClass("active-mode"),t.btnTextVal=n},e.bind("click",function(){angular.element(".dropdown-content").removeClass("show"),angular.element(".dropbtn").removeClass("active-mode")})}return{restrict:"EA",transclude:!0,replace:!0,scope:{hasIcon:"=",datalist:"=",initValue:"=",toggleId:"@",listAlignment:"@",cddClickEvent:"&",clickElement:"@",iconClass:"@",menuTitle:"@"},templateUrl:"app/components/common-callout/common-callout-template.html",link:t}}])}(),function(){"use strict";angular.module("wpoffice").factory("categoryTreeCache",function(){var e={};return e.treeData={internal:{isOpen:!0,children:[]}},e})}(),function(){"use strict";angular.module("wpoffice").directive("categoryTree",["categoryService","$location","appData",function(e,t,n){var o={restrict:"E",replace:!0,templateUrl:"app/components/category-tree/category-tree_template.html",scope:{callbackAfterTagSelection:"=",preSelectedId:"="},controller:["$scope","$rootScope","categoryTreeCache","$timeout",function(t,n,o,i){function a(){t.categoryList.internal.children=[],e.getRootCategories(!1,1).then(function(e){r(t.categoryList.internal,e)})}function r(e,t){for(var n,o=[],i=0;i<t.length;i++)n=t[i],n.editable=!1,n.hasOwnProperty("hasChildren")?("System"===n.ownerId&&""===n.parentId?n.tagType="ROOT_TAG":n.tagType="TAG_GROUP",n.children=[]):n.tagType="TAG",o.push(n);if(e.hasOwnProperty("children"))e.children=e.children.concat(o);else for(var a=0;a<o.length;a++)e.push(o[a])}function l(t){var n=t.$modelValue,o=!0,i=e.getCategoryChildren(n.id,o).then(function(e){n.children=[],e.subGroups&&r(n,e.subGroups),e.tags&&r(n,e.tags),t.toggle(t)});return i}function s(){if(t.isTagDialog)for(var e=0;e<t.categoryList.length;e++)if("ENTERPRISE"===t.categoryList[e].type){i(function(){var o=angular.element(document.getElementById("Node_"+t.categoryList[e].id)).scope();t.selectedTag=o.$nodeScope,t.selectedTagID=t.categoryList[e].id,t.callbackAfterSelection(t.selectedTag),n.$emit("TAG_GROUP_LOADING_COMPLETED")},100);break}}t.selectedTagID="",t.selectedTag=null,t.categoryList=o.treeData,t.$on("REFRESH_CONTENT",function(e,t){a()}),t.initialiseTagView=function(){0===t.categoryList.internal.children.length&&(t.loadingTags=!0,e.getRootCategories(!1,1).then(function(e){0===t.categoryList.internal.children.length&&(r(t.categoryList.internal,e),t.loadingTags=!0),t.preSelectedId&&t.callbackAfterActive&&(t.selectedWidgetId=t.preSelectedId,t.callbackAfterActive(t.selectedWidgetId)),t.isTagDialog&&s()},function(){t.loadingTags=!1}))},t.selectTagNode=function(e,n,o){t.selectedTagID=e.id,t.selectedTag=e;var i=e.children&&e.children.length;"TAG_GROUP"===e.tagType||"ROOT_TAG"===e.tagType?o&&!i?l(n):n.toggle(n):"TAG"===e.tagType&&t.callbackAfterTagSelection&&t.callbackAfterTagSelection(n)},t.toggle=function(e){var n=t.categoryList;1===e&&(n.internal.isOpen=!n.internal.isOpen)}}]};return o}])}(),function(){"use strict";angular.module("wpoffice").service("witService",["apiService","commentService","$q","userDataFactory","appData","FileSaver",function(e,t,n,o,i,a){function r(e){for(var t={},n=0,o=e.length;n<o;n++){var i=e[n];t[i.associatedWitId]=i.seqNumber}return t}function l(e){var t="/wittyparrot/api/public/attachments/"+e,n=document.getElementById("witty-download");n&&(n.src=t)}function s(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(n,o){var i=n[e]<o[e]?-1:n[e]>o[e]?1:0;return i*t}}var c="/wits",u="/wit/export/pdf",d="/wits/rate",p="/attachments",f="/user/widgets",m="/attachments/bytes",g="/sso/wittyparrotsso?target=web-office-addin",h="/account/list",E="/job",v="/timezone",w="/witLinks",A="/externalshareable/share/external",I="/box",T="/wopi/endpoint",y="/attachments/inlineImage/",C={};this.saveWit=function(t){var n={};return t.id?(n.id=t.id,n.name=t.name,n.content=t.content,n.desc=t.desc,n.acronyms=t.acronyms,n.parentId=t.parentId,n.expiryDate=null!==t.expiryDate&&""!==t.expiryDate?moment(t.expiryDate).toISOString():"",n.firstAlert=null!==t.firstAlert?t.firstAlert:0,n.secondAlert=null!==t.secondAlert?t.secondAlert:0,n.updateNumber=t.updateNumber,n.note=t.note,n.attachmentDetails=t.attachmentDetails,n.comboWit=t.comboWit,n.tagVos=t.tagVos,n.readOnlyWorkflow=t.readOnlyWorkflow,n.reuseWorkflow=t.reuseWorkflow,e.callPut(c,n)):e.callPost(c,t)},this.saveAsWit=function(t){return e.callPost(c+"/saveAs",t)},this.uploadDocAsWit=function(t,n){return e.callWitDocPost(m+"?fileName="+n,t)},this.getWit=function(t){return e.getList(c+"/"+t,"")},this.getUsersWidget=function(){return e.getList(f,"")},this.getWitsOfWidget=function(t,n){var o={},i="/user/widgets/data?id="+t;return n&&(o={searchTerm:n.searchTerm?n.searchTerm:null,witType:n.witType?n.witType:null,sort:n.sort?n.sort:null,asc:!!n.asc&&n.asc}),e.getList(i,o)},this.getWitsOfWidgetFromAnalytics=function(t){var n={flag:t},o="/dscommons";return e.getDsapiList(o,n)},this.saveWitComments=function(e){return t.saveWitComments(e)},this.deleteWitComments=function(e){return t.deleteComment(e)},this.setRating=function(t,n){var o={witId:t,rating:n};return e.callPut(d,o)},this.getWitFromTags=function(t,n){n=n||{};var o=c+"/listbytag/"+t,i={witType:n.witType?n.witType:null,sort:n.sort?n.sort:null,asc:void 0===n.asc||n.asc};return e.getList(o,i)},this.findDuplicateFromWit=function(t,n){var o=[],i=[];Array.isArray(t)?o=t:o.push(t),Array.isArray(n)?i=n:i.push(n);var a={witIds:o,folderIds:i};return e.callPost(c+"/checkDuplicates",a)},this.makeAutoTag=function(t,n){var o=[],i=[];Array.isArray(t)?o=t:o.push(t),Array.isArray(n)?i=n:i.push(n);var a={witIds:o,folderIds:i};return e.callPost("/autoTag",a)},this.getFolderPath=function(t){var n=c+"/"+t+"/folderpath";return e.getList(n)},this.listWitByIds=function(t){return e.callPost(c+"/listbyids",t)},this.listAllVersions=function(t){var n=c+"/"+t+"/listAllVersions";return e.getList(n)},this.updateAsNewVersion=function(t){var n={id:t.id,updateNumber:t.updateNumber};return e.callPut(c+"/updateAsNewVersion",n)},this.getWitArchiveByVersion=function(t,n){var o=c+"/"+t+"/version/"+n;return e.getList(o)},this.getWitAsPdf=function(t){var n={transformResponse:void 0,responseType:"blob"},o=u+"?witId="+t.witId+"&exportAttachment=true&exportTags=false&exportNote=false&exportComments=false";return e.getList(o,"",!0,n)},this.getAcronymList=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n,o,i=[],a=t.querySelectorAll(".var_acronym"),r=[],l=0;l<a.length;l++)n=a[l],o=n.getAttribute("var"),r.indexOf(o)===-1&&i.push({name:o,value:n.getAttribute("data-default"),"default":n.getAttribute("data-default")}),r.push(o);return i},this.replaceAcronym=function(e,t,n){for(var o,i=n.querySelectorAll(".var_acronym"),a=0;a<i.length;a++)o=i[a],o.getAttribute("var")===e&&(t.length>0?(o.style.color="inherit",o.innerHTML=t):(o.style.color="rgb(236, 27, 82)",o.innerHTML="["+e+"]"))},this.downloadFile=function(t){var n;t.fileAssociationId?n=p+"/associationId/"+t.fileAssociationId:t.fileId&&(n=p+"/"+t.fileId),e.getBlob(n,"").then(function(e){a.saveAs(e,t.fileName)})},this.getComboWit=function(e){for(var t,o=r(e.comboWit),i=[],a=Object.keys(o),l=[],c=[],u="",d=null,p=[],f=0,m=a.length;f<m;f++)t=this.getWit(a[f]).then(function(e){e&&(e.seqNumber=o[e.id],e.attachmentDetails=e.attachmentDetails||[],l.push(e))}),i.push(t);return d=n.all(i).then(function(){l.sort(s("seqNumber"));for(var t=0,n=l.length;t<n;t++)c=c.concat(l[t].attachmentDetails),u+=l[t].content,l[t].acronyms&&(p=p.concat(l[t].acronyms));var o={attachmentDetails:c,content:u,name:e.name,responseList:l,acronyms:p};return o})},this.getPublicId=function(t){return e.callPost(p+"/public/bulk",t)},this.getSsoToken=function(t){return e.callPost(g,t)},this.getAccountList=function(t){return e.callPostCampaign(h,t)},this.createJob=function(t){return e.callPostCampaign(E,t)},this.externalCall=function(t,n){return e.externalAPICall(E,t,n)},this.getTimeZone=function(){return e.getListCampaign(v,"")},this.getPublicWitlink=function(t){var n=w+"/public/"+t;return e.getList(n)},this.getWitlinksOfWit=function(t){var n=w+"/search";return e.getList(n,t)},this.sharePrivateWitlink=function(t){return e.callPost(w,t)},this.shareWitlink=function(t){return e.callPost(A,t)},this.getPublicUrls=function(t){return e.callPost(p+"/public/bulk",t)},this.downloadAttachment=function(e,t,n){var o={witFileAssociationId:e.fileAssociationId,attachmentType:t?t:"LIVE",expiryMinutes:n?n:10};return this.getPublicUrls([o]).then(function(e){return l(e[0].publicAttachmentId),e})},this.deleteWits=function(t){return e.callDelete(c,t)},this.uploadBoxFile=function(t){return e.callPost(I+"/"+t)},this.getFileUrlFromWopi=function(t,n,o){var i={};return o&&(i.view="inline"),e.getList(T+"/"+t+"/"+n,i)},this.setWitData=function(e){C=e},this.getWitData=function(){return C},this.imageUpload=function(t){return e.callPost(y,t)}}])}(),function(){"use strict";angular.module("wpoffice").service("viewerService",["apiService",function(e){var t="/attachments",n="/wopi/endpoint/";this.downloadAttachment=function(n){var o=t+"/associationId/"+n;return e.getBlob(o,"")},this.getWopiUrl=function(t){var o=n+t+"/EmbedView";return e.getList(o,"")}}])}(),function(){"use strict";angular.module("wpoffice").factory("userDataFactory",[function(){var e=null,t=[],n=null,o={};return o.setUserProfileData=function(t){void 0,void 0,e=t},o.getUserProfileData=function(){return e},o.setUserData=function(t,n){e.key=n},o.getUserData=function(t){return e.key},o.hasUserProfileData=function(){return!!e},o.getUserWorkspace=function(){return o.hasUserProfileData()?e.userWorkspaces:t},o.getUserEnterprise=function(){return o.hasUserProfileData?e.enterpriseId:""},o.getUserWorkspaceWithPermission=function(){var e=o.getUserWorkspace(),t=e.length;if(t)for(var n={canEditFolderAndWits:!0},i=0;i<t&&!e[i].loggedInUserPermission;i++)e[i].loggedInUserPermission=n;return e},o.getUserAvatarUrl=function(){return o.hasUserProfileData()?e.avatarUrl:""},o.setUserAvatarUrl=function(t){o.hasUserProfileData()&&(e.avatarUrl=t)},o.getUserId=function(){return o.hasUserProfileData()?e.id:""},o.getUserEmail=function(){return o.hasUserProfileData()?e.email:""},o.getUserFirstName=function(){return o.hasUserProfileData()?e.firstName:""},o.setUserFirstName=function(t){o.hasUserProfileData()&&(e.firstName=t)},o.getUserLastName=function(){return o.hasUserProfileData()?e.lastName:""},o.setUserLastName=function(t){o.hasUserProfileData()&&(e.lastName=t)},o.getUserFullName=function(){return o.hasUserProfileData()?o.getUserFirstName()+" "+o.getUserLastName():""},o.getUserStatus=function(){return o.hasUserProfileData()?e.status:""},o.isActiveUser=function(){var t=!1;return o.hasUserProfileData()&&(t="active"===e.status.toLowerCase()),t},o.getUserRole=function(){return o.hasUserProfileData()?e.role:n},o.getUserRolePermission=function(){return o.hasUserProfileData()&&e.role?e.role.permissions:t},o.getAssociativeListOfUserRolePermission=function(){for(var e=o.getUserRolePermission(),t={},n={},i=0,a=e.length;i<a;i++)n=e[i],t[n.code]=n;return t},o.getUserPackage=function(){return o.hasUserProfileData()?e.userPackages:t},o.getUserEnterpriseId=function(){return o.hasUserProfileData?e.enterpriseId:""},o.getAssociativeListOfFeatures=function(){for(var e=o.getUserPackage(),t={},n=[],i={},a=0,r=e.length;a<r;a++){var l=e[a].packageDetail;n=l&&"active"===l.status.toLowerCase()?l.features:[];for(var s=0,c=n.length;s<c;s++)i=n[s],t[i.code]||(t[i.code]=i)}return t},o.hasFeatureInPackage=function(e){for(var t=!1,n=[],i=o.getUserPackage(),a=0,r=i.length;a<r;a++){var l=i[a].packageDetail;n=l&&"active"===l.status.toLowerCase()?l.features:[];for(var s=0,c=n.length;s<c;s++)n[s].code===e&&(t=!0)}return t},o}])}(),function(){"use strict";angular.module("wpoffice").service("tagService",["apiService","witService",function(e,t){var n="/taggroups",o="/tags";this.getInternalTagGroups=function(t,o,i){var a={level:o||2,tags:t||!1},r=n+"/hierarchy";return i&&(r+="/"+i),e.getList(r,a)},this.getTagGroupChildren=function(t,o){var i={tags:o||!1},a=n+"/"+t;return e.getList(a,i)},this.listWitFromTag=function(e,n){return t.getWitFromTags(e,n)},this.searchTags=function(t){var n={name:t,pageSize:20},i=o+"/search";return e.getList(i,n)},this.loadTagsOnDemand=function(t){var n=o+"/search";return e.getList(n,t)}}])}(),function(){"use strict";angular.module("wpoffice").service("syncService",["apiService","commentService","$q","userDataFactory","appData","FileSaver",function(e,t,n,o,i,a){var r="/users/preference/";this.getUserProfileData=function(){var t=r;return e.getList(t)}}])}(),function(){"use strict";angular.module("wpoffice").service("registrationService",["$http",function(e){var t="https://qawittyapi.wittyparrot.com/saasuser/api/app/user";this.signUp=function(n){return e.post(t,n)}}])}(),function(){"use strict";angular.module("wpoffice").service("popUpService",["$window","$state","notify","ngNotify",function(e,t,n,o){this.openEmailWindow=function(n){e.externalEmailWindow=e.open(t.href("email",{},{absolute:!0}),"_blank","scrollbars=yes,resizable=yes,top=200,left=300,width=700,height=500"),!e.externalEmailWindow||e.externalEmailWindow.closed||"undefined"==typeof e.externalEmailWindow.closed?o.set("Please enable pop-ups and try again !","error"):e.externalEmailWindow.winInfo=n}}])}(),function(){"use strict";angular.module("wpoffice").service("PermissionsService",["apiService","$q",function(e,t){this.getAssignedPrincipals=function(t){return e.getList("/content/"+t+"/assignedprincipals","")},this.getInheritedPrincipals=function(t){return e.getList("/content/"+t+"/inheritedprincipals","")},this.shareRequest=function(t){var n=t;return e.callPost("/content/share",n)},this.unshareRequest=function(t){var n=t;return e.callPost("/content/unshare",n)}}])}(),function(){"use strict";angular.module("wpoffice").service("notificationService",["apiService","$q",function(e,t){this.getAllNotifications=function(t,n){var o=n||30,i=t||0,a="startIndex="+i+"&pageSize="+o;return e.getList("/notifications?"+a,"")},this.getUnreadNotifications=function(t,n){var o=n||30,i=t||0,a="isRead=false&startIndex="+i+"&pageSize="+o;return e.getList("/notifications?"+a,"")},this.markRead=function(t){var n=t;return e.callPut("/notifications/markRead",n)}}])}(),function(){"use strict";angular.module("wpoffice").service("fileUtilityService",["$filter","FileSaver","FILE_TYPE",function(e,t,n){this.getFileExtension=function(e){return e.substr(e.lastIndexOf(".")+1)},this.getFileSize=function(e){var t=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Byte";var n=Math.floor(Math.log(e)/Math.log(1e3)),o=this.$filter("number")(e/Math.pow(1e3,n),1);return o+" "+t[n]},this.saveFile=function(e,t){this.FileSaver.saveAs(e,t)},this.isPdfFile=function(e){return n.pdf.indexOf(e)!==-1},this.isImageFile=function(e){return n.image.indexOf(e)!==-1},this.isOfficeFile=function(e){return n.office.indexOf(e)!==-1},this.isAudioFile=function(e){return n.audio.indexOf(e)!==-1},this.isVideoFile=function(e){return n.video.indexOf(e)!==-1}}])}(),function(){"use strict";angular.module("wpoffice").service("feedbackService",["apiService",function(e){var t="/appfeedback";this.submitFeedback=function(n){return e.callPostWithoutContentType(t,n)}}])}(),function(){"use strict";angular.module("wpoffice").service("eventLogger",["appData","userDataFactory","apiService","RECIPIENT_TYPE",function(e,t,n,o){this.logEvent=function(i,a){a=a||{};var r=void 0!=i&&null!=i;if(r){var l=i.name,s=i.id,c={loggedInUserId:t.getUserId(),enterpriseId:t.getUserEnterpriseId(),eventName:l,eventId:s,eventTimeStamp:moment().utc().valueOf(),appVersion:e.Version,appId:e.appId,recipientType:o.USER,apiSpecificEventData:a};return n.callPostEvent(c)}}}])}(),function(){"use strict";angular.module("wpoffice").service("errorcodes",function(){var e={"E03-3001":"The operation was not successful due to some network or unknown issue. Please try after sometime. If the problem persists, please open a ticket by clicking Need Help in status bar."},t=Object.create(e,{"E04-4015":{value:" Referenced object id could not be found"},"E01-1003":{value:"Access denied. You do not have permission to perform this operation on the given wit"},"E01-1002":{value:"You don't have permission to delete wit"},"E06-6115":{value:"Unable to delete Wit because it is locked for editing"},"E04-4001":{value:"Mandatory parameter missing"},"E06-6072":{value:"Failed to update node"},"E06-6114":{value:"Widget type is invalid"}}),n=Object.create(e,{"E05-5002":{value:"User is not Authenticated for WittyParrot."},"E06-6032":{value:"WidgetId is not valid"},"E06-6072":{value:"Failed to update node"},"E01-1002":{value:"You don't have access to this wit, folder or file"}}),o=Object.create(e,{"E04-4020":{value:" Invalid further share permission specified"},"E05-5004":{value:"User could not be authenticated. Invalid user name provided"},"E01-1002":{value:"Access denied. You do not have permission to perform this operation, please contact your administrator"},"E04-4015":{value:"Can not share unsynced Wit/Folder. Please try after it is synced"},"E04-4001":{value:"The following input or information is missing or incorrect, please correct and resubmit"},"E06-6029":{value:"System folder can not be shared"},"E06-6027":{value:"The wit or folder is shared through its parent. Sharing can be changed through parent folder only"},"E04-4004":{value:"User Email is invalid"},"E01-1000":{value:"You are not authorized to share this wit/ folder with another user"},"E04-4042":{value:"You are not authorized to share this wit/ folder with permission which is higher than your further share permission"},"E06-6072":{value:"Failed to update node"},"E04-4043":{value:"You are not authorized to share this wit/ folder with permission which is higher than your authorized permission"},"E04-4045":{value:"You are trying to update Owner's permissions, which is not allowed. Please check userName provided."},"E04-4046":{value:"You are not authorized to change your own access on this wit/ folder"},"E04-4044":{value:"Invalid widget id or permission id provided as parameter"},"E06-6125":{value:"Wit or folder could not be shared with user name. User's account type is premium"},"E06-6032":{value:"WidgetId is not valid"},"E06-6035":{value:"Enterprise Folders/Wits/Docs Sharing is only possible with Enterprise account. You need to upgrade your account to access this item"}}),i=Object.create(e,{"E06-6026":{value:"Error while unsharing of wit or folder. The wit or folder might already be unshared with the user, or sharing never existed"
},"E06-6027":{value:"The wit or folder is shared through its parent. Sharing can be removed through parent folder only"},"E01-1002":{value:"You don't have access to this wit, folder or file"}}),a={"E06-6030":"Wit does not exist","E04-4001":"Mandatory parameter missing"},r=Object.create(e,{"E04-4001":{value:"Please select the widget"},"E01-1002":{value:"You don't have access to this wit, folder or file"}}),l={"E04-4001":"Email ID is missing or incorrect, please correct and resubmit","E04-4004":"Invalid username/ email id. Please enter the email id"},s={"E04-4001":"First name is missing or incorrect, please correct and resubmit"},c=Object.create(e,{"E06-6026":{value:"Error while unsharing of wit or folder. The wit or folder might already be unshared with the user, or sharing never existed"},"E06-6060":{value:"The referenced wit/ folder does not exist anymore, or you no longer have access to the same"}}),u={"E06-6017":"Please provide a valid notification Id"},d={"E06-6120":"User being added to the group should belong to your enterprise account","E04-4001":"Mandatory parameter missing","E04-4015":" Referenced object id could not be found","E01-1003 ":"You don't have permission to perform this operation","E06-6118":"Group with the given name already exists in the system"},p={"E04-4001":"Mandatory parameter missing","E04-4040":"Group Name can not contain following characters: '*','?','<','>','|','/','',':'","E06-6119":"Groups can not be created in personal or shared workspace","E06-6107":"Invalid workspace type provided as parameter","E01-1003 ":"You don't have permission to perform this operation","E06-6118":"Group with the given name already exists in the system"},f={"E04-4015":" Referenced object id could not be found","E01-1003":"You don't have permission to perform this operation","E01-1004":"You don't have permission to perform this operation","E04-4001":"Mandatory parameter missing","E04-4040":"Group Name can not contain following characters: '*','?','<','>','|','/','',':'"},m={"E04-4015":" Referenced object id could not be found","E01-1003":"You don't have permission to perform this operation","E01-1004":"You don't have permission to perform this operation","E04-4001":"Mandatory parameter missing","E04-4040":"Group Name can not contain following characters: '*','?','<','>','|','/','',':'","E06-6118":"Group with the given name already exists in the system"},g={"E04-4001":"Mandatory parameter missing","E01-1003":"You don't have permission to perform this operation","E06-6107":"Provided 'spaceType' param is not valid","E06-6091":"Admins can update only company workspace font settings. Please check provided workspaceType","E06-6092":"Font settings for shared workspace can not be updated. By default personal workspace font settings are applicable for Shared workspace","E06-6093":"Only Premium users can update font settings in Premium Workspace","E06-6094":"Only Enterprise users can update font settings in Company Workspace","E02-0004":"Unable to Generate a JSON Object from Request","E04-4047":"Professional users are not authorized to perform this operation","E06-6132":"Invalid fontSettingOperationId provided as parameter","E06-6129":"You are not authorized to update default font settings for company workspace","E06-6130":"You are not authorized to update default font settings for premium workspace","E06-6127":"Admins can update only company workspace font settings. Please check provided workspaceType"},h=Object.create(e,{"E04-4015":{value:"The reference id is not valid"},"E04-4001":{value:"Wit name is missing or incorrect, please correct and resubmit"},"E04-4017":{value:"The referenced folder does not exist in WittyParrot repository"},"E04-4018":{value:"The referenced folder does not exist in WittyParrot repository"},"E06-6014":{value:" Invalid folder type specified. It should either be Personal or Enterprise or Premium"},"E06-6032":{value:"Invaid input. Provided widget id is invalid"},"E06-6071":{value:"Invalid access. You need a premium account to create, copy or move a wit, doc or folder under premium workspace"},"E06-6001":{value:"You have exceeded the number of wits limit set for you. Please contact your administrator to increase the limit"},"E06-6099":{value:"Only 'Combo Wit' can be created inside 'Combo Wits' folder. Please select different folder to create a standard Wit"},"E06-6100":{value:"Wits cannot be created manually in 'Discovered Wits' Folder. Please select different folder to create a Wit"},"E06-6097":{value:"A Combo Wit cannot be created outside of 'Combo Wits' folder in personal workspace"},"E01-1002":{value:"You don't have access to this wit, folder or file"},"E06-6072":{value:"More than one user trying to access this widget at this time. Please try after some time"},"E04-4049":{value:"Wit name is not valid. Wit name can be a an alpha numeric only"}}),E={"E04-4001":"Wit name is missing or incorrect, please correct and resubmit","E04-4017":"The referenced folder does not exist in WittyParrot repository","E04-4018":"The referenced folder does not exist in WittyParrot repository","E06-6014":" Invalid folder type specified. It should either be Personal or Enterprise or Premium","E06-6032":"Invaid input. Provided widget id is invalid","E06-6071":"Invalid access. You need a premium account to create, copy or move a Combo Wit, doc or folder under premium workspace","E06-6001":"You have exceeded the number of wits limit set for you. Please contact your administrator to increase the limit","E06-6097":"A Combo Wit cannot be created outside of 'Combo Wits' folder in personal workspace"},v=Object.create(e,{"E04-4015":{value:" Referenced object id could not be found"},"E01-1002":{value:"You don't have permission to update this wit"},"E06-6022":{value:"Could not update wit on server as it is locked by other user for editing"},"E04-4001":{value:"Mandatory parameter missing"},"E06-6072":{value:"More than one user trying to access this widget at this time. Please try after some time"},"E04-4049":{value:"Wit name is not valid. Wit name can be a an alpha numeric only"}}),w={"E04-4001":"Folder name is missing or incorrect ,Please enter a folder name and resubmit","E04-4016":"A folder with name is already exists in the given location. Cannot create a folder with the same name","E04-4017":"The referenced folder does not exist in WittyParrot repository","E06-6015":"Invalid operation. The parent folder widget type should match the widget type of the folder","E06-6069":"Invalid access. Can not create, copy or move a folder under system folder","E06-6070":"Invalid access. Can not create, copy or move a folder in shared workspace","E01-1003":"Access denied. You do not have permission to perform this operation on this folder","E01-1002":"Access denied. You do not have permission to create this folder","E06-6034":"Parent folder widget type did not match with current folder widget type","E04-4035":"Folder Name can not contain following characters: '*','?','<','>','|','/','',':'"},A=Object.create(e,{"E01-1003":{value:"Access denied. You do not have permission to perform this operation on the given folder"},"E04-4001":{value:"Folder name is missing or incorrect, please correct and resubmit"},"E04-4015":{value:" Referenced object id could not be found"},"E06-6008":{value:"Invalid access. Cannot delete a system folder"},"E06-6115":{value:"Unable to delete folder because it's wit is locked for editing"},"E01-1002":{value:"You do not have permission to delete this folder."}}),I=Object.create(e,{"E01-1003":{value:"Access denied. You do not have permission to perform this operation on the given folder"},"E04-4015":{value:" Referenced object id could not be found"},"E04-4016":{value:"A folder with name provided already exists in the given location. Cannot create a folder with the same name"},"E06-6007":{value:"Invalid access. Cannot modify a system folder"},"E06-6072":{value:"More than one user trying to access this widget at this time. Please try after some time"},"E01-1002":{value:"You don't have access to this wit, folder or file"},"E04-4035":{value:"Special characters are not allowed in the folder name"},"E04-4001":{value:"Folder name is missing or incorrect, please correct and resubmit"}}),T=Object.create(e,{"E04-4009":{value:"No Wit id or file id found with the request"},"E06-6053":{value:"Wit with the same name already exists in the destination folder. Cannot copy"},"E06-6056":{value:"Folder with the same name already exists in the destination folder. Cannot copy"},"E06-6057":{value:"Invalid operation. A folder of type wit or document can only be copied to wit type folder or document type folder respectively"},"E06-6007":{value:"Folder can not be copied to system folder"},"E06-6069":{value:"Folder can not be copied to system folder"},"E01-1002":{value:"Access denied. You do not have permission to perform this operation"},"E06-6054":{value:"Standard Wits including Discovered Wits cannot be pasted into 'Combo Wits' folder"},"E06-6097":{value:"A Combo Wit cannot be pasted outside of 'Combo Wits' folder"},"E06-6098":{value:"User created Wits cannot be pasted into 'Discovered Wits' folder"},"E06-6072":{value:"Server is busy at the moment to take this request. Please try again after few seconds"},"E06-6001":{value:"You have exceeded the number of wits limit set for you. Please contact your administrator to increase the limit"},"E06-6112":{value:"Error while copy wit tags"}}),y=Object.create(e,{"E04-4009":{value:" No Wit id or file id found with the request"},"E06-6053":{value:"Folder with the same name already exists in the destination folder. Cannot move"},"E06-6056":{value:"Folder with the same name already exists in the destination folder. Cannot move"},"E06-6057":{value:"Invalid operation. A folder of type wit or document can only be copied to wit type folder or document type folder respectively"},"E06-6007":{value:"Folder can not be moved to system folder"},"E06-6069":{value:"Folder can not be moved to system folder"},"E01-1002":{value:"You don't have permission to move folder/wit on this folder"},"E06-6058":{value:"You don't have permission to move folder/wit on this folder"},"E06-6054":{value:"Standard Wits including Discovered Wits cannot be moved to 'Combo Wits' folder"},"E06-6097":{value:"A Combo Wit cannot be moved outside of 'Combo Wits' folder"},"E06-6098":{value:"User created Wits cannot be moved to 'Discovered Wits' folder"},"E06-6116":{value:"Unable to move because the selected Wit or one of the Wits in selected folder is locked for editing"},"E06-6072":{value:"Server is busy at the moment to take this request. Please try again after few seconds"},"E06-6001":{value:"You have exceeded the number of wits limit set for you. Please contact your administrator to increase the limit"}}),C=Object.create(e,{"E04-4020":{value:" Invalid further share permission specified"},"E05-5004":{value:"User could not be authenticated. Invalid user name provided"},"E01-1002":{value:"Access denied. You do not have permission to perform this operation, please contact your administrator"},"E04-4015":{value:"Can not share unsynced Wit/Folder. Please try after it is synced"},"E04-4001":{value:"The following input or information is missing or incorrect, please correct and resubmit"},"E06-6029":{value:"Combo wits cannot be shared"},"E06-6027":{value:"The wit or folder is shared through its parent. Sharing can be changed through parent folder only"}}),_=Object.create(e,{"E06-6026":{value:"Error while unsharing of wit or folder. The wit or folder might already be unshared with the user, or sharing never existed"},"E06-6027":{value:"The wit or folder is shared through its parent. Sharing can be removed through parent folder only"}}),b={"E05-5002":"User could not be authenticated. Invalid user name or password provided","E05-5004":"User could not be authenticated. Invalid user name provided","E06-6023":"User could not be authenticated. Account is not active","E06-6024":"User could not be authenticated. Account is expired","E06-6073":"User could not be authenticated. Trial period expired","E06-6074":"User could not be authenticated. Payment mode expired","E06-6075":"Account has been disable by your Enterprise. Please contact Administrator of your Enterprise","E04-4003":"User could not be authenticated. Invalid payment mode","E01-1005":"The WittyParrot account you are trying to login, or use, is restricted to be used from within a certain network. Please contact your network administrator for more details or to enable your network for the account"},S=Object.create(e,{"E06-6026":{value:"Error while unsharing of wit or folder. The wit or folder might already be unshared with the user, or sharing never existed"},"E06-6060":{value:"The referenced wit/ folder does not exist anymore, or you no longer have access to the same"}}),O={"E04-4001":"Password is missing or incorrect, please correct and resubmit","E04-4006":"The password should have minimum 6 characters and maximum 100 characters","E04-4003":"Provided email address is not registered with WittyParrot"},D={"E04-4001":"Password is missing or incorrect, please correct and resubmit","E04-4002":"Please enter correct current password","E04-4006":"The password should have minimum 6 characters and maximum 100 characters","E05-5004":"User is invalid"},N={},L={"E04-4001":"First name or email is missing or incorrect. Please verify again and re-submit.","E06-6004":"User with the provided user name already exists. Please choose a different user name","E06-6012":"Invalid input. The provided package info is invalid","E06-6042":"You have already used up the subscribed number of wit limit for your enterprise account. Please contact administrator to increase the number of wit limit","E06-6043":"You have already used up the subscribed storage space for your enterprise account. Please contact administrator to increase the staorage space","E06-6044":"You have already used up the subscribed limit for number of users in enterprise account. Please increase the limit in order to create the new user","E06-6045":"Invalid input. The default wits per user should be greater than minimum limit for wits per user","E06-6046":"Invalid input. The storage space allocated to user cannot be less than minimum limit for selected package","E06-6047":"Invalid input. The number of wits allocated to user should be greater than wits already created by user","E06-6048":"Invalid input. The storage space allocated to  user should be greater storage space already used up by user","E04-4004":"Invalid input. Please provide a valid email address","E06-6001":"You have exceeded the number of wits limit set for you. Please contact your administrator to increase the limit"},P={"E04-4011":" No operation code (add/ remove) was specified for file operation","E04-4013":" No file ids  found with the request"},W={"E04-4011":" No operation code (add/ remove) was specified for file operation","E04-4013":" No file ids  found with the request"},R={"E06-6101":"Could not create tag group as another tag group already exist with same name","E06-6105":"Can not create Tag/Tag group inside this Tag Group","E06-6107":"Invalid workspace provided as parameter","E04-4035":"Tag Name can not contain following characters: '*','?','<','>','|','/','',':'"},F={"E04-4001":"Mandatory parameter missing","E06-6102":"Could not create tag as another tag already exist with same name","E06-6105":"Can not create Tag/Tag group inside this Tag Group","E06-6107":"Invalid workspace provided as parameter","E04-4035":"Tag Name can not contain following characters: '*','?','<','>','|','/','',':'"},k=Object.create(e,{"E06-6072":{value:"Server is busy at the moment to take this request. Please try again after few seconds"}}),x=Object.create(e,{"E04-4016":{value:"Folder name already exist"},"E04-4017":{value:"folderId does not exist"},"E04-4018":{value:"Folder ID is invalid"},"E04-4001":{value:"Mandatory parameter missing"}}),M=Object.create(e,{"E04-4001":{value:"Mandatory parameter missing"},"E04-4021":{value:"Authentication failed. Invalid app secret provided in the request"},"E06-6084":{value:"Exception on wit/doc content encription"},"E01-1002":{value:"You don't have access to this wit, folder or file"}}),U={"E04-4015":"The reference id is not valid"},$=Object.create(e,{"E04-4015":{value:"The reference id is not valid"}}),G={"E06-6092":"Provided 'tagId' param does not exist","E04-4001":"Mandatory parameter missing"},V={"E06-6095":"Wit Id passed as parameter does not exist","E06-6092":"Tag id passed as parameter does not exist","E01-1002":"You don't have access to this wit, folder or file","E06-6060":"This item has been deleted or unshared with you","E04-4001":"Mandatory parameter missing"},B={"E06-6032":"WidgetId is not valid"},H={"E06-6093":"Provided 'tagGroupId' param does not exist","E06-6106":"Provided tagGroupId param is not valid"},j={"E04-4001":"Mandatory parameter missing","E06-6108":"Status is invalid, Please provide a valid status"},Y=Object.create(e,{"E06-6094":{value:"Provided 'witId' is not associated with a tag"},"E01-1002":{value:"You don't have access to this wit, folder or file"},"E06-6092":{value:"Provided 'tagId' param does not exist"}}),z={"E06-6109":"System created Tag groups can not be deleted","E04-4001":"Mandatory parameter missing"},K={"E06-6104":"Provided 'tagId' param is already removed","E01-1002":"You don't have access to this tag, wit, folder or file"},q={"E06-6092":"Provided 'tagId' param does not exist","E04-4001":"Mandatory parameter missing","E01-1002":"You don't have access to this tag, wit, folder or file"},Z=Object.create(e),X={"E04-4001":"Mandatory parameter missing","E06-6101":"Provided 'tagGroupName' param already exists","E04-4035":"Tag Name can not contain following characters: '*','?','<','>','|','/','',':'"},Q={"E04-4001":"Mandatory parameter missing","E06-6102":"Could not create tag as another tag already exist with same name","E04-4035":"Tag Name can not contain following characters: '*','?','<','>','|','/','',':'"},J={"E06-6015":"Widget TYPE is invalid. ParentFolder WidgetType should be same as Passed WidgetType"},ee={"E06-6049":"Invalid widget reference id, Rating can be applied to Wit, Document and Folder only"},te={"E04-8001":"Please provide title for the scheduled campaign job","E04-8002":"Invalid type provided for campaign job","E04-8003":"Messgage details not provided for campaign job","E04-8004":"Wit Id not provided in message detail for campaign job","E04-8005":"Message content type not provided for campaign job","E04-8006":"Message subject not provided for campaign job","E04-8007":"Message content not provided for campaign job","E04-8008":"Message recipients not provided for campaign job","E04-8009":"Message recipients not provided for campaign job","E04-8010":"Sender/ From not provided for the campaign job","E04-8011":"Invalid value for Sender/ From provided for the campaign job","E04-8012":"Schedule related information was not provided for campaign job","E04-8013":"Schedule type information was not provided for campaign job","E04-8014":"Schedule start date was not provided for campaign job","E04-8015":"Schedule end date was not provided for campaign job","E04-8016":"Schedule repeat information was not provided for campaign job","E04-8017":"Week days not provided to schedule weekly campaign job","E04-8018":"Timezone not selected for the campaign job","E04-8019":"Post time information not provided for campaign job","E04-8020":"Invalid schedule start date was provided for campaign job. Start date should be current or future date","E04-8021":"Invalid schedule end date was provided for campaign job. End date should be current or future, and should be after start date","E04-8023":"Invalid value provided for campaign account id","E06-8111":"Social media posting could not be performed for unknown reason","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},ne={"E04-8022":"The email account could not be authenticated with the given information","E04-8023":"Invalid value provided for campaign account id","E06-8103":"The email account could not be authenticated with the given information","E06-8104":"The campaign account could not be authenticated with the given information","E06-8105":"There is already a campaign account with the provided information in the system","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted","E04-4001":"Please provide all the values required to add an account.","E04-8033":"Unsupported account type provided"},oe={"E04-8023":"Invalid value provided for campaign account id","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},ie={"E04-8023":"Invalid value provided for campaign account id","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},ae={"E04-8023":"Invalid value provided for campaign account id","E06-8114":"Invaid user id proovided for campaign account","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},re={"E04-8023":"Invalid value provided for campaign account id","E04-8025":"Invalid value provided for delegate user's login id","E06-8108":"Invalid delegation id provided. The delegation is either invalid or already deleted","E06-8110":"Campaign account delegation cannot be done across enterprise accounts","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},le={"E08-8004":"Current User is not authorized for this action","E04-4001":"Mandatory parameter missing","E04-8023":"Invalid value provided for campaign account id","E04-8025":"Invalid value provided for delegate user's login id","E06-8108":"Invalid delegation id provided. The delegation is either invalid or already deleted","E06-8110":"Campaign account delegation cannot be done across enterprise accounts","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},se={"E04-8023":"Invalid value provided for campaign account id","E06-8101":"Campaign account does not exist in database, or is already deleted","E06-8102":"You are not authorized to perform the operation","E06-8201":"Database operation Failed"},ce={"E08-8002":"Campaign Account either deleted or not present.","E08-8004":"Current User is not authorized for this action.","E04-8023":"Invalid value provided for campaign account id","E06-8101":"Campaign account does not exist in database, or is already deleted","E06-8102":"You are not authorized to perform the operation","E06-8201":"Database operation Failed"},ue={"E04-8023":"Invalid value provided for campaign account id","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},de={"E06-8102":"You are not authorized to perform the operation","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},pe={"E06-8102":"You are not authorized to perform the operation","E06-8109":"The campaign job is either invalid of already deleted","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},fe={"E06-8112":"Invalid csv file format. Header is missing","E06-8201":"Database operation Failed","E06-8101":"Campaign account does not exist in database, or is already deleted"},me={"E04-8024":"Invalid value provided for delegation action","E06-8106":"The delegation approval link is invalid or already expired","E06-8107":"You have already taken action for this delegation request.","E06-8101":"Campaign account does not exist in database, or is already deleted","E06-8108":"You have already taken action for this delegation request."},ge={"E04-4001":"Mandatory parameter missing. "},he={"E04-4021":"Authentication failed. Invalid app secret provided in the request"},Ee={"E04-4015":"The reference id is not valid","E04-4001":"Mandatory parameter missing ","E04-4048":"Expiry alert date cannot be greater than expiry date itself","E06-6134 ":"Expiry details can not be set on System folders ","E01-1002":"You don't have access to this wit, folder or file","E06-6134":"Expiry details can not be set on System folders"},ve={"E04-4048":"Alert date can not be greater than widget expiry date","E04-4001":"Mandatory parameter missing"},we={"E04-9002":"Provided 'itemId' or 'itemName' or 'itemType' param is not valid","E04-9004":"Box access token has expired. Please reinitate OAuth"},Ae={"E04-9004":"Box access token has expired. Please reinitate OAuth"},Ie={"E04-4001":"Mandatory parameter missing","E04-9003":"The provided folder id is invalid or does not exist","E04-9004":"Authentication failed. Box access token has expired"},Te={"E04-9004":"Authentication failed. Box access token has expired","E04-9003":"The provided folder id is invalid or does not exist"},ye={"E04-9004":"Authentication failed. Box access token has expired","E04-9003":"The provided folder id is invalid or does not exist"},Ce=Object.create(e,{"E04-9001":{value:"The provided file id is invalid or does not exist"},"E04-4007":{value:"There is no file attached to request"},"E06-6001":{value:"Exceeded Available Personal Wit limit for Subscribed Package"},"E06-6072":{value:"Failed to update node"},"E06-6086":{value:"Error while generating events, Please check beacon service."},"E06-6021":{value:"Your wit is not synced with server. Please take the updated version from the server."},"E06-6139":{value:"File Uploading into Wittyparrot is in Restricted File Extensions List"}}),_e=Object.create(e,{"E04-9001":{value:"The provided file id is invalid or does not exist"},"E04-4007":{value:"There is no file attached to request"},"E06-6001":{value:"Exceeded Available Personal Wit limit for Subscribed Package"},"E06-6072":{value:"Failed to update node"},"E06-6021":{value:"Your wit is not synced with server. Please take the updated version from the server."},"E06-6139":{value:"File Uploading into Wittyparrot is in Restricted File Extensions List"}}),be={"E04-9003":"The provided folder id is invalid or does not exist","E04-4001":"Mandatory parameter missing","E04-9004":"Authentication failed. Box access token has expired"},Se={"E06-6072":"Failed to update node"},Oe={"E08-8002":"Campaign Account either deleted or not present.","E04-4001":"Mandatory parameter missing"},De={"E04-8023":"Invalid value provided for campaign account id.","E04-4001":"Mandatory parameter missing"},Ne=Object.create(e),Le=Object.create(e,{"E06-8110":{value:"Campaign account delegation cannot be done across enterprise accounts."},"E04-4004":{value:"User Email is invalid"},"E06-8121":{value:"Invalid user id provided for request delegation."}}),Pe=Object.create(e,{"E01-1002":{value:"You don't have access to this wit, folder or file"},"E04-4001":{value:"Mandatory parameter missing"},"E04-4018":{value:"Folder ID is invalid"},"E05-5002":{value:"User is not Authenticated for WittyParrot."},"E06-6140":{value:"Invalid File Operation Id in the Request"},"E06-6141":{value:"Invalid Notes Operation Id in the Request"},"E06-6142":{value:"Select atleast one operation to Perform"},"E06-6143":{value:"Empty wit list in the requested wit list or folder"},"E06-6114":{value:"Widget TYPE is invalid"}}),We={"E04-4002":"User old password is invalid","E04-4006":"The password should have minimum 6 characters and maximum 100 characters"},Re={"E05-5005":"User Access Token is empty.","E04-4001":"Mandatory parameter missing.","E06-6147":"No valid operation found","E06-6023":"User account is not yet activate.","E06-6025":"User account primary email not verified.","E06-6024":"User account is already expired.","E06-6075":"Your account has been disabled by your Enterprise, Please contact your admin to enable it","E06-6073":"User Trial Period Expired","E06-6074":"User Payment Mode Expired","E07-000":"Enterprise is Disabled by WittyParrot Admin","E13-1237":"Unable to Find user Encrypt ServerKey"},Fe={"E04-4001":"Mandatory parameter missing.witIds/folderIds","E05-5002":"Invalid token","E04-8036":"Error while sending message."},ke={"E04-4001":"Mandatory parameter missing.witIds/folderIds","E05-5002":"Invalid token","E04-8036":"Error while sending message."},xe={"E04-4001":"Mandatory parameter missing.witIds/folderIds","E05-5002":"Invalid token"},Me={"E06-6115":"Sharepoint URL not registered for Enterprise.","E06-6117":"Error connecting to Sharepoint.","E04-4041":"Can not import in system folder."};this.getErrorMessage=function(e,Ue){switch(Ue){case"deletewit":return t[e];case"associatefilestowit":return n[e];case"sharewidget":return o[e];case"unsharewidget":return i[e];case"getcomments":return a[e]||"Could not add comments due to some technical error";case"registeremails":return l[e];case"updateuserprofile":return s[e];case"emailNotificationErrorCode":return c[e];case"markasread":return u[e];case"updatedefaultfontsettings":return g[e];case"createwit":return h[e];case"createCompoundWitErrorCode":return E[e];case"updatewit":return v[e];case"createfolder":return w[e];case"deleteuserfolder":return A[e];case"modifyuserfoldername":return I[e];case"copywidget":return T[e];case"movewidget":return y[e];case"shareObjectErrorCode":return C[e];case"unShareObjectErrorCode":return _[e];case"login":return b[e];case"getnotification":return S[e];case"resetPasswordErrorCode":return O[e];case"changePasswordErrorCode":return D[e];case"createEnterpriseUserErrorCode":return L[e];case"addDocsToWitErrorCode":return P[e];case"removeDocsFromWitErrorCode":return W[e];case"createtaggroup":return R[e];case"createtag":return F[e];case"locknode":return k[e];case"getfolderwits":return x[e];case"getwitinfo":return M[e];case"getfolderdetails":return U[e];case"createcomment":return r[e];case"getwidgetpermissions":return $[e];case"gettagdetails":return G[e];case"associatewittag":return V[e]||"Could not associate tag due to some technical error";case"gettagsintaggroup":return H[e];case"tags":return j[e];case"getwittags":return Y[e];case"widgetevent":return J[e];case"ratewidget":return ee[e];case"forgotpassword":return N[e];case"createjob":return te[e];case"addcampaignaccount":return ne[e];case"updatecampaignaccount":return ae[e];case"adddelegation":return re[e];case"adddelegations":return le[e];case"deletecampaignaccount":return se[e];case"deleteaccounts":return ce[e];case"updatejob":return ue[e];case"deletejob":return de[e];case"deletedelegation":return pe[e];case"contactsfileupload":return fe[e];case"copywittags":return B[e];case"removetaggroup":return z[e];case"removetag":return K[e];case"updatetaggroup":return X[e];case"updatetag":return Q[e];case"removeexpirydetails":return ge[e];case"expiredwidgetnotifications":return he[e];case"updatefolderexpirydetails":return Ee[e];case"updatewitsexpirydetails":return ve[e];case"docwebhook":return we[e];case"userfoldersfirstlevel":return Ae[e];case"getfoldercontents":return Ie[e];case"getfolderdocuments":return Te[e];case"userfolderinfo":return ye[e];case"uploaddocs":return Ce[e];case"sharepoint/uploaddoc":return _e[e];case"getsubfolders":return be[e];case"addcontactingroup":return d[e];case"creategroup":return p[e];case"editgroup":return m[e];case"deletegroup":return f[e];case"delegationaction":return me[e];case"delegationaction/0":return me[e];case"delegationaction/1":return me[e];case"delegationaction/2":return me[e];case"delegationaction/3":return me[e];case"removewittag":return q[e];case"getmycampaignaccounts":return oe[e];case"getaccounts":return ie[e];case"web/getacrowituserfolders":return Z[e];case"createsharelink":return Se[e];case"approvejob":return Oe[e];case"getaccountsdelegates":return De[e];case"getjobs":return Ne[e];case"requestfordelegation":return Le[e];case"bulkfilesassociatetowidget":return Pe[e];case"changeuserpassword":return We[e];
case"validatesso":return Re[e];case"dupwitdetectionreq":return Fe[e];case"autotagdetectionreq":return ke[e];case"duplicatewits":return xe[e];case"sharepoint2010/getfoldercontents":return Me[e];case"sharepoint2010/register":return Me[e];case"box/import":return Me[e];case"createuser":return L[e]}}})}(),function(){"use strict";angular.module("wpoffice").service("commentService",["apiService",function(e){var t="/witComments",n="/witComments/wit";this.getWitComments=function(t){var o=n+"/"+t;return e.getList(o,"")},this.saveWitComments=function(n){var o={};return n.id?(o.id=n.id,o.comment=n.comment,e.callPut(t,n)):e.callPost(t,n)},this.deleteComment=function(n){return e.callDelete(t,n)}}])}(),function(){"use strict";angular.module("wpoffice").service("categoryService",["apiService","witService",function(e,t){var n="/categories";this.getRootCategories=function(t,o,i){var a={level:o||2,values:t||!1},r=n+"/hierarchy";return i&&(r+="/"+i),e.getList(r,a)},this.getCategoryChildren=function(t,o){var i={values:o||!1},a=n+"/"+t;return e.getList(a,i)}}])}(),function(){"use strict";angular.module("wpoffice").service("CampaignService",["apiService","$q",function(e,t){this.getCampaignAccounts=function(){return e.getListCampaign("/account/mycampaignaccounts","")},this.getProviders=function(){return e.getListCampaign("/email/providers","")},this.deleteCampaignAccount=function(t){var n={campaignAccountIds:[t]};return e.callPostCampaign("/account/delete",n)},this.addCampaignEmail=function(t){var n=t;return e.callPostCampaign("/account/",n)},this.addDefault=function(t){var n={emailId:t};return e.callPostCampaign("/account/default",n)}}])}(),function(){"use strict";angular.module("wpoffice").service("attachmentService",["apiService",function(e){var t="attachments",n="wits/addattachments",o="wits/bulkimport";this.getUploadFileAPI=function(){return"/wittyparrot/api/"+t},this.deleteFile=function(n){var o;return n.fileAssociationId?o=t+"/associationId/"+n.fileAssociationId:n.fileId&&(o=t+"/"+n.fileId),e.callDelete(o)},this.downloadFile=function(n,o,i){var a,r={transformResponse:void 0,responseType:o?o:"blob"};return n.fileAssociationId?a=i?t+"/embed/"+n.fileAssociationId:t+"/associationId/"+n.fileAssociationId:n.fileId&&(a=t+"/"+n.fileId),e.getList(a,"",!0,r)},this.bulkApplyAttachments=function(t,o,i,a){var r={witIds:t,fileIds:o,shared:i,replace:a};return e.callPut(n,r)},this.bulkImport=function(t,n){var i={fileIds:t,parentFolderId:n};return e.callPost(o,i)},this.getPublicUrls=function(n){return e.callPost(t+"/public/bulk",n)},this.replaceAttachment=function(n,o){return e.callPut(t+"/replace/"+n+"/"+o)},this.createEmptyFile=function(e){return restangularService.post(t+"/emptyFile",e)}}])}(),function(){"use strict";window.baseUrl="api/wittyparrot/api",window.eventBaseUrl="eventsapi/wittyevents/event",window.campaignBaseUrl="api/campaign/api",window.analyticBaseUrl="dsapi/wpanalytics/dsapi",window.emailAnalyticsUrl="https://qaemailevents.wittyparrot.com",angular.module("wpoffice").service("apiService",["$http","$q","$location","ngNotify","appData","userDataFactory",function(e,t,n,o,i,a){function r(e){i.tokenKey=e}this.searchQueryUrl=function(e){for(var t,n=[],o=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<o.length;i++)t=o[i].split("="),n.push(t[0]),n[t[0]]=t[1];return n[e]},window.isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}},window.location.hostname.indexOf("dev2.wittyparrot.com")>=0||window.location.hostname.indexOf("p365.wittyparrot.com")>=0||window.location.hostname.indexOf("localhost")>=0||window.location.hostname.indexOf("qaparrot365.wittyparrot.com")>=0||window.location.hostname.indexOf("parrot365.wittyparrot.com")>=0||window.location.hostname.indexOf("stageo365.wittyparrot.com")>=0?(window.localRun=!0,window.location.hostname.indexOf("qaparrot365.wittyparrot.com")>=0||window.location.hostname.indexOf("parrot365.wittyparrot.com")>=0||window.location.hostname.indexOf("stageo365.wittyparrot.com")>=0?window.location.search&&(window.location.search.split("=")[1].indexOf("msoffice")>=0||window.location.search.split("=")[1].indexOf("document")>=0||window.location.search.split("=")[1].indexOf("workbook")>=0||window.location.search.split("=")[1].indexOf("presentation")>=0)?window.appHostName="msoffice":window.location.search&&window.location.search.split("=")[1].indexOf("outlook")>=0?window.appHostName="outlook":(window.QAmode=!0,window.appHostName="chrome-extension"):(window.QAmode=!1,i.devMode=!0,void 0,window.appHostName="chrome-extension")):(window.localRun=!1,window.QAmode=!1,window.location.search&&(window.location.search.split("=")[1].indexOf("msoffice")>=0||window.location.search.split("=")[1].indexOf("document")>=0||window.location.search.split("=")[1].indexOf("workbook")>=0||window.location.search.split("=")[1].indexOf("presentation")>=0)?window.appHostName="msoffice":window.location.search&&window.location.search.split("=")[1].indexOf("outlook")>=0?window.appHostName="outlook":(window.chromeMode=!0,window.appHostName="chrome-extension")),this.init=function(){var n;n=window.appHostName?window.appHostName:"chrome-extension",i.source=n;var o=t.defer();return e.get("config-helper/config.json").success(function(e){for(var t=0;t<e.apiUrls.length;t++)e.apiUrls[t].flag&&(i.ssoUrl=e.apiUrls[t].ssoUrl,i.host=e.apiUrls[t].host,i.emailAnalyticsUrl=e.apiUrls[t].emailAnalyticsUrl,(!window.localRun&&!window.QAmode||window.chromeMode)&&(baseUrl=e.apiUrls[t].url,campaignBaseUrl=e.apiUrls[t].campaignUrl,eventBaseUrl=e.apiUrls[t].urlevent,analyticBaseUrl=e.apiUrls[t].analyticBaseUrl,emailAnalyticsUrl=e.apiUrls[t].emailAnalyticsUrl));o.resolve(e)}),isMobile.any()&&null!==isMobile.any()?(i.isMobileDevice=!0,i.source="chrome-extension"):i.isMobileDevice=!1,o.promise},this.login=function(n,o){var a,l=t.defer();return a="chrome-extension"===i.source?baseUrl+o:o,e.post(a,n).then(function(e){var t=new Date,n=t.getTime();n+=36e6,t.setTime(n),r(e.data.accessToken.tokenType+e.data.accessToken.tokenValue),"chrome-extension"===i.source&&docCookies.setItem("p365WidgetKey",i.tokenKey,t.toUTCString(),"/"),i.isMobileDevice?(localStorage.setItem("isCookie",!0),localStorage.setItem("p365WidgetKey",i.tokenKey)):docCookies.setItem("isCookie",!0,t.toUTCString(),"/"),l.resolve(e.data)}).then(null,function(e){l.reject(e.data)}),l.promise},this.logout=function(o){var a,r=t.defer();return a="chrome-extension"==i.source?baseUrl+o:o,e.post(a,"",{headers:{Authorization:i.tokenKey}}).then(function(e){i.isMobileDevice?(localStorage.removeItem("isCookie"),localStorage.removeItem("p365WidgetKey")):(docCookies.removeItem("isCookie"),docCookies.removeItem("p365WidgetKey"),docCookies.removeItem("isNormalContent")),n.path("/"),r.resolve(e.data)}).then(null,function(e){i.isMobileDevice?(localStorage.removeItem("isCookie"),localStorage.removeItem("p365WidgetKey"),localStorage.removeItem("isNormalContent")):(docCookies.removeItem("isCookie"),docCookies.removeItem("p365WidgetKey"),docCookies.removeItem("isNormalContent")),n.path("/"),r.reject(e)}),r.promise},this.callPost=function(n,a,r){var l=t.defer();return i.isContentLoaded=!1,e.post(baseUrl+n,a,{headers:{Authorization:i.tokenKey}}).then(function(e){l.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){o.set(e.statusText),i.isContentLoaded=!0,l.reject(e)}),l.promise},this.callPostWithoutContentType=function(n,a,r){var l=t.defer();return e.post(baseUrl+n,a,{headers:{Authorization:i.tokenKey,"Content-Type":void 0}}).then(function(e){l.resolve(e.data)}).then(null,function(e){o.set(e.statusText),i.isContentLoaded=!0,l.reject(e)}),l.promise},this.callPostCampaign=function(n,a,r){var l=t.defer();return e.post(campaignBaseUrl+n,a,{headers:{Authorization:i.tokenKey}}).then(function(e){l.resolve(e.data)}).then(null,function(e){o.set(e.statusText),i.isContentLoaded=!0,l.reject(e)}),l.promise},this.callWitDocPost=function(n,a){var r=t.defer();return e.post(baseUrl+n,a,{headers:{Authorization:i.tokenKey,"Content-Type":"application/octet-stream"}}).then(function(e){r.resolve(e.data)}).then(null,function(e){o.set(e.statusText),r.reject(e)}),r.promise},this.callPostEvent=function(n){void 0;var o=t.defer();return e.post(eventBaseUrl,n,{headers:{Authorization:i.tokenKey,"Content-Type":"application/json"}}).then(function(e){o.resolve(e.data)}).then(null,function(e){void 0,o.reject(e)}),o.promise},this.callPut=function(n,a){var r=t.defer();return i.isContentLoaded=!1,e.put(baseUrl+n,a,{headers:{Authorization:i.tokenKey}}).then(function(e){r.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){r.reject(e),o.set(e.statusText),i.isContentLoaded=!0}),r.promise},this.getList=function(n,o){var a=t.defer();return i.isContentLoaded=!1,e.get(baseUrl+n,{params:o,headers:{Authorization:i.tokenKey}}).then(function(e){a.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){a.reject(e),i.isContentLoaded=!0}),a.promise},this.getListCampaign=function(n,o){var a=t.defer();return i.isContentLoaded=!1,e.get(campaignBaseUrl+n,{params:o,headers:{Authorization:i.tokenKey}}).then(function(e){a.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){a.reject(e),i.isContentLoaded=!0}),a.promise},this.getListAnalytics=function(n,o){var a=t.defer();return i.isContentLoaded=!1,e.get(analyticBaseUrl+n,{params:o,headers:{Authorization:i.tokenKey}}).then(function(e){a.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){a.reject(e),i.isContentLoaded=!0}),a.promise},this.getBlob=function(n,o){var a=t.defer();return i.isContentLoaded=!1,e.get(baseUrl+n,{params:o,headers:{Authorization:i.tokenKey},responseType:"blob",transformResponse:void 0}).then(function(e){a.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){a.reject(e),i.isContentLoaded=!0}),a.promise},this.validateAuth=function(n){var o,a=t.defer();return"chrome-extension"==i.source?(i.tokenKey=docCookies.getItem("p365WidgetKey"),o=baseUrl+n):o=n,i.isMobileDevice&&(i.tokenKey=localStorage.getItem("p365WidgetKey")),i.isContentLoaded=!1,e.get(o,{headers:{"If-Modified-Since":"Mon, 26 Jul 1997 05:00:00 GMT","Cache-Control":"no-cache, no-store, private, must-revalidate",Pragma:"no-cache",Authorization:i.tokenKey}}).then(function(e){a.resolve(e.data),i.isContentLoaded=!0}).then(null,function(e){a.reject(e),i.isContentLoaded=!0}),a.promise},this.getDsapiList=function(n,o){var a=t.defer();return e.get(analyticBaseUrl+n,{params:o,headers:{Authorization:i.tokenKey}}).then(function(e){a.resolve(e.data)}).then(null,function(e){a.reject(e)}),a.promise},this.callDelete=function(n,o){var a=t.defer();return i.isContentLoaded=!1,e({method:"delete",url:baseUrl+n,headers:{"Content-Type":"application/json",Authorization:i.tokenKey},data:o}).success(function(e,t){a.resolve(e.data),i.isContentLoaded=!0}).error(function(e,t){a.reject(e),i.isContentLoaded=!0}),a.promise},this.externalAPICall=function(n,a,r,l){var s=t.defer();return e.post(campaignBaseUrl+n,a,{headers:{Authorization:r}}).then(function(e){s.resolve(e.data)}).then(null,function(e){o.set(e.statusText),i.isContentLoaded=!0,s.reject(e)}),s.promise},this.setAppDataTokenVal=function(e){}}])}(),function(){"use strict";function e(e){this.getEnterpriseData=function(t){return e.getListAnalytics("/analytics/entbasic?entId="+t,"")}}e.$inject=["apiService"],angular.module("wpoffice").service("AnalyticsService",e)}(),function(){"use strict";angular.module("wpoffice").service("PasswordService",["apiService","$q",function(e,t){this.changePassword=function(t,n){var o={oldPassword:t,newPassword:n};return e.callPut("/auth/changepassword",o)}}]).service("AccountService",["apiService","$q",function(e,t){this.updatePreferences=function(t){var n=t;return e.callPut("/users",n)}}])}(),function(){"use strict";angular.module("wpoffice").filter("timeFromNow",function(){return function(e,t,n){var o=moment(e),i=moment(),a=null;return o>i&&(o=i),a=n&&t?o.diff(t,"days"):t?o.from(t):o.fromNow()}})}(),angular.module("wpoffice").filter("safe",["$sce",function(e){return e.trustAsHtml}]),function(){"use strict";angular.module("wpoffice").directive("witRightClick",function(){var e=function(e,t,n){function o(){if(!o)var o=angular.element;o(t.currentTarget).addClass("context");var i=o("<div>");i.addClass("dropdown clearfix");var a=o("<ul>");a.addClass("dropdown-menu"),a.attr({role:"menu"});var r=t.pageY+"px",l=t.pageX+"px";l=t.pageX>280?t.pageX-200+"px":t.pageX+"px",a.css({display:"block",position:"absolute",left:l,top:r,width:"15%"}),angular.forEach(n,function(n,r){var l=o("<li>"),s=o("<a>");null===n?l.addClass("divider"):(s.attr({tabindex:"-1",href:"#"}),s.text("string"==typeof n[0]?n[0]:n[0].call(e,e)),l.append(s),l.on("click",function(a){a.preventDefault(),e.$apply(function(){o(t.currentTarget).removeClass("context"),i.remove(),n[1].call(e,e)})})),a.append(l)}),i.append(a);var s=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);i.css({width:"100%",height:s+"px",position:"absolute",top:0,left:0,zIndex:9999}),o(document).find("body").append(i),i.on("mousedown",function(e){o(e.target).hasClass("dropdown")&&(o(t.currentTarget).removeClass("context"),i.remove())}).on("contextmenu",function(e){o(e.currentTarget).removeClass("context"),e.preventDefault(),i.remove()})}o()};return function(t,n,o){n.on("contextmenu",function(n){t.$apply(function(){n.preventDefault();var i=t.$eval(o.witRightClick);e(t,n,i)})})}})}(),function(){"use strict";angular.module("wpoffice").directive("witDraggable",["userDataFactory",function(e){return{restrict:"A",link:function(t,n,o,i){for(var a=document.getElementsByClassName("icon-wit-list"),r=0;r<a.length;r++)a[r].removeEventListener("dragstart",function(e){}),a[r].addEventListener("dragstart",function(t){var n=e.getUserData(this.getAttribute("id"));t.dataTransfer.setData("text/html",n)},!1),a[r].removeEventListener("dragover",function(e){}),a[r].addEventListener("dragover",function(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1},!1)}}}])}(),function(){"use strict";angular.module("wpoffice").directive("slideMenuToggle",["$document",function(e){return{restrict:"A",scope:{isOpen:"=slideMenuToggle"},link:function(e,t,n){e.isOpen=!1;var o=parseInt(n.slideToggleDuration,10)||200;"false"==n.startShown&&t.hide(),e.$watch("isOpen",function(e,n){e!==n&&t.stop().slideToggle(o)})}}}])}(),function(){"use strict";angular.module("wpoffice").directive("multiEmail",function(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.unshift(function(e){var t=e.split(","),n=/\S+@\S+\.\S+/,i=t.map(function(e){return n.test(e.trim())}),a=!1;return angular.forEach(i,function(e){e===!1&&(a=!0)}),a?void o.$setValidity("multiEmail",!1):(o.$setValidity("multiEmail",!0),e)})}}})}(),function(){"use strict";angular.module("wpoffice").directive("clickOutside",["$document","witEditorUtil",function(e,t){var n=function(){var e={};return window.getSelection?(e["class"]=window.getSelection().getRangeAt(0).startContainer.parentNode.className,e.name=window.getSelection().toString()):document.selection&&"Control"!==document.selection.type&&(e.name=document.selection.createRange().text),e};return function(e,o,i){o.bind("dblclick",function(i){var a=o.find('[class="var_acronym"]'),r=n();if(a.length>0&&"var_acronym"===r["class"]){r=r.name;for(var l,s=0;s<a.length;s++){var c=a[s].innerText;if(c==="["+r+"]"){l=s;break}}s<a.length&&(t.setSelectedAcronym(r),0!=o.find("wit-editor").length&&e.accessCtrl.openPopup("setAcronyms"),void 0)}})}}])}(),function(){"use strict";angular.module("wpoffice").factory("reusableDataFactory",["TRANSFER_ACTION","ngNotify",function(e,t){var n={selectedFolder:null,transferDataInfo:{type:e.TYPE.NONE,action:e.NONE,list:[]},userNotification:{}},o={};return o.setSelectedFolder=function(e){n.selectedFolder=e},o.getSelectedFolder=function(){return n.selectedFolder},o.setUserNotification=function(e){e?n.userNotification=e:n.userNotification.records.length=0},o.setUserNotificationRecords=function(e){o.hasUserNotification()&&(n.userNotification.records=n.userNotification.records.concat(e))},o.hasUserNotification=function(e){return Object.keys(n.userNotification).length>0},o.getUserNotification=function(e){return n.userNotification},o.getUserNotificationCount=function(e){var t=0;return o.hasUserNotification()&&(t=n.userNotification.totalRecordCount),t},o.getUserNotificationList=function(e){var t=[];return o.hasUserNotification()&&(t=n.userNotification.records),t},o.hasTransferableItem=function(e){var t=!1;return t=e?n.transferDataInfo.list.length>0&&n.transferDataInfo.type===e:n.transferDataInfo.list.length>0},o.setTransferList=function(e,t,i){n.transferDataInfo.action===t&&n.transferDataInfo.type===e||o.resetTransferObj(),n.transferDataInfo.list.push(i),n.transferDataInfo.action=t,n.transferDataInfo.type=e},o.getTransferList=function(){return n.transferDataInfo},o.resetTransferObj=function(){n.transferDataInfo={type:e.TYPE.NONE,action:e.NONE,list:[]}},o.copyClipboardForLink=function(e,t){t=t||e;var n=!1,i=document.body,a=document.createElement("a");return a.target="_self",a.rel="noopener noreferrer",a.href=e,a.innerHTML=t,a.style.height="0",i.appendChild(a),n=o.copyToClipboard(a),i.removeChild(a),a=null,n},o}])}(),function(){"use strict";angular.module("wpoffice").service("outlookAppService",["$q","notify","ngNotify","appData",function(e,t,n,o){this.getOfficeOutlookContent=function(){var t=e.defer();return _mailbox.item.getSelectedDataAsync(Office.CoercionType.Html,function(e){t.resolve(e)}),t.promise},this.setOfficeOutlookContent=function(t,n){var o=e.defer();try{"true"==n?_mailbox.item.body.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Text},function(e){"failed"==e.status?Office.context.mailbox.item.body.setAsync(t,{coercionType:"html",asyncContext:"This is passed to the callback"},function(e){o.resolve(e)}):o.resolve(e)}):_mailbox.item.body.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Html},function(e){"failed"==e.status?Office.context.mailbox.item.body.setAsync(t,{coercionType:"html",asyncContext:"This is passed to the callback"},function(e){o.resolve(e)}):o.resolve(e)})}catch(i){$("#notification-message-body").text(i.message)}finally{}return o.promise},this.addFileAttachment=function(e,t){var n={asyncContext:{var1:1,var2:2}};_mailbox.item.addFileAttachmentAsync(e,t,n,function(e){e.error})},this.getFileUrl=function(){Office.context.document.getFilePropertiesAsync(function(e){return e.value.url})},this.forwardForm=function(e){_mailbox.item.displayReplyForm({htmlBody:e,attachments:[{type:Office.MailboxEnums.AttachmentType.File,name:"Auto-Tagging.docx",url:"https://qawittyapi.wittyparrot.com/wittyparrot/api/public/attachments/d4d2a4d1-8911-4372-baa8-2f2f5ec893a9"}],callback:function(e){void 0}})},this.replyForm=function(e,t){navigator.appVersion.indexOf("Mac")!=-1?_mailbox.item.displayReplyForm(e):_mailbox.item.displayReplyForm({htmlBody:e,attachments:t,callback:function(e){void 0}})},this.replyAllForm=function(e,t){navigator.appVersion.indexOf("Mac")!=-1?_mailbox.item.displayReplyAllForm(e):_mailbox.item.displayReplyAllForm({htmlBody:e,attachments:t,callback:function(e){void 0}})},this.createAppointment=function(e,t){var n=new Date,o=new Date;o.setHours(n.getHours()+1),_mailbox.displayNewAppointmentForm({requiredAttendees:[],optionalAttendees:[],start:n,end:o,location:"",resources:[],subject:t,body:e})},this.composeMail=function(){var e=Office.cast.item.toMessageCompose(Office.context.mailbox.item);void 0}}])}();var outlookApp=function(){"use strict";var e={};return e.initialize=function(){e.getOfficeOutlookContent=function(){_mailbox.item.getSelectedDataAsync(Office.CoercionType.Html,function(e){return e.status===Office.AsyncResultStatus.Succeeded?e.value:e.status})},e.setOfficeOutlookContent=function(e,t){return t?void _mailbox.item.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Text},function(e){return e.status===Office.AsyncResultStatus.Succeeded}):new Promise(function(t,n){t(_mailbox.item.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Html},function(e){return e}))})},e.addFileAttachment=function(e,t){var n={asyncContext:{var1:1,var2:2}};_mailbox.item.addFileAttachmentAsync(e,t,n,function(e){e.error})},e.getFileUrl=function(){Office.context.document.getFilePropertiesAsync(function(e){return e.value.url})},e.replyForm=function(e){_mailbox.item.displayReplyForm({htmlBody:e,attachments:[{type:Office.MailboxEnums.AttachmentType.File,name:"widget_logo.png",url:"https://dev.wittyparrot.com/resources/assets/images/widget_logo.png"},{type:"item",name:"rand",itemId:_mailbox.item.itemId}],callback:function(e){void 0}})},e.replyAllForm=function(e){_mailbox.item.displayReplyAllForm({htmlBody:e,attachments:[{type:Office.MailboxEnums.AttachmentType.File,name:"widget_logo.png",url:"https://dev.wittyparrot.com/resources/assets/images/widget_logo.png"},{type:"item",name:"rand",itemId:_mailbox.item.itemId}],callback:function(e){void 0}})},e.createAppointment=function(e,t){var n=new Date,o=new Date;o.setHours(n.getHours()+1),_mailbox.displayNewAppointmentForm({requiredAttendees:[],optionalAttendees:[],start:n,end:o,location:"",resources:[],subject:t,body:e})},e.composeMail=function(){Office.cast.item.toMessageCompose(Office.context.mailbox.item).body.getAsync("text",function(e){void 0})}},e}();!function(){"use strict";angular.module("wpoffice").service("officeAppService",["$q","notify","ngNotify","appData",function(e,t,n,o){this.getOfficeDocContent=function(t){var n=e.defer();switch(t){case"Html":_document.getSelectedDataAsync(Office.CoercionType.Html,function(e){n.resolve(e)});break;case"Text":_document.getSelectedDataAsync(Office.CoercionType.Text,function(e){n.resolve(e)});break;default:_document.getSelectedDataAsync(Office.CoercionType.Html,function(e){n.resolve(e)})}return n.promise},this.setOfficeDocContent=function(t,n){var o=e.defer();switch(n){case"Html":_document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Html},function(e){o.resolve(e)});break;case"Text":_document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Text},function(e){o.resolve(e)});break;case"Table":_document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Table},function(e){o.resolve(e)});break;case"Image":_document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Image},function(e){o.resolve(e)});break;default:_document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Html},function(e){o.resolve(e)})}return o.promise},this.addFileAttachment=function(e,t){var n={asyncContext:{var1:1,var2:2}};_mailbox.item.addFileAttachmentAsync(e,t,n,function(e){e.error})},this.addMultipleFileAttachments=function(t){var n=e.defer(),o=[],i={asyncContext:{var1:1,var2:2}};return angular.forEach(t,function(e){var t=_mailbox.item.addFileAttachmentAsync(e.url,e.name,i,function(e){e.error?n.reject():n.resolve()});o.push(t)}),e.all(o)},this.getFileUrl=function(){Office.context.document.getFilePropertiesAsync(function(e){return e.value.url})},this.replyForm=function(e){_mailbox.item.displayReplyForm({htmlBody:e,attachments:[{type:Office.MailboxEnums.AttachmentType.File,name:"widget_logo.png",url:"https://dev.wittyparrot.com/resources/assets/images/widget_logo.png"},{type:"item",name:"rand",itemId:_mailbox.item.itemId}],callback:function(e){void 0}})},this.replyAllForm=function(e){_mailbox.item.displayReplyAllForm({htmlBody:e,attachments:[{type:Office.MailboxEnums.AttachmentType.File,name:"widget_logo.png",url:"https://dev.wittyparrot.com/resources/assets/images/widget_logo.png"},{type:"item",name:"rand",itemId:_mailbox.item.itemId}],callback:function(e){void 0}})},this.createAppointment=function(e,t){var n=new Date,o=new Date;o.setHours(n.getHours()+1),_mailbox.displayNewAppointmentForm({requiredAttendees:[],optionalAttendees:[],start:n,end:o,location:"",resources:[],subject:t,body:e})},this.composeMail=function(){Office.cast.item.toMessageCompose(Office.context.mailbox.item).body.getAsync("text",function(e){void 0})},this.getSelectedHtml=function(){var e;if(document.selection&&document.selection.createRange)return e=document.selection.createRange(),e.htmlText;if(window.getSelection){var t=window.getSelection();if(t.rangeCount>0){e=t.getRangeAt(0);var n=e.cloneContents(),o=document.createElement("div");return o.appendChild(n),o.innerHTML}return""}return""},this.copySelectedArea=function(){var e;try{e=document.execCommand("copy")}catch(t){e=!1}return e}}])}();var officeApp=function(){"use strict";var e={};return e.initialize=function(){e.getOfficeDocContent=function(e){switch(e){case"Html":_document.getSelectedDataAsync(Office.CoercionType.Html,function(e){return e.status===Office.AsyncResultStatus.Succeeded?e.value:e.status});break;case"Text":_document.getSelectedDataAsync(Office.CoercionType.Text,function(e){return e.status===Office.AsyncResultStatus.Succeeded?e.value:e.status});break;default:_document.getSelectedDataAsync(Office.CoercionType.Html,function(e){return e.status===Office.AsyncResultStatus.Succeeded?e.value:e.status})}},e.setOfficeDocContent=function(e,t){switch(t){case"Html":_document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Html},function(e){return e.status===Office.AsyncResultStatus.Succeeded});break;case"Text":_document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Text},function(e){return e.status===Office.AsyncResultStatus.Succeeded});break;default:_document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Html},function(e){return e.status===Office.AsyncResultStatus.Succeeded})}return!0},e.getSelectedHtml=function(){var e;if(document.selection&&document.selection.createRange)return e=document.selection.createRange(),e.htmlText;if(window.getSelection){var t=window.getSelection();if(t.rangeCount>0){e=t.getRangeAt(0);var n=e.cloneContents(),o=document.createElement("div");return o.appendChild(n),o.innerHTML}return""}return""},e.copySelectedArea=function(){var e;try{e=document.execCommand("copy")}catch(t){e=!1}return e}},e}();!function(){"use strict";angular.module("wpoffice").controller("WitController",["$scope","witUtilityFactory","dialogFactory","userDataFactory",function(e,t,n,o){e.witData={id:null,name:"",content:"",attachmentDetails:[],comboWit:null,desc:"",source:"WITTYPARROT",note:"",parentId:null,tagVos:[],expiryDate:"",firstAlert:"",secondAlert:"",locale:"en_US",loggedInUserPermission:{owner:!0}},e.breadcrumbs=[],e.forcedRedirect=!1,e.resetWitData=function(){e.witData={id:null,name:"",content:null,attachmentDetails:[],comboWit:null,desc:"",source:"WITTYPARROT",note:"",parentId:null,tagVos:[],expiryDate:"",firstAlert:"",secondAlert:"",locale:"en_US",loggedInUserPermission:{owner:!0}}},e.generateBreadcrumbs=function(t,n){e.breadcrumbs.length=0;var i=[],a=t.$modelValue?t.$modelValue:t,r=t.$modelValue?"$parentNodeScope":"parentFolder";if(t){for(i.push(a);t[r];)t=t[r],"$parentNodeScope"===r?i.push(t.$modelValue):i.push(t);if("$parentNodeScope"!=r&&n){var l=o.getWorkspaceDetailsOf(n);l?i.push(l):""}i.reverse()}Array.prototype.push.apply(e.breadcrumbs,i)},e.$on("$stateChangeStart",function(o,i,a,r){var l=a.parent&&a.parent.forceReload;"wit.edit"!==r.name&&"wit.docs"!==r.name&&"wit.combowits"!==r.name||e.forcedRedirect||l||t.isWitUpdated(e.witData)&&(i.resolve.pauseStateChange=["$q",function(t){var o=t.defer();return n.showUnsavedChangesDialog({locals:{saveState:function(t){"SAVE"===t?(e.$broadcast("WIT_SAVE"),o.reject(),delete i.resolve.pauseStateChange):"DISCARD"===t?(o.resolve(),delete i.resolve.pauseStateChange):o.reject()}}}),o.promise}])}),e.resetWitData()}])}(),function(){"use strict";function e(e,t){t.addTheme("notify-status-theme","wp-notification-theme"),t.config({theme:"notify-status-theme",position:"bottom",type:"info",button:!0,html:!1})}e.$inject=["$log","ngNotify"],angular.module("wpoffice").run(e)}(),function(){"use strict";function e(e,t){e.state("login",{url:"/",templateUrl:"app/views/login/login.html",controller:"LoginController",controllerAs:"loginCtrl",resolve:{authenticated:["$q","$location","authFactory","apiService",function(e,t,n,o){var i=e.defer();return o.init().then(function(){n.isAuthenticated().then(function(e){t.path("/main"),n.getUserProfile(),i.resolve()}).then(null,function(e){i.resolve()})}),i.promise}]}}).state("main",{url:"/main",templateUrl:"app/views/main/main.html",controller:"MainController",controllerAs:"accessCtrl",resolve:{authenticated:["$q","$location","authFactory","apiService",function(e,t,n,o){var i=e.defer();return o.init().then(function(){n.isAuthenticated().then(function(e){n.getUserProfile(),i.resolve()}).then(null,function(e){t.path("/")})}),i.promise}]}}).state("email",{url:"/email",templateUrl:"app/components/external-send-email-popup/external-send-email-popup.html",controller:"ExternalSendEmailPopupController",controllerAs:"externalSendEmailPopupCtrl"}).state("docedit",{url:"/docedit/:fileId?:operation",templateUrl:"app/views/office-viewer/docedit.html",controller:"DocEditController",controllerAs:"docEditCtrl",resolve:{authenticated:["$q","$state","$location","authFactory","apiService",function(e,t,n,o,i){var a=e.defer();return i.init().then(function(){o.isAuthenticated().then(function(){o.getUserProfile(),a.resolve()}).then(null,function(e){n.path("/")})}),a.promise}]}}).state("reset",{url:"/reset/?emailId=:mailID&code=:vcode&appCode=:aCode",templateUrl:"app/components/reset-password/resetpassword.html",controller:"ResetController"}),t.otherwise(docCookies.getItem("p365WidgetKey")||localStorage.getItem("p365WidgetKey")===!0?"/main":"/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("wpoffice").config(e)}(),function(){"use strict";angular.module("wpoffice").constant("moment",moment).constant("SOCIAL_LIST",{1:"Email",2:"Google+",3:"Facebook",4:"Twitter",5:"Linkedin",6:"Wechat",7:"Instagram",8:"Weibo",9:"SMS",10:"WhatsApp"}).constant("MEDIA_TYPE",{SOCIAL:0,EMAIL:1}).constant("TRANSFER_ACTION",{NONE:0,CUT:1,COPY:2,PASTE:3,TYPE:{NONE:0,WIT:1,FOLDER:2}}).constant("PERMISSION_TYPE",{PCKG:"package",ROLE:"role",ACI:"access_control",PCKG_ROLE:" package_role",PCKG_ACI:"package_access_contol",ROLE_ACI:"role_access_control",PCKG_ROLE_ACI:" package_role_access_control"}).constant("WIT_TYPE",{WIT:"ORDINARY",COMBO:"COMBO",DOC:"DOC_WIT"}).constant("WIT_STATUS",{WORKFLOW:"LOCKED_FOR_WORKFLOW"}).constant("CONTENT_TYPE",{WIT:"WIT",FOLDER:"FOLDER",TAG:"TAG",SEARCH:"SEARCH"}).constant("SCHEDULE_TYPE",{NONE:"NONE",DAILY:"DAILY",WEEKLY:"WEEKLY"}).constant("EVENT_MAP",{DRAG_AND_DROP_WITS:{name:"WitDragDrop",id:800},DRAG_AND_DROP_TEXT_OR_INLINE_IMAGE:{name:"InlineDragDrop",id:801},DRAG_AND_DROP_ATTATCHMENTS:{name:"FileDragDrop",id:802},DRAG_AND_DROP_PARTIAL_SELECTED_TEXT:{name:"TextDragDrop",id:803},WIT_VIEW:{name:"WitViewed",id:804},FOLDER_SELECTION:{name:"FolderViewed",id:805},WIT_COPPIED:{name:"WidgetWitCopied",id:505},WIT_EMAIL:{name:"WitEmail",id:901},WIT_REPLY:{name:"WitReply",id:902},WIT_REPLY_ALL:{name:"WitReplyAll",id:903},WIT_FORWARD:{name:"WitForward",id:904},WIT_CAL_INVITE:{name:"WitCalendarInvite",id:905},WIDGET_WIT_COPPIED:{name:"WidgetWitCopied",id:505},DOWNLOAD_ATTACHMENT:{name:"DownloadAttachment",id:813},PARIAL_COPY:{name:"PartialContentCopy",id:906},PARIAL_INSERT:{name:"PartialContentInsert",id:907},WIT_INSERT:{name:"WitInsert",
id:908},MEETING_REQUEST:{name:"MeetingRequest",id:909},CREATE_APPOINTMENT:{name:"CreateAppointment",id:910},WIT_SEARCH:{name:"WitSearch",id:911},COLLECTION_SELECTION:{name:"CollectionViewed",id:820}}).constant("RECIPIENT_TYPE",{USER:"USER"}).constant("FILE_TYPE",{image:[".bmp",".jpeg",".jpg",".png",".gif"],pdf:[".pdf",".rtf",".txt",".csv"],office:[".doc",".dot",".docx",".docm",".dotx",".dotm",".uot",".uof",".xls",".xlw",".xlt",".xlsx",".xlsm",".xltx",".xltm",".ppt",".pps",".pot",".pptx",".pptm",".potx",".potm",".odp",".odt",".ods",".wopitest"]}).constant("FILE_TO_BE_ATTACH",{SUPPORTED_EXTENTIONS:[".bmp",".jpeg",".jpg",".psd",".png",".gif",".tif",".rtf",".txt",".csv",".pdf",".doc",".dot",".docx",".docm",".dotx",".dotm",".wpd",".wps",".uot",".uof",".xls",".xlw",".xlt",".xlsx",".xlsm",".xltx",".xltm",".uos",".ppt",".pps",".pot",".pptx",".pptm",".potx",".potm",".uop",".sxw",".stw",".psw",".sxc",".stc",".pxl",".sxi",".sti",".mkv",".flv",".avi",".mov",".wmv",".mp4",".m4p",".m4v",".mpg",".mp2",".mpeg",".mpe",".mpv",".3gp",".amr",".dvf",".aac",".m4a",".msv",".ogg",".oga",".wav",".mp3",".odp",".odt",".ods",".notes",".zip",".wopitest"],MAX_SIZE_IN_MB:200,MAX_SIZE_IN_BYTE:209715200,FILE_BASE_SIZE:1024}).value("appData",{isAuthenticated:!1,isContentLoaded:!1,appId:"Parrot365_54c05f633352350ca4da47d02a789aa8",isMobileDevice:!1,commonCalloutActive:!1,Version:"1.0.0"})}(),function(){"use strict";function e(e,t,n){e.debugEnabled(!0),t.allowHtml=!0,t.timeOut=3e3,t.positionClass="toast-top-right",t.preventDuplicates=!0,t.progressBar=!0,n.decorator("$state",["$delegate","$window",function(e,t){var n={goToNewTab:function(n,o){t.open(e.href(n,o,{absolute:!0}),"_blank","scrollbars=yes,resizable=yes,top=200,left=300,width=700,height=500")}};return angular.extend(e,n),e}])}e.$inject=["$logProvider","toastrConfig","$provide"],angular.module("wpoffice").config(e)}(),angular.module("witty.witViewer",["witty.fileViewer"]),function(){"use strict";function e(e,t){function n(e){return'<iframe src="'+e+'" height="1000px" width="100%"></iframe>'}function o(n,o){var i=e.$new(!0);i.wit=n,i.fileController=o;var a='<wit-content-preview wit="wit"file-controller="fileController"></wit-content-preview>';return t(a)(i)[0]}function i(e,t){var n=document.createElement("div");n.innerHTML=t;for(var o,i,a,r=n.querySelectorAll("#var_acronym"),l=0;l<r.length;l++)o=r[l],i=_.findIndex(e,{name:o.getAttribute("var")}),i>=0&&(a=e[i],a.defaultValue&&(o.style.color="inherit",o.innerText=a.defaultValue));return n.innerHTML}this.generateWebView=n,this.replaceAcronym=i,this.generateWitView=o}e.$inject=["$rootScope","$compile"],angular.module("witty.witViewer").service("witPreviewUtil",e)}(),function(){"use strict";function e(e,t,n,o,i){function a(){var e=p.wit;if("ORDINARY"===e.witType){var o=i.replaceAcronym(p.wit.acronyms,e.content);p.witContent=t.trustAsHtml(o),n(function(){p.wit.embeddedWit&&p.wit.embeddedWit.length&&u(),d()},100)}else if("DOC_WIT"===e.witType){var a=e.attachmentDetails||e.attchmentDetailVO;p.file=a[0]}else"COMBO"===e.witType&&r(e.associatedWits)}function r(e){e.forEach(function(e){var t=i.generateWitView(e,p.fileController);f.appendChild(t)})}function l(){return p.fileController.generatePdfUrl.call(p.fileController.context,p.file.fileAssociationId)}function s(){return p.fileController.getWopiUrl.call(p.fileController.context,p.file.fileAssociationId)}function c(){return p.fileController.downloadFile.call(p.fileController.context,p.file)}function u(){function e(e){var t=p.wit;if(t.attachmentDetails){var n=_.findIndex(t.attachmentDetails,{fileAssociationId:e});return t.attachmentDetails[n]}}for(var t,n,o=(p.fileController,f.querySelectorAll("[doc-attachment]")),a=0;a<o.length;a++){t=o[a].getAttribute("doc-attachment"),n=e(t);var r={witType:"DOC_WIT",attachmentDetails:[n]},l=i.generateWitView(r,p.fileController),s=f.querySelector('[doc-attachment="'+t+'"]');s&&(s.innerHTML="",s.appendChild(l))}}function d(){for(var e,t,n,o=f.querySelectorAll(".witty-web-view"),a=0;a<o.length;a++)e=o[a],t=e.getAttribute("witty-web-url"),n=i.generateWebView(t),e.innerHTML=n}var p=this;p.$onInit=a,p.getPdfUrl=l,p.getOfficeUrl=s,p.getFileUrl=c;var f=o[0]}e.$inject=["$scope","$sce","$timeout","$element","witPreviewUtil"],angular.module("witty.witViewer").component("witContentPreview",{restrict:"E",bindings:{wit:"<",fileController:"<"},controller:e,controllerAs:"witContentCtrl",template:'<div class="wit-content-preview"><div ng-if="witContentCtrl.wit.witType === \'ORDINARY\' || witContentCtrl.wit.witType === \'COMBO\'"ng-bind-html="witContentCtrl.witContent"></div><file-viewer ng-if="witContentCtrl.wit.witType === \'DOC_WIT\'"file="witContentCtrl.file"download-file="witContentCtrl.getFileUrl()"get-wopi-url="witContentCtrl.getOfficeUrl()"generate-Pdf-url="witContentCtrl.getPdfUrl()"can-read-office-file="witContentCtrl.fileController.canReadOfficeFile"preview-height="1000px" ></file-viewer></div>'})}(),angular.module("witty.fileViewer",["witty.core"]),function(){"use strict";function e(e){var t=this;t.downloadAttachment=function(){t.parent.downloadFile().then(function(t){e.downloadFile(t)})}}e.$inject=["fileUtil"],angular.module("witty.fileViewer").component("noPreview",{restrict:"E",replace:!0,require:{parent:"^fileViewer"},controller:e,controllerAs:"noPreviewCtrl",template:'<div><h2>Preview not available for {{::noPreviewCtrl.parent.file.fileName}}</h2><div><button ng-click="noPreviewCtrl.downloadAttachment()">Dowload</button></div></div>'})}(),function(){"use strict";function e(e,t,n){function o(){var o=e[0];a.anchors=a.anchors?t.$eval(a.anchors):null,a.canCreateAnchors=!!a.canCreateAnchors&&t.$eval(a.canCreateAnchors);var i,r=o.querySelector(".pdfViewer"),l=a.generatePdfUrl(),s=l.indexOf("authorization");s>=0&&(i=l.substr(s+14),o.dataset.auth=i,l=l.substr(0,s-1)),r.src=n.trustAsResourceUrl(l),r.height=a.viewerHeight}function i(e){var t={};e&&(t.coordinateData={page:e.page,coords:e.coords,type:e.type||"HIGHLIGHT"},t.content=e.content,a.showAnchorDialog({anchorInfo:t}))}var a=this;a.$onInit=o,a.createAnchorLink=i}e.$inject=["$element","$scope","$sce"],angular.module("witty.fileViewer").component("pdfViewer",{restrict:"E",bindings:{filePath:"@",anchors:"@",canCreateAnchors:"@",file:"<",generatePdfUrl:"=",viewerHeight:"@",showAnchorDialog:"="},controller:e,controllerAs:"pdfViewerCtrl",template:'<div flex="auto" id="pdf-viewer"><iframe id="pdfViewer" class="pdfViewer" width="100%" frameborder="0"></iframe></div>'})}(),function(){"use strict";function e(e){function t(){function t(e){var t="office_frame_"+e,n=document.querySelectorAll("#"+t);return n.length&&(t=t+"_"+n.length),t}function o(e){var t={};return e.split("&").forEach(function(e){var n=e.split("=");t[n[0]]=n[1]}),t}var i=e[0];n.getWopiUrl().then(function(e){var a=i.querySelector("form"),r=t(n.fileId);a.target=r;var l=e.fileUrl.split("?");a.action=l[0]+"?";var s=l[1],c=o(s);"1"==c.IsLicensedUser&&(c.IsLicensedUser="0"),a[0].value=c.access_token,a[1].value=c.access_token_ttl,delete c.access_token,delete c.access_token_ttl;for(var u=Object.keys(c),d=u.length-1;d>=0;d--)0===d?a.action+=u[d]+"="+c[u[d]]:a.action+=u[d]+"="+c[u[d]]+"&";var p=i.querySelector(".frameholder"),f=document.createElement("iframe");f.name=r,f.id=r,f.width="100%",f.height=n.viewerHeight||"500px",f.frameBorder="0",f.setAttribute("allowfullscreen","true"),p.appendChild(f),setTimeout(function(){a.submit()},200)})}var n=this;n.$onInit=t}e.$inject=["$element"],angular.module("witty.fileViewer").component("officeViewer",{restrict:"E",replace:!0,bindings:{getWopiUrl:"=",viewerHeight:"@",fileId:"@"},controller:e,controllerAs:"officeViewerCtrl",template:'<div layout="row" flex="auto"><form class="office_form" name="office_form" method="post"><input name="access_token" value="" type="hidden"/><input name="access_token_ttl" value="" type="hidden"/></form><span class="frameholder" flex="auto"></span></div>'})}(),function(){"use strict";function e(e,t){var n=t[0];this.$onInit=function(){this.parent.downloadFile().then(function(e){var t;t=e instanceof Blob?window.URL.createObjectURL(e):e,n.querySelector(".imagePreview").src=t})}}e.$inject=["$scope","$element"],angular.module("witty.fileViewer").component("imageViewer",{restrict:"E",replace:!0,require:{parent:"^fileViewer"},controller:e,controllerAs:"imageViewerCtrl",template:'<div class="pad-td-10" flex="auto" layout="row" layout-align="center center"><img class="imagePreview"></div>'})}(),function(){"use strict";function e(e,t){function n(){return o.fileController.downloadFile(o.file.fileAssociationId)}var o=this;o.getPublicUrl=n,this.$onInit=function(){o.file&&(e.isImageFile(o.file.extention)?o.fileType="image":e.isOfficeFile(o.file.extention)&&o.canReadOfficeFile?o.fileType="office":e.isOfficeFile(o.file.extention)||e.isPdfFile(o.file.extention)?o.fileType="pdf":o.fileType="unsupported")}}e.$inject=["fileUtil","$scope"],angular.module("witty.fileViewer").component("fileViewer",{restrict:"E",replace:!0,bindings:{file:"<",canReadOfficeFile:"<",downloadFile:"&",getWopiUrl:"&",previewHeight:"@",generatePdfUrl:"&",showAnchorDialog:"&",anchors:"<",canCreateAnchors:"<"},controller:e,controllerAs:"fileViewerCtrl",template:'<div flex="auto"><office-viewer flex="auto" ng-if="fileViewerCtrl.fileType === \'office\'"file-id="{{fileViewerCtrl.file.fileAssociationId}}"get-wopi-url = "fileViewerCtrl.getWopiUrl"viewer-height="{{fileViewerCtrl.previewHeight}}"></office-viewer><pdf-viewer ng-if="fileViewerCtrl.fileType === \'pdf\'"anchors="{{fileViewerCtrl.anchors}}"file="fileViewerCtrl.file"can-create-anchors="{{fileViewerCtrl.canCreateAnchors}}"generate-pdf-url="fileViewerCtrl.generatePdfUrl"viewer-height="{{fileViewerCtrl.previewHeight}}"show-anchor-dialog="fileViewerCtrl.showAnchorDialog"class="overflow-h" flex="auto"></pdf-viewer><image-viewer ng-if="fileViewerCtrl.fileType === \'image\'" flex="auto"></image-viewer><no-preview flex="auto" ng-if="fileViewerCtrl.fileType === \'unsupported\'"file="fileViewerCtrl.file"</no-preview></div>'})}(),angular.module("witty.core",[]),function(){"use strict";function e(e){var t=this;t.fileClass="",this.$onInit=function(){t.fileClass=e.showFileIcon(t.extention)}}e.$inject=["fileUtil"],angular.module("witty.core").component("wittyFileIcon",{bindings:{extention:"<"},controller:e,template:'<i class="material-icons {{$ctrl.fileClass}}" style="font-size: 4em;"></i>'})}(),function(){"use strict";function e(e,t){function n(n,i,a){i[0].addEventListener("click",function(i){var r=e(a.wittyClick),l=i.currentTarget;o(l),t.when(r(n),function(){o(l)},function(){o(l)})},!0)}function o(e){e.disabled?(e.disabled=!1,e.classList.remove("busy-cursor")):(e.disabled=!0,e.classList.add("busy-cursor"))}var i={link:n,restrict:"A"};return i}e.$inject=["$parse","$q"],angular.module("witty.core").directive("wittyClick",e)}(),function(){"use strict";function e(e){function t(t,n){var o=t.config;if(o){o.acceptedFiles=o.acceptedFiles?o.acceptedFiles:e.SUPPORTED_EXTENTIONS.join(",");var i=new Dropzone(n[0],o);t.events.override&&(Object.keys(t.events.override).forEach(function(e){i[e]=t.events.override[e]}),delete t.events.override),t.events&&Object.keys(t.events).forEach(function(e){i.on(e,t.events[e])}),n.on("$destroy",function(){i.disable()}),t.dropzone=i}}var n={restrict:"A",scope:{config:"=",events:"=",dropzone:"="},link:t};return n}e.$inject=["FILE_TO_BE_ATTACH"],angular.module("witty.core").directive("uploadLocalFiles",e)}(),function(){"use strict";angular.module("witty.core").directive("loadOnScroll",function(){function e(e,t,n){function o(){var o='<md-progress-linear class="md-accent"ng-if="loadOnScrollCtrl.processing" md-mode="query" style="height:2px;"></md-progress-linear>';t.append(n(o)(e)),a(),l()}function i(e){if(!c.processing){var t,n=e.currentTarget,o=n.scrollTop,i=n.clientHeight;t=c.isTable?n.children[0].clientHeight*n.children.length:n.children[0].clientHeight,o>=t-i-u&&a()}}function a(){c.processing=!0,c.loadOnScroll({startIndex:d}).then(function(e){c.processing=!1,e.startIndex+e.pageSize>=e.totalRecordCount?s():d=e.startIndex+e.pageSize})["catch"](function(){c.processing=!1})}function r(){d=0,s(),l(),a()}function l(){t.bind("scroll",i)}function s(){t.unbind("scroll",i)}var c=this;void 0;var u=700,d=0;c.processing=!1,e.$on("REFERESH_LOAD_ON_SCROLL",r),e.$on("$destroy",s),o()}return e.$inject=["$scope","$element","$compile"],{restrict:"A",bindToController:{loadOnScroll:"&",isTable:"@"},controller:e,controllerAs:"loadOnScrollCtrl"}})}(),function(){"use strict";function e(){function e(e){return o.test(e)}function t(e){return i.test(e)}var n=this;n.isValidEmail=e,n.isValidDomain=t;var o=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i=/^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$/}angular.module("witty.core").service("stringUtil",e)}(),function(){"use strict";function e(e,t,n,o){function i(e){return e.substr(e.lastIndexOf(".")+1)}function a(t){var n=["Bytes","KB","MB","GB","TB"];if(0===t)return"0 Byte";var o=Math.floor(Math.log(t)/Math.log(1e3)),i=e("number")(t/Math.pow(1e3,o),1);return i+" "+n[o]}function r(e,n){t.saveAs(e,n)}function l(e){return e=e.toLowerCase(),n.pdf.indexOf(e)!==-1}function s(e){return e=e.toLowerCase(),n.image.indexOf(e)!==-1}function c(e){return e=e.toLowerCase(),n.office.indexOf(e)!==-1}function u(e){return e=e.toLowerCase(),n.audio.indexOf(e)!==-1}function d(e){return e=e.toLowerCase(),n.video.indexOf(e)!==-1}function p(e){var t=document.getElementById("witty-download");t||(t=document.createElement("iframe"),t.style.display="none",t.id="witty-download",document.body.appendChild(t)),t.src=e}function f(e){if(e)return 0===e.indexOf(".")&&(e=e.substr(1)),e=e.toLowerCase(),o[e]}var m=this;m.getFileExtension=i,m.getFileSize=a,m.saveFile=r,m.isPdfFile=l,m.isImageFile=s,m.isOfficeFile=c,m.isAudioFile=u,m.isVideoFile=d,m.downloadFile=p,m.showFileIcon=f}e.$inject=["$filter","FileSaver","FILE_TYPE","FILE_ICON_MAP"],angular.module("witty.core").service("fileUtil",e)}(),function(){"use strict";angular.module("witty.core").filter("entityName",function(){return function(e,t){if(!e)return"";if(t&&"GROUP"===e[t])return e.name;var n=e.firstName;return e.lastName&&(n+=" "+e.lastName),n||(n=e.email?e.email:e.primaryEmail?e.primaryEmail:e.name),n}})}(),function(){"use strict";angular.module("witty.core").constant("FILE_TYPE",{image:[".bmp",".jpeg",".jpg",".png",".gif"],pdf:[".pdf",".rtf",".txt",".csv"],office:[".doc",".dot",".docx",".docm",".dotx",".dotm",".uot",".uof",".xls",".xlw",".xlt",".xlsx",".xlsm",".xltx",".xltm",".ppt",".pps",".pot",".pptx",".pptm",".potx",".potm",".odp",".odt",".ods",".wopitest"]}).constant("FILE_ICON_MAP",{pdf:"icon-pdf",doc:"icon-word",docx:"icon-word",ppt:"icon-ppt",pptx:"icon-ppt",zip:"icon-zip",odt:"icon-odt",ods:"icon-ods",odp:"icon-odp",xls:"icon-xls",xlsx:"icon-xls",html:"icon-html",csv:"icon-csv",wit:"icon-wit",png:"icon-jpg",jpeg:"icon-jpg",jpg:"icon-jpg"," gif":"icon-jpg",bmp:"icon-jpg"}).constant("FILE_TO_BE_ATTACH",{SUPPORTED_EXTENTIONS:[".bmp",".jpeg",".jpg",".psd",".png",".gif",".tif",".rtf",".txt",".csv",".pdf",".doc",".dot",".docx",".docm",".dotx",".dotm",".wpd",".wps",".uot",".uof",".xls",".xlw",".xlt",".xlsx",".xlsm",".xltx",".xltm",".uos",".ppt",".pps",".pot",".pptx",".pptm",".potx",".potm",".uop",".sxw",".stw",".psw",".sxc",".stc",".pxl",".sxi",".sti",".mkv",".flv",".avi",".mov",".wmv",".mp4",".m4p",".m4v",".mpg",".mp2",".mpeg",".mpe",".mpv",".3gp",".amr",".dvf",".aac",".m4a",".msv",".ogg",".oga",".wav",".mp3",".odp",".odt",".ods",".notes",".zip",".wopitest",".vsd",".vst"],MAX_SIZE_IN_MB:200,MAX_SIZE_IN_BYTE:209715200,FILE_BASE_SIZE:1024})}();